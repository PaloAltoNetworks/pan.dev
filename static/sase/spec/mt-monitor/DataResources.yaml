components:
  schemas:
    AlertRule:
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          example: in
          type: string
        property:
          description: Filter property field that is one of the example values
          example: domain
          type: string
        values:
          description: Filter property value
          example: External, external if property is domain
          items:
            type: string
          type: array
      type: object
    Filter:
      description: "Alert count filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/AlertRule'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [AlertRule](/sase/docs/filters#alertrule) and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            type: object
          type: array
      required:
      - operator
      type: object
    Filter1:
      description: "Applications by source filter. Consists of a required operator\
        \ and an array of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/RuleName'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [RuleName](/sase/docs/filters#rulename) and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            type: object
          type: array
      required:
      - operator
      type: object
    Filter2:
      description: "App list filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/RuleName1'
          - $ref: '#/components/schemas/TimeFilter'
          description: "See [RuleName1](/sase/docs/filters#rulename1) and [TimeFilter](/sase/docs/filters#timefilter).\
            \ \n"
          items:
            $ref: '#/components/schemas/FilterRule'
          type: array
      required:
      - operator
      type: object
    Filter3:
      description: "App summary filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/RuleName2'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [RuleName2](/sase/docs/filters#rulename2) and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            type: object
          type: array
      required:
      - operator
      type: object
    Filter4:
      description: "Threats by source filter. Consists of a required operator and\
        \ an array of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/Rule'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [Rule](/sase/docs/filters#rule) and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            $ref: '#/components/schemas/FilterRule'
          type: array
      required:
      - operator
      type: object
    Filter5:
      description: "Threats list filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/Rule1'
          - $ref: '#/components/schemas/TimeFilter'
          description: "See [Rule1](/sase/docs/filters#rule1) and [TimeFilter](/sase/docs/filters#timefilter).\
            \                            \n"
          items:
            $ref: '#/components/schemas/FilterRule'
          type: array
      required:
      - operator
      type: object
    Filter6:
      description: "Threats summary filter. Consists of a required operator and an\
        \ array of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/Rule2'
          - $ref: '#/components/schemas/RuleName3'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [Rule2](/sase/docs/filters#rule2), [RuleName3](/sase/docs/filters#rulename3),
            and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            $ref: '#/components/schemas/FilterRule'
          type: array
      required:
      - operator
      type: object
    Filter7:
      description: "URL summary filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          anyOf:
          - $ref: '#/components/schemas/RuleName4'
          - $ref: '#/components/schemas/TimeFilter'
          description: 'See [RuleName4](/sase/docs/filters#rulename4), [RuleName3](/sase/docs/filters#rulename3),
            and [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            $ref: '#/components/schemas/FilterRule'
          type: array
      required:
      - operator
      type: object
    Filter8:
      description: "Upgrade list filter. Consists of a required operator and an array\
        \ of rules objects. \n"
      properties:
        operator:
          description: "Must be `AND`. \n"
          type: string
        rules:
          description: 'See [TimeFilter](/sase/docs/filters#timefilter).

            '
          items:
            $ref: '#/components/schemas/TimeFilter'
          type: array
      required:
      - operator
      type: object
    FilterRule:
      type: object
    Property:
      description: 'Test

        '
      properties:
        alias:
          type: string
        property:
          description: "Alert count property. See [Property](/sase/docs/filters#property).\
            \ \n"
          example: sub_tenant_id, total_count, mu_count, rn_count, sc_count
          type: string
      type: object
    Property1:
      description: 'Test

        '
      properties:
        alias:
          type: string
        property:
          description: "App list property. See [Property1](/sase/docs/filters#property1).\
            \ \n"
          example: sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,
            total_app_proxy_nodes
          type: string
      type: object
    Property2:
      description: 'Test

        '
      properties:
        alias:
          type: string
        function:
          description: Operations that need to be run on the property field. Operations
            can be run only on number properties.
          example: count, sum, avg
          type: string
        property:
          description: "App list property. See [Property2](/sase/docs/filters#property2).\
            \ \n"
          example: tenant_id, tenant_name, app, unique_app_count, app_count
          type: string
        sort:
          $ref: '#/components/schemas/Sort'
      type: object
    Property3:
      description: 'Test

        '
      properties:
        alias:
          type: string
        property:
          description: 'App summary property. See [Property3](/sase/docs/filters#property3).

            '
          example: sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,
            total_app_proxy_nodes
          type: string
      type: object
    Property4:
      description: 'Test

        '
      properties:
        alias:
          type: string
        property:
          description: "Threats by source property. See [Property4](/sase/docs/filters#property4).\
            \  \n"
          example: sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,
            total_app_proxy_nodes
          type: string
      type: object
    Property5:
      description: 'Test

        '
      properties:
        alias:
          type: string
        function:
          description: Operations that need to be run on the property field. Operations
            can be run only on number properties.
          example: distinct_count (used with threat_id property), avg (used with threat_count
            property)
          type: string
        property:
          description: "Threat list property. See [Property5](/sase/docs/filters#property5).\
            \  \n"
          example: tenant_id, tenant_name, threat_severity, threat_severity_count,
            url_type, url_count, threat_id, threat_count
          type: string
        sort:
          $ref: '#/components/schemas/Sort'
      type: object
    Property6:
      properties:
        alias:
          type: string
        property:
          description: "Threat summary property. See [Property6](/sase/docs/filters#property6).\
            \ \n"
          example: sub_tenant_id, total_threats, blocked_count, unblocked_count
          type: string
      type: object
    Property7:
      properties:
        alias:
          type: string
        function:
          description: Operations that need to be run on the property field. Operations
            can be run only on number properties.
          example: sum
          type: string
        property:
          description: 'URL summary property. See [Property7](/sase/docs/filters#property7).

            '
          example: sub_tenant_id, uri_count
          type: string
        sort:
          $ref: '#/components/schemas/Sort'
      type: object
    Property8:
      properties:
        alias:
          type: string
        property:
          description: "Upgrade list property. See [Property8](/sase/docs/filters#property8).\
            \   \n"
          example: sub_tenant_id, amiversion, current_software_version, last_upgrade_date,
            next_upgrade_scheduled_str, status, error, next_upgrade_scheduled
          type: string
      type: object
    RequestBody_Alerts:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ApplList:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter2'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property2'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ApplSrc:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter1'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property1'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ApplSummary:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter3'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property3'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ThreatList:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter5'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property5'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ThreatSrc:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter4'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property4'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_ThreatSummary:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter6'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property6'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_UpgradesList:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter8'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property8'
          type: array
      required:
      - properties
      - filter
      type: object
    RequestBody_UrlSummary:
      properties:
        filter:
          allOf:
          - $ref: '#/components/schemas/Filter7'
          - description: filter json object
        properties:
          description: List of property json objects
          items:
            $ref: '#/components/schemas/Property7'
          type: array
      required:
      - properties
      - filter
      type: object
    Rule:
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          example: in
          type: string
        property:
          description: Filter property field that is one of the example values
          example: threat_severity
          type: string
        values:
          description: Filter property values
          example: Critical, High, Medium (used with severity in)
          items:
            type: string
          type: array
      type: object
    Rule1:
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          example: equals
          type: string
        property:
          description: Filter property field that is one of the example values
          example: threat_severity
          type: string
        values:
          description: Filter property value
          example: critical
          items:
            type: string
          type: array
      type: object
    Rule2:
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          example: in
          type: string
        property:
          description: Filter property field that is one of the example values
          example: severity
          type: string
        values:
          description: Filter property values
          example: Critical, High, Medium (used with severity in)
          items:
            type: string
          type: array
      type: object
    RuleName:
      properties:
        rule:
          description: Rule name that is set to one of the example values
          example: app_risky
          type: string
      type: object
    RuleName1:
      properties:
        rule:
          description: Rule name that is set to one of the example values
          example: app_risky
          type: string
      type: object
    RuleName2:
      properties:
        rule:
          description: Rule name that is set to one of the example values
          example: app_risky
          type: string
      type: object
    RuleName3:
      properties:
        rule:
          description: Rule name that is set to one of the example values
          example: blocked, unblocked
          type: string
      type: object
    RuleName4:
      properties:
        rule:
          description: Rule name that is set to one of the example values
          example: url_high_risk, blocked
          type: string
      type: object
    Sort:
      properties:
        order:
          description: Sort Order for the property
          example: desc, asc
          type: string
      type: object
    TimeFilter:
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          example: equals, in, gt, lt, last_n_minutes, last_n_hours, last_n_days
          type: string
        property:
          description: Filter property field that is one of the example values
          example: event_time
          type: string
        values:
          description: Filter property value
          example: minute, hour or day counts if property is event_time
          items:
            type: string
          type: array
      type: object
  securitySchemes:
    Bearer:
      scheme: bearer
      type: http
info:
  contact: {}
  description: 'Use the Data Resource API for retrieving aggregated summaries and
    counts across tenants for threats, alerts, risky applications, URLs, and upgrades.

    '
  title: Data Resource API
  version: '1.0'
openapi: 3.0.2
paths:
  /mt/monitor/v1/agg/alerts/list:
    post:
      description: "Retrieve an aggregated list of alert counts across tenants.  \
        \             \n"
      operationId: post-mt-monitor-v1-agg-alerts-list
      parameters:
      - description: 'Must be `tenant`. Using the query parameter returns all the
          aggregated responses for the current parent tenant and its child tenants.
          If not used, the results for just the current tenant are returned.

          '
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned. \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Alerts Count By Source:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: domain
                      values:
                      - External
                      - external
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_count
                  - property: mu_count
                  - property: rn_count
                  - property: sc_count
              Alerts Count By Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: domain
                      values:
                      - External
                      - external
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - property: total_count
            schema:
              $ref: '#/components/schemas/RequestBody_Alerts'
      responses:
        '200':
          content:
            application/json:
              examples:
                Alerts Count By Source:
                  value:
                  - mu_count: 10
                    rn_count: 10
                    sc_count: 10
                    total_count: 10
                Alerts Count By Tenant:
                  value:
                  - sub_tenant_id: <sub_tenant_id>
                    total_count: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List alert count
      tags:
      - DataResources
  /mt/monitor/v1/agg/applications/list:
    post:
      description: "Retrieve an aggregated list of applications across tenants.  \
        \               \n"
      operationId: post-mt-monitor-v1-agg-applications-list
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                             \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Applications List:
                value:
                  properties:
                  - property: tenant_id
                  - property: tenant_name
                  - property: app
                  - function: avg
                    property: unique_app_count
                  - function: sum
                    property: app_count
                    sort:
                      order: desc
              Risky Applications List:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: tenant_id
                  - property: tenant_name
                  - property: app
                  - function: avg
                    property: unique_app_count
                  - function: sum
                    property: app_count
                    sort:
                      order: desc
            schema:
              $ref: '#/components/schemas/RequestBody_ApplList'
      responses:
        '200':
          content:
            application/json:
              examples:
                Applications List:
                  value:
                  - app: App1
                    app_count: 100
                    tenant_id: '1234'
                    tenant_name: Tenant_1234
                    unique_app_count: 10
                Risky Applications List:
                  value:
                  - app: App1
                    app_count: 100
                    tenant_id: '1234'
                    tenant_name: Tenant_1234
                    unique_app_count: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List applications
      tags:
      - DataResources
  /mt/monitor/v1/agg/applications/source:
    post:
      description: "Retrieve an aggregated count of applications by source across\
        \ tenants, such as: remote networks, mobile users, or proxy nodes.       \
        \            \n"
      operationId: post-mt-monitor-v1-agg-applications-source
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                          \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Risky Application Count by Source:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_app_count
                  - property: total_app_remote_network
                  - property: total_app_mobile_users
                  - property: total_app_proxy_nodes
              Risky Application Count by Source per Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - property: total_app_count
                  - property: total_app_remote_network
                  - property: total_app_mobile_users
                  - property: total_app_proxy_nodes
            schema:
              $ref: '#/components/schemas/RequestBody_ApplSrc'
      responses:
        '200':
          content:
            application/json:
              examples:
                Risky Application Count by Source:
                  value:
                  - total_app_count: 10
                    total_app_mobile_users: 10
                    total_app_proxy_nodes: 10
                    total_app_remote_network: 10
                Risky Application Count by Source per Tenant:
                  value:
                  - sub_tenant_id: <sub_tenant_id>
                    total_app_count: 10
                    total_app_mobile_users: 10
                    total_app_proxy_nodes: 10
                    total_app_remote_network: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List applications by source
      tags:
      - DataResources
  /mt/monitor/v1/agg/applications/summary:
    post:
      description: "Retrieve an aggregated summary count of applications across tenants.\
        \                   \n"
      operationId: post-mt-monitor-v1-agg-applications-summary
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                                                    \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Blocked Risky Apps:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: blocked
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_app_count
                  - property: risk_of_app_count
                  - property: blocked_app_count
              Total Risky Apps:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_app_count
                  - property: risk_of_app_count
              Total Risky Apps Per Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: blocked
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - property: total_app_count
                  - property: risk_of_app_count
              Unblocked Risky Apps:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: unblocked
                    - rule: app_risky
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_app_count
                  - property: risk_of_app_count
                  - property: unblocked_app_count
            schema:
              $ref: '#/components/schemas/RequestBody_ApplSummary'
      responses:
        '200':
          content:
            application/json:
              examples:
                Blocked Risky Apps:
                  value:
                  - blocked_apps_count: 10
                    risk_of_app_count: 10
                    total_app_count: 10
                Total Risky Apps:
                  value:
                  - risk_of_app_count: 10
                    total_app_count: 10
                Total Risky Apps Per Tenant:
                  value:
                  - risk_of_app_count: 10
                    sub_tenant_id: <sub_tenant_id>
                    total_app_count: 10
                Unblocked Risky Apps:
                  value:
                  - risk_of_app_count: 10
                    total_app_count: 10
                    unblocked_apps_count: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List app summary
      tags:
      - DataResources
  /mt/monitor/v1/agg/threats/list:
    post:
      description: "Retrieve an aggregated list of all threats across tenants.   \
        \                 \n"
      operationId: post-mt-monitor-v1-agg-threats-list
      parameters:
      - description: 'Must be `tenant`. Using the query parameter returns all the
          aggregated responses for the current parent tenant and its child tenants.
          If not used, the results for just the current tenant are returned.

          '
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                           \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Threat List:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: equals
                      property: threat_severity
                      values:
                      - critical
                  properties:
                  - property: tenant_id
                  - property: tenant_name
                  - property: threat_severity
                  - property: threat_severity_count
                  - property: url_type
                  - property: url_count
                  - alias: unique_threat_count
                    function: distinct_count
                    property: threat_id
                  - function: avg
                    property: threat_count
            schema:
              $ref: '#/components/schemas/RequestBody_ThreatList'
      responses:
        '200':
          content:
            application/json:
              examples:
                Threat List:
                  value:
                  - tenant_id: '1234'
                    tenant_name: Tenant_1234
                    threat_count: 100
                    threat_severity: critical
                    threat_severity_count: 10
                    unique_threat_count: 10
                    url_count: 10
                    url_type: URL Type
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List threats
      tags:
      - DataResources
  /mt/monitor/v1/agg/threats/source:
    post:
      description: "Retrieve an aggregated count of critical threats by source across\
        \ tenants, such as: remote networks, mobile users, or proxy nodes.       \
        \              \n"
      operationId: post-mt-monitor-v1-agg-threats-source
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                           \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Threat Count by Source:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: severity
                      values:
                      - Critical
                      - High
                      - Medium
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: total_app_count
                  - property: total_app_remote_network
                  - property: total_app_mobile_users
                  - property: total_app_proxy_nodes
              Threat Count by Source per Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: severity
                      values:
                      - Critical
                      - High
                      - Medium
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - property: total_app_count
                  - property: total_app_remote_network
                  - property: total_app_mobile_users
                  - property: total_app_proxy_nodes
            schema:
              $ref: '#/components/schemas/RequestBody_ThreatSrc'
      responses:
        '200':
          content:
            application/json:
              examples:
                Threat Count by Source:
                  value:
                  - total_app_count: 10
                    total_app_mobile_users: 10
                    total_app_proxy_nodes: 10
                    total_app_remote_network: 10
                Threat Count by Source per Tenant:
                  value:
                  - sub_tenant_id: <sub_tenant_id>
                    total_app_count: 10
                    total_app_mobile_users: 10
                    total_app_proxy_nodes: 10
                    total_app_remote_network: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List threats by source
      tags:
      - DataResources
  /mt/monitor/v1/agg/threats/summary:
    post:
      description: "Retrieve an aggregated summary of threats across tenants.    \
        \              \n"
      operationId: post-mt-monitor-v1-agg-threats-summary
      parameters:
      - description: 'Must be `tenant`. Using the query parameter returns all the
          aggregated responses for the current parent tenant and its child tenants.
          If not used, the results for just the current tenant are returned.

          '
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                            \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Blocked Threats:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: severity
                      values:
                      - Critical
                      - High
                      - Medium
                    - rule: blocked
                  properties:
                  - property: total_threats
                  - property: blocked_count
              Total Critical Threats:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                    - operator: in
                      property: severity
                      values:
                      - Critical
                      - High
                      - Medium
                  properties:
                  - property: total_threats
              Unblocked Threats:
                value:
                  filter:
                    operator: AND
                    rules:
                    - operator: in
                      property: severity
                      values:
                      - Critical
                      - High
                      - Medium
                    - rule: unblocked
                  properties:
                  - property: total_threats
                  - property: unblocked_count
            schema:
              $ref: '#/components/schemas/RequestBody_ThreatSummary'
      responses:
        '200':
          content:
            application/json:
              examples:
                Blocked Threats:
                  value:
                  - blocked_count: 10
                    total_threats: 10
                Total Critical Threats:
                  value:
                  - total_threats: 10
                Unblocked Threats:
                  value:
                  - total_threats: 10
                    unblocked_count: 10
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List threat summary
      tags:
      - DataResources
  /mt/monitor/v1/agg/upgrades/list:
    post:
      description: "Retrieve an aggregated upgrade list across tenants.          \
        \          \n"
      operationId: post-mt-monitor-v1-agg-upgrades-list
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                                                     \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Upgrade List:
                value:
                  properties:
                  - property: sub_tenant_id
                  - property: amiversion
                  - property: current_software_version
                  - property: last_upgrade_date
                  - property: next_upgrade_scheduled_str
                  - property: status
                  - property: error
                  - property: next_upgrade_scheduled
            schema:
              $ref: '#/components/schemas/RequestBody_UpgradesList'
      responses:
        '200':
          content:
            application/json:
              examples:
                Upgrade List:
                  value:
                  - amiversion: <amiversion>
                    current_software_version: <current_software_version>
                    error: <error>
                    last_upgrade_date: <last_upgrade_date>
                    next_upgrade_scheduled: <next_upgrade_scheduled>
                    next_upgrade_scheduled_str: <next_upgrade_scheduled_str>
                    status: <status>
                    sub_tenant_id: <sub_tenant_id>
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List upgrades
      tags:
      - DataResources
  /mt/monitor/v1/agg/url/summary:
    post:
      description: "Retrieve an aggregated summary count of URLs across tenants. \
        \                 \n"
      operationId: post-mt-monitor-v1-agg-url-summary
      parameters:
      - description: "Must be `tenant`. Using the query parameter returns all the\
          \ aggregated responses for the current parent tenant and its child tenants.\
          \ If not used, the results for just the current tenant are returned. \n"
        in: query
        name: agg_by
        schema:
          type: string
      - description: "Must be `PA_ONLY`. Using the license query parameter returns\
          \ all the aggregated license details for the current parent tenant and its\
          \ child tenants. If not used, the results for just the current tenant are\
          \ returned.                           \n"
        in: query
        name: license_type
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Blocked Risky URL Count:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: url_high_risk
                    - rule: blocked
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - alias: count
                    function: sum
                    property: uri_count
                    sort:
                      order: desc
              Blocked Risky URL Count By Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: url_high_risk
                    - rule: blocked
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - alias: count
                    function: sum
                    property: uri_count
                    sort:
                      order: desc
              Risky URL Count By Tenant:
                value:
                  filter:
                    operator: AND
                    rules:
                    - rule: url_high_risk
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                  properties:
                  - property: sub_tenant_id
                  - alias: count
                    function: sum
                    property: uri_count
                    sort:
                      order: desc
            schema:
              $ref: '#/components/schemas/RequestBody_UrlSummary'
      responses:
        '200':
          content:
            application/json:
              examples:
                Blocked Risky URL Count:
                  value:
                    count: 10
                Blocked Risky URL Count By Tenant:
                  value:
                  - count: 10
                    sub_tenant_id: <sub_tenant_id>
                Risky URL Count By Tenant:
                  value:
                  - count: 10
                    sub_tenant_id: <sub_tenant_id>
          description: Success
        '400':
          description: Bad Request
        '500':
          description: Server Error
      security:
      - Bearer: []
      summary: List URL count summary
      tags:
      - DataResources
tags:
- name: DataResources
