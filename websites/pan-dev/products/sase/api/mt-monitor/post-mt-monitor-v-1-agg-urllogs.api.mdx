---
id: post-mt-monitor-v-1-agg-urllogs
title: "List top tenants with risky URLs"
description: "Retrieve top tenants with risky URLs."
sidebar_label: "List top tenants with risky URLs"
hide_title: true
hide_table_of_contents: true
api: eJztWWlv3DYQ/SuE+iUBtLtOm7aoUQRwjqIB3CSwHbSAY8hciatlrKskZWex8H/vGx6S9rRzFUFRI5Ylcjic481BZhllQqdKNkbWVXQYnQijpLgWzNQNM6LildHsRpo5U1JfLdjbk2M9Zhs/76oojupGKE58Xmbg1NTajEr8qytpajW6fjTieT5qVVHUuQZ5wxUvhRFKR4fnyzU5/mi1YVPBLp0Ml2P2VssqZ2Yu2N+tUAvWLWdKmFZVmvGisPPYRomcG5FhSjd1pYVms1rZybRVSlSGltMfx57xKmMSmqZzWWRB7zF7OWNVbVirRRbb1eDXFsZxe08iDlkGXkp4kUQ2dpYRH3jZFAJ6ORoMSdLSaoKPCprgE4InU/rW6VyUPDpcRmbR0IyGV6o8ur2NdxmqrvA7s/LMapj4BvSH7DITlzG7BHslU67pXbQKjqK39oqeOqdnyun5vrHULT1lBaOfeNNmwnBZQG9Vl3aPZ7Uy4gN7zg1nx/xKsAfPnh8/hN45xGK6EamcSdLfmjCMS91POYNmYsZh0c5RRNKLy8DUr90Cunv9rNk/sA4emAueCdW74K/Rm6NXf45O7J57PXERR0rAgdo8rbMFUaR1BfcaeuVNU2Ab8tHkvSZHLYMQmt5PBUAjzYKdtBix8HtbTYs6vQJoT1ykqcKSXvOiFY59S8wfx9FMFsA9jbmQq/EeHb16DnlVa3dAPNEbhhFvyVzm84TiNyL8hImwnx0cMJKkd0MgUWZBGiMdkKwYtbIQ++gZRqBggcHfwR1//hCZbMvoYo1bwbVJqiTjC73KFlwrkxgJsw8Y/3CwzkDqBDGYVG1RrDIgPZKSG3hoQwdaAefwQu9ZM9QHcmPjQCq9DYdWaKeJC95Euu1mbZX6INRQfGUfODdx/gKEECrWV4qQdmjj10UyLySQ6KWyANyj4AWWRGfIymfDrHzSZeUVrNwLIXt8TqgBfEVeq0XiuA6tRYAaWUDFUcmLG6S8z3X8zx/vgGC+IN9nOqQz8FuNmsSO0lRoW3P+tcj8omHzRaN4ZxDqulWpSFAhVSKrWe1gfM9o3L74mwlLK9dmWO5QGfC5HdaLoczDgESX8nq2peM5EY4xswIyt2CMQltpqRHuKO6cUcWRCkgM1rWlg1doOhRfEI2FGaun70VKHcy7AQy8KL1jdjZdQOylX7tW9jocQ5Fq4RW5L//frE697GbODRX8Qe/iiyRzEHB9mYZSFYgsQXAEDCSKbKW25yZmBf262Cll1Rqhu+85zNt/+cjaUK939A7pVwW4W4cVEfvojVnbZMiwKx9ZCOwNsUJI3CVUyIX9ls4MMSP1GYwOxR3ENJOzfiFUWEkt0ohSb+l7Otks4ihgwoDDHAkvjd35DJycfDYwvxGUyK2o/rpu31pOP8/Hqxt0BTlmvh4jeh/QucW1CZsCMFk9/DJuRjk8xomOOtmIuuJV4U+FYOcDkosHE821mGR1qicuyenv/KGQUstD683zHjtbFxBI3fvDsU1T63p4KbfpEXIo1ZcOhRe79QuJeQDlVRWdIIz6fBb2Xa9a62uOkdMJOJ1TB6v1UJ/VZWc4bmxJ6b5ibfHiblwfNQ1DgSw5naU91ZhZdwWN3/jhrS5Qniis9Y7oMRk6jpgXmEd5jqs6Q76DiO4tVOKNM+6drgiC3enfgZm65myvq7sDXRL2Ak/H1d8kkCW/Pzj46gc+3ygm/mD6K32M6OMJNS8rbQ9mMTByAyOZEUXf6hz+cHBg8Xi/wwP23ca9H3gSOjRwftxz/siuecc2O5X48Zef4kFHBmr68AaxzdftRupprTAEksfOYavzTzlkcx4nmh+30ZwKBRSzF0ohSdgGzzvSavBUINOihJ1fUOIzPLdNK12KBPRoglspzLwOd2L25svM8TUpzcTfjk2uH014nk9alyjJw3Zj1+9ilHK8MY0+nEx4I8cUjuOGFzUvDEqQuanVlR6ndWkzcJDxlJpRh78g6dJ1qGTAqRvqooH4WxUJv4NIeBEiesex0sftoDMcTH5KT7b1tLO/Xwql89O6ndvNI0Y4A3TKbTlK3ZHYbGTQASGkCp5SqtiAKQLH9g/2Lq07BRy9eWlvGZW7kKWIGtxrusQtfSbxCvJU1Vp3t7buxlMJbmBhKyr+ulvcQbbCGCWA2DJqm1xxSOdSeciKG4KRwYFNJ/6j8YEtNIB2yW3e8wFqS9yea+RozRCDfPpZ19AezkZ8MJOm4Oj3bmMXQksfeedRSWHoY4+0eYQHzGtTjotAhNGcohXEy+UU4Yb8dXtLw+7S1h7gpObTgirNDGdbsUef/9Z19lYLX4nF8Arbp/nIJqRrYJUsZTNlHC5dP82E/19077no3uOZ9Zvt3kFoaB3JM2fs0Rlx6Sk2ept+BZX7xuylHda/N69Pz0A89RfmJZIl3XPyG6oeeEIa+m8km5eIwI4to4JXectzonU8KWHzlkK5a3m7ajYNNbmb4tUQkIhmS3FWX4kKER3sY+jbdRL/AIRXZqc=
sidebar_class_name: "post api-method"
info_path: sase/api/mt-monitor/data-resource-api
custom_edit_url: null
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>List top tenants with risky URLs</h1>

<MethodEndpoint method={"post"} path={"/mt/monitor/v1/agg/urlLogs"}></MethodEndpoint>



Retrieve top tenants with risky URLs.                  


## Request

<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"description":"Must be `tenant`. Using the query parameter returns all the aggregated responses for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned. \n","example":"tenant","in":"query","name":"agg_by","schema":{"type":"string"}}}></ParamsItem></ul></div></details><details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Header Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"description":"Must be one of the following: `de`, `americas`, `europe`, `uk`, `sg`, `ca`, `jp`, `au`, `in`. Returns details from the Cortex Data Lake (CDL) region specified. If no region is specified, the default response is `americas` CDL region.                                                       \n","example":"americas","in":"header","name":"X-PANW-Region","schema":{"type":"string"}}}></ParamsItem></ul></div></details><MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>filter</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Resource count filter. Consists of a required operator and an array of rules objects. 


</div><SchemaItem collapsible={false} name={"operator"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Must be `AND`. \n","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><strong>rules</strong><span style={{"opacity":"0.6"}}> object[]</span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

See [UrlLogsRule](/sase/docs/filters#urllogsrule) and [TimeFilter](/sase/docs/filters#timefilter).


</div></div><div><span className={"badge badge--info"}>anyOf</span><SchemaTabs><TabItem label={"TimeFilter"} value={"0-item-properties"}><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"operator"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Filter operator that is one of the example values and is run on the property field","example":"gt, lt, last_n_minutes, last_n_hours, last_n_days","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Filter property field that is one of the example values","example":"event_time, update_time, updated_time","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"values"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Filter property value","example":"minute, hour or day counts if property is event_time","type":"array","items":{"type":"string"}}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></TabItem><TabItem label={"UrlLogsRule"} value={"1-item-properties"}><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"operator"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Filter operator that is one of the example values and is run on the property field","example":"in","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Filter property field that is one of the example values","example":"url_category_value","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"values"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Filter property values","example":"high-risk, malware \n(used with url_category_value in)","type":"array","items":{"type":"string"}}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></TabItem></SchemaTabs></div></details></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>properties</strong><span className={"openapi-schema__name"}> object[]</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

List of property json objects

</div><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"alias"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"App summary property. See [ResourceProperty](/sase/docs/filters#resourceproperty).\n","example":"severity,alert_id,node_type,node_count","type":"string"}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></div></details></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

Success

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}>any</ul></details></TabItem><TabItem label={"Security Rules and Unblocked Risky Urls"} value={"Security Rules and Unblocked Risky Urls"}><ResponseSamples responseExample={"[\n  {\n    \"rule_name\": \"<rule-name>\",\n    \"sub_tenant_id\": \"<sub-tenant-id>\",\n    \"uri_count\": 300\n  }\n]"} language={"json"}></ResponseSamples></TabItem><TabItem label={"Top Tenants with Risky URLs"} value={"Top Tenants with Risky URLs"}><ResponseSamples responseExample={"[\n  {\n    \"sub_tenant_id\": \"<sub_tenant_id>\",\n    \"value\": 340\n  }\n]"} language={"json"}></ResponseSamples></TabItem><TabItem label={"Top Users Accessing Unblocked Risky Urls"} value={"Top Users Accessing Unblocked Risky Urls"}><ResponseSamples responseExample={"[\n  {\n    \"sub_tenant_id\": \"<sub-tenant-id>\",\n    \"uri_count\": 596,\n    \"user_name\": \"<user-name>\"\n  }\n]"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>

Bad Request

</div><div></div></TabItem><TabItem label={"500"} value={"500"}><div>

Server Error

</div><div></div></TabItem></ApiTabs></div></div>
      