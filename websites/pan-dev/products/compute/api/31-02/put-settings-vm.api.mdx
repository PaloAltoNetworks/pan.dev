---
id: put-settings-vm
title: "Update VM Image Scan Settings"
description: "Updates the list of VM image scan scopes."
sidebar_label: "Update VM Image Scan Settings"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "put api-method"
info_path: compute/api/31-02/prisma-cloud-compute-api
custom_edit_url: null
hide_send_button: true
show_extensions: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Update VM Image Scan Settings</h1>

<MethodEndpoint method={"put"} path={"/api/v31.02/settings/vm"}></MethodEndpoint>



```
x-prisma-cloud-target-env: {"permission":"policyHosts","saas":true,"self-hosted":true}
x-public: true
```



Updates the list of VM image scan scopes.
The list of scopes are updated in a single shot.

To invoke this endpoint in the Console UI:

1. Navigate to **Defend > Vulnerabilities > Hosts > VM images**.
2. Under the **VM images scope** table, add a registry item using **+ Add scope**.

   **Note:** If the **+ Add scope** button is not present, use the **Add the first item** link.

3. Click the **Save** button.

### General Set up and Scan Process

This endpoint works hand-in-hand with the `/policies` endpoints.
Prisma Cloud auto-discovers the VM images in your cloud account according to the scan scopes specified in `/settings/vm`.
The list of auto-discovered VM images is passed to the scanner for evaluation.
The scanner uses the corresponding `/policies/vulnerability/vms` endpoint to assess each VM image.

### cURL Request

Each VM image scan scope is specified as an element in the endpoint's payload array.

The critical fields for this endpoint are:

* `version` - Cloud provider.
Currently, only Amazon AWS is supported.
* `region` - Region to scan.
* `credentialID` - Credential ID from the credentials store so Prisma Cloud can authenticate with the cloud provider to access the VM images.
* `collections` - Filter for refining the scope of VM images to scan.
You can scope by VM image name and AWS tag.
* `consoleAddr` - Address for Console that Defender (the scanner) can reach over the network to publish scan results.

Refer to the following example cURL command that overwrites all current scan scopes with single scan scope:

```bash
$ curl 'https://<CONSOLE>/api/v<VERSION>/settings/vm' \
  -k \
  -X PUT \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -d \
  '[
      {
        "version":"aws",
        "region":"us-east-1",
        "credentialID":"IAM Role",
        "collections":[{"name":"All"}],
        "cap": 5,
        "scanners": 1,
        "consoleAddr":"127.0.0.1"
      }
    ]'
```

**Note:** No response will be returned upon successful execution.


## Request

<MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><span style={{"opacity":"0.6"}}> array</span></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"cap"} required={false} schemaName={"integer"} qualifierMessage={undefined} schema={{"description":"Specifies the maximum number of images to fetch and scan, ordered by most recently modified.\n","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"consoleAddr"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Network-accessible address that Defender can use to publish scan results to Console.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"credentialID"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"ID of the credentials in the credentials store to use for authenticating with the cloud provider.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"enableSecureBoot"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"EnableSecureBoot indicates secure boot should be enabled for the instance launched for scanning (currently only supported with GCP).\n","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"excludedImages"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"Images to exclude from scanning.\n","items":{"type":"string","title":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"gcpProjectID"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"GCP project ID to use for listing VM images instead of the default associated with the GCP credential (optional).\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"imageType"} required={false} schemaName={"common.ImageType (string)"} qualifierMessage={undefined} schema={{"description":"ImageType is the type of a VM image.\nFor example, in the case of Azure this is one of marketplace/managed/gallery.","type":"string","title":"common.ImageType"}}></SchemaItem><SchemaItem collapsible={false} name={"images"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"The names of images to scan.\n","items":{"type":"string","title":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"instanceType"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"InstanceType is the instance type to use for the instance launched for scanning. For example, the default instance type for AWS is \"m4.large\".\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"labels"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"The labels to use to target images to scan.\n","items":{"type":"string","title":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"region"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Cloud provider region.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"scanners"} required={false} schemaName={"integer"} qualifierMessage={undefined} schema={{"description":"Number of Defenders that can be utilized for each scan job.\n","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"subnetID"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"SubnetID is the network subnet ID to use for the instance launched for scanning. Default value is empty string, which represents the default subnet in the VPC.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"vpcID"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"VPCID is the network VPC ID to use for the instance launched for scanning. Default value is empty string, which represents the default VPC in the region.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"zone"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Cloud provider zone (part of a region). On GCP, designates in which zone to deploy the VM scan instance.\n","type":"string"}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

OK

</div><div></div></TabItem><TabItem label={"default"} value={"default"}><div></div><div></div></TabItem></ApiTabs></div></div>
      