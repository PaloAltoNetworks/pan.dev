---
id: put-custom-rules-id
title: "Update a Custom Rule"
description: "Creates or updates a custom rule."
sidebar_label: "Update a Custom Rule"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "put api-method"
info_path: compute/api/prisma-cloud-compute-api
custom_edit_url: null
hide_send_button: true
show_extensions: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Update a Custom Rule</h1>

<MethodEndpoint method={"put"} path={"/api/v33.00/custom-rules/{id}"}></MethodEndpoint>



```
x-prisma-cloud-target-env: {"permission":"policyCustomRules"}
```



Creates or updates a custom rule.

To invoke this endpoint in the Console UI:

1. Navigate to **Defend > Custom rules**.
2. Click **+ Add rule** or the dotted icon under the **Actions** column and choose to the **Manage** cog icon to open the update window.
3. Configure the custom rule's parameters. 
4. Click the **Add** or **Update** button to save the changes.

### cURL Request

Refer to the following example cURL command that updates a custom rule.

```bash
$ curl 'https://<CONSOLE>/api/v<VERSION>/custom-rules/{id}' \
  -k \
  -X PUT \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -d \
'{
   "_id":{id},
   "type":"processes",
   "message":"unexpected %proc.name was spawned",
   "name":"<CUSTOM_RULE_NAME>",
   "script":"proc.interactive"
}'
```

**Note:** No response will be returned upon successful execution.


## Request

<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Path Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"in":"path","name":"id","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details><MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"_id"} required={false} schemaName={"integer"} qualifierMessage={undefined} schema={{"description":"Rule ID. Must be unique.\n","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"attackTechniques"} required={false} schemaName={"mitre.Technique (string)[]"} qualifierMessage={"**Possible values:** [`exploitationForPrivilegeEscalation,exploitPublicFacingApplication,applicationExploitRCE,networkServiceScanning,endpointDenialOfService,exfiltrationGeneral,systemNetworkConfigurationDiscovery,unsecuredCredentials,credentialDumping,systemInformationDiscovery,systemNetworkConnectionDiscovery,systemUserDiscovery,accountDiscovery,cloudInstanceMetadataAPI,accessKubeletMainAPI,queryKubeletReadonlyAPI,accessKubernetesAPIServer,softwareDeploymentTools,ingressToolTransfer,lateralToolTransfer,commandAndControlGeneral,resourceHijacking,manInTheMiddle,nativeBinaryExecution,foreignBinaryExecution,createAccount,accountManipulation,abuseElevationControlMechanisms,supplyChainCompromise,obfuscatedFiles,hijackExecutionFlow,impairDefences,scheduledTaskJob,exploitationOfRemoteServices,eventTriggeredExecution,accountAccessRemoval,privilegedContainer,writableVolumes,execIntoContainer,softwareDiscovery,createContainer,kubernetesSecrets,fileAndDirectoryDiscovery,masquerading,webShell,compileAfterDelivery`]"} schema={{"description":"List of attack techniques.\n","items":{"description":"Technique is the MITRE framework attack technique","enum":[["exploitationForPrivilegeEscalation","exploitPublicFacingApplication","applicationExploitRCE","networkServiceScanning","endpointDenialOfService","exfiltrationGeneral","systemNetworkConfigurationDiscovery","unsecuredCredentials","credentialDumping","systemInformationDiscovery","systemNetworkConnectionDiscovery","systemUserDiscovery","accountDiscovery","cloudInstanceMetadataAPI","accessKubeletMainAPI","queryKubeletReadonlyAPI","accessKubernetesAPIServer","softwareDeploymentTools","ingressToolTransfer","lateralToolTransfer","commandAndControlGeneral","resourceHijacking","manInTheMiddle","nativeBinaryExecution","foreignBinaryExecution","createAccount","accountManipulation","abuseElevationControlMechanisms","supplyChainCompromise","obfuscatedFiles","hijackExecutionFlow","impairDefences","scheduledTaskJob","exploitationOfRemoteServices","eventTriggeredExecution","accountAccessRemoval","privilegedContainer","writableVolumes","execIntoContainer","softwareDiscovery","createContainer","kubernetesSecrets","fileAndDirectoryDiscovery","masquerading","webShell","compileAfterDelivery"]],"type":"string","title":"mitre.Technique"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"description"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Description of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Macro that is printed as part of the audit/incident message.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"minVersion"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Minimum version required to support the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"modified"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"Datetime when the rule was created or last modified.\n","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"owner"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"User who created or modified the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"script"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Custom script.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"type"} required={false} schemaName={"customrules.Type (string)"} qualifierMessage={"**Possible values:** [`processes,filesystem,network-outgoing,kubernetes-audit,waas-request,waas-response`]"} schema={{"description":"Type is the type of the custom rule","enum":[["processes","filesystem","network-outgoing","kubernetes-audit","waas-request","waas-response"]],"type":"string","title":"customrules.Type"}}></SchemaItem><SchemaItem collapsible={false} name={"vulnIDs"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"VulnIDs is the list of vulnerability IDs","items":{"type":"string","title":"string"},"type":"array","title":"customrules.VulnIDs"}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

OK

</div><div></div></TabItem><TabItem label={"default"} value={"default"}><div></div><div></div></TabItem></ApiTabs></div></div>
      