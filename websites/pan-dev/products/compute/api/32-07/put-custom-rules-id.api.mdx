---
id: put-custom-rules-id
title: "Update a Custom Rule"
description: "Creates or updates a custom rule."
sidebar_label: "Update a Custom Rule"
hide_title: true
hide_table_of_contents: true
api: eJztWm1vG7kR/iuE0msS1ZKd5K49CD4XiqQ06tmWIcnpFVFgUbuUxHhFbpdcyarh/95nSO5q/Zoe7op+cT4EXnI4nDfOPBzquhYLE2UytVKrWqvWyQS3wjCdsTyN3Z+cRbmxesWyPBHNiZqosWZSrfWlYHYpDRMqTrVUFoMYEKyjldGJYOf9FlG/abJTvpYLMGNWs3q9K+ZYwo5YZ8fX1Otg/bbJOomMLkH0J9aOYzdVr5M0xDjW1oqYyUgrlqtY+NF6vR2R9GDBIp3kK8U42EdLrY3b0ROdcMUXwtEsPAtM6VR4mb2ybCNVrDeQ5F2T1JjLRZ4JR1CxwUvDUp7xlbAiM002Ud8XYgdx4tjLXK+fO7b4muXW+i0NXweOS64WwjiLvnjxgkXnw2M2FP/KhbE0NoSZskL+uU4SDekWTFzxVQrrOvJIr1akrF1y+4TDptPpjJvlRP0BU1nCXi6tTU1rf/+wMzgdDY57R/s8lfvrw0+94ag/OD3a9xwazjX71zK+eckmk4lirHFZ/PELOzsfFx85Ozwf9YZHxfdH9hL2s0LZxnibihbjaQoTcXLU/lejVckvdn+8vKYPNqldyHhSa9GOe2HEYj2GJrU005EwRphJrZhb4RteddO5ElepiChCviPSpoKL2IYbZlK+USLeLaMZt+awcz4aD04uhufHvYvT9knvaEfkj0W5cxMRLjKOUFtj7UTdvHR2JfPW66faihbcfKpZJkyKYKRYShI2ExiweYbt4R9EgMkjUmKeJ/CkiHIyCHxU26vtYqrW+nxdk3QcU26XmCJ58SVj/J0hQmQm4lrLZrnYg5hLseIwmTMUqIzNECe1m5svnhjh9F7HW6KIvEvoz7v+oLEdq9tJYYgogBopVMPqOwFGkmc4R5mVwtBaePARFv1uk51gJVklVxKiec2D4GTghchqN3s1bi2PLsciWjoyc5/hsQQfPWeektmS1LOUVqweWFVyZMhbdK5O+uNhj83J8hudXd5jB1ZC5St45HMN4ZVoaZ3NPujsLJNrmUDinol44kaJ2hOd5TOY9wOP4Ir2ztQgqBi+52mHnR75WFiSYCSytYzEKOJKkRtpf59eu0JJngzmgcLtNZeJzRyvvwmF6EwwarYGyp96dkUSczRdaSK9FtkWVDlCFLlAxMj4MbwK1gbDUfnVzVepF8Az7Ku5zlb3+NzdTYnoYZJzI7LqKI8inUOrylCU6DzuK2O5isSJsBz5jLfP+p4ap+bnfCYSYU+4VH4YHsq2YXQoeKxVsr27AGcPWRGjZDiEFwTSc7vhmegK2H+7gr5jrZ36UBhBbuhznHFl5o4eziXb3hkNubetYsp0mU52LgAPnWeR+Ci/Ipq8FUHbV+OlOJFx7E6N4pRK3kvFs22vSAUYh5mFXKj7E5GrzW1vt50FUdhkmpcByGe5Eb1ErN1AEO1EULWRZkVKmhwhuO0sYcWOXuHwrqQhgfRsniOUkUA/IK6JcunkL2X4gBJERlqlXGauikeOjPJGjAMej7m5/Lue7Y6Bk2EwH4oVEmQIXFoh1mT0TC5w3kVcVTIo1Xbuo3VrZ9G0OGzO2JDcuWCTYYtZIj5R2feMwaqvrK5Sle6uhpqzZZXqsgyVkcCsJW44XgL+7SLfRlZn2yqHFTcUfTz27t2I2WgpksQHRkoL54iarkikW/Dly96dBI1vaRMaWEmbiWaZmygBBlKeZXxL37fS2N2s1t19UUqkvBZKf+3upmAVauZ9Nic8yrSHEsiOsLiiWsod2rEFY57H0u5LFUnKEywwe2wrqT6hnj0o9IlUcpWv2NoTsKKuOYyECNXY81ua6FjOpXig3HThXCup/C8DwCM2Dgx4z8eEzxKOGlIw8Xv4HOeL0Z+/f7A2+WJ8d8dTAhvfNr7eULTdW03JEbLqqnSFYN9i6fnc5xnQtR96ZK0fuFclMVoUSKIo9Lpd9cu6WOKycGJ8vt+VtIbO7UL7kN+dsoaLJDo5nJtGACq7Tw+injw2XhwHUZskMim0zhPV7z5Q+T/5iUKtJMAHoschnslE2i2jlRXs8NjGd+0XjunDkoWNgcdKcj37inzyCD0hJRATeWEFJ8zbg4P7Wg1+9slhzvPkgRDwm/IFIcoQDw3ib2ow61UDR9yseMOV3Ybl2ULYhlBr4gM8h6rgT24t1UAsW7/eL6dIBolL7/2YSHLbqN4ZGg6riivATWLiIe2lAAp9Yl+4jye5+G/2J3ALsLzUYXOHn4GVWzV/k3n3tnnwl/u3GJAR2B3uYHHPX6dK4HrwEPh8Bn/P4O8Z/D2Dv98C/m5n5rKmlGisMlRBTZXREuwclA2BcjLAit1AAQoqxcvVnv9xta4U4M/F1l9u6GjNtauooeCduQrAOnTmGcVhbgXzZ3ddqu5yePPN23e1u9Z7wT7qDQFFQQWDGndlI4v6Me0kcUW+aJWBcdEpM6FJaaibGOUr188wqYjkfMs4m5Z8pmzNM0nxtQdgJqNltQHigHAcU7ZgOLFFxxMga1zpfxYUrhEUi5SangC6S4hekBAglZTzksQhUOoEMpQXNuJ8xPp+xp0jExqvcwkuWySYW7JS7XOScL8S1VRmWpF6RQ/2mNqeOBwVYd/e7cwGT9Tr7KjaMaWPkQuT8NFFvCWax75r+67J/qlzhqL1lHSEuKgJ5vq29foZje2kAaOy9dvR6RYbYRI3gugy2cJ56dYZPQ2r3BZRItOZ5pk33KFcLZjJop8m1OYinhcGwdlM1WJSYzyxuwl8b2Rslxh5c3Dw3aS278Kman6RzBtL7SS+5wUiMBWCirHNnhPzsfAm9InkqI1wkeDuONMfD358N2WvPo7HZ6PXLoTo9kVTsghNugXQrcxLwtzNBnE8tRsYNdHRZTOaL6bODHUY8FXXA8LXbFcCi8VeDepVFjFofGauyjajs3AMB78HtkGez4g1NaUtxbcDaS7aqk4OwLq6KnStPcOKsi4kJ9Z3T23Ziz4etLsX79vH7dNOb3jUItIdmVNsoMRMXz2uSnmUyLqcEZaIGzzRSjDyVdPv+00d+mfl2QVB93TEVOV2R5x+pWb9s4t2tzvsjUb31HrBzg219f39Kkt2/f2QsHxcksyu419Mk+iCIy3tXl9wt/XKbyROCWeAApkT/NW07M9PXzOCSc0KRzq3M1G5bmpaybjaFhqXjw+twhHtHONAih7KsrG+FIoccW7828a08XHKtO9IgF/KTUiat9dZWsfmACF+lcfub/YrZGJafV8KryGh/rAlUJ8PTncog232KFUnHCE9PWx3OrD6xXjwc+8UDnaWcdfaX7Xzg48o4SWEnjrIHDqT/3Zatdh7AcCRsdub+wcPejUZjPyzySOPMG/2D3un3bNB/3R8cdYefzzavTPQi1LhVHr2OYNdUbPj26bPp25y2kgLHxhyglRRkseeKK9ySQOXPQa8AvABLUJAKuHjQdDTByKqoKTkg+MlkE9j4FQcNJE+5QUfejvrl9t7iODFPTxrj0b/GAy7VcpyR0/5pCNuvUE1UrZj+DubfoATRCZ3mdpV99C8KpVzT4RBctgPx8uZ0LfTfkfL/Qp7/Cbtywcup7IkHVa4qTB/jWT+Jk6tQxXCrIigShAy5Dno5Eq3peu94gkDO8LWbKPVS8siD8lveb4ZCrOrn8jJ0DsqS/FEnfEFRSws6+ddYoB8kCrCbdvHL6TlV5TNfjjYPcf5LoyBcyJOCY+QOkuoG1G+4SGj6jyJWVePKrBpovqhz1c89QW5jTeKMwN2ChvssWgbJTSc6Xzh3Rgho/q78s61Uz2fG2GnzN1rd0/MpACEziTuTX6DwLh5K2paIRSecK9cAc+Zv9Ihtz/9cPBHv+FPv4R11NVB/bcoO4TVwx3DP2HDhKGfOPTdvzsN6fJl8fkXBM+/IHj+BcH/5xcEob1sxZXdRwGR7kTDW66h6rqjn2vwEl2y3d2a2hUVL+GzJWO6xBPEJeLrazhdnGfJzQ0Nu8SEcbrmh8ux6+vG0tDfca0154kRTySHV8PwyvOaPSZv0VJX210/uEa9CNc8hnw31FDwyK/SVa7GSmXhvZ853GocI/xAOwu/jgACpiUZpz4X/e/2DQiKCNzYdQ2Xm0XuezaeJf37DxeoG1k=
sidebar_class_name: "put api-method"
info_path: compute/api/32-07/prisma-cloud-compute-api
custom_edit_url: null
show_extensions: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Update a Custom Rule</h1>

<MethodEndpoint method={"put"} path={"/api/v32.07/custom-rules/{id}"}></MethodEndpoint>



```
x-prisma-cloud-target-env: {"permission":"policyCustomRules"}
```



Creates or updates a custom rule.

To invoke this endpoint in the Console UI:

1. Navigate to **Defend > Custom rules**.
2. Click **+ Add rule** or the dotted icon under the **Actions** column and choose to the **Manage** cog icon to open the update window.
3. Configure the custom rule's parameters. 
4. Click the **Add** or **Update** button to save the changes.

### cURL Request

Refer to the following example cURL command that updates a custom rule.

```bash
$ curl 'https://<CONSOLE>/api/v<VERSION>/custom-rules/{id}' \
  -k \
  -X PUT \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -d \
'{
   "_id":{id},
   "type":"processes",
   "message":"unexpected %proc.name was spawned",
   "name":"<CUSTOM_RULE_NAME>",
   "script":"proc.interactive"
}'
```

**Note:** No response will be returned upon successful execution.


## Request

<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Path Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"in":"path","name":"id","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details><MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"_id"} required={false} schemaName={"integer"} qualifierMessage={undefined} schema={{"description":"Rule ID. Must be unique.\n","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"attackTechniques"} required={false} schemaName={"mitre.Technique (string)[]"} qualifierMessage={"**Possible values:** [`exploitationForPrivilegeEscalation,exploitPublicFacingApplication,applicationExploitRCE,networkServiceScanning,endpointDenialOfService,exfiltrationGeneral,systemNetworkConfigurationDiscovery,unsecuredCredentials,credentialDumping,systemInformationDiscovery,systemNetworkConnectionDiscovery,systemUserDiscovery,accountDiscovery,cloudInstanceMetadataAPI,accessKubeletMainAPI,queryKubeletReadonlyAPI,accessKubernetesAPIServer,softwareDeploymentTools,ingressToolTransfer,lateralToolTransfer,commandAndControlGeneral,resourceHijacking,manInTheMiddle,nativeBinaryExecution,foreignBinaryExecution,createAccount,accountManipulation,abuseElevationControlMechanisms,supplyChainCompromise,obfuscatedFiles,hijackExecutionFlow,impairDefences,scheduledTaskJob,exploitationOfRemoteServices,eventTriggeredExecution,accountAccessRemoval,privilegedContainer,writableVolumes,execIntoContainer,softwareDiscovery,createContainer,kubernetesSecrets,fileAndDirectoryDiscovery,masquerading,webShell,compileAfterDelivery`]"} schema={{"description":"List of attack techniques.\n","items":{"description":"Technique is the MITRE framework attack technique","enum":[["exploitationForPrivilegeEscalation","exploitPublicFacingApplication","applicationExploitRCE","networkServiceScanning","endpointDenialOfService","exfiltrationGeneral","systemNetworkConfigurationDiscovery","unsecuredCredentials","credentialDumping","systemInformationDiscovery","systemNetworkConnectionDiscovery","systemUserDiscovery","accountDiscovery","cloudInstanceMetadataAPI","accessKubeletMainAPI","queryKubeletReadonlyAPI","accessKubernetesAPIServer","softwareDeploymentTools","ingressToolTransfer","lateralToolTransfer","commandAndControlGeneral","resourceHijacking","manInTheMiddle","nativeBinaryExecution","foreignBinaryExecution","createAccount","accountManipulation","abuseElevationControlMechanisms","supplyChainCompromise","obfuscatedFiles","hijackExecutionFlow","impairDefences","scheduledTaskJob","exploitationOfRemoteServices","eventTriggeredExecution","accountAccessRemoval","privilegedContainer","writableVolumes","execIntoContainer","softwareDiscovery","createContainer","kubernetesSecrets","fileAndDirectoryDiscovery","masquerading","webShell","compileAfterDelivery"]],"type":"string","title":"mitre.Technique"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"description"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Description of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Macro that is printed as part of the audit/incident message.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"minVersion"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Minimum version required to support the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"modified"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"Datetime when the rule was created or last modified.\n","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"owner"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"User who created or modified the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"script"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Custom script.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"type"} required={false} schemaName={"customrules.Type (string)"} qualifierMessage={"**Possible values:** [`processes,filesystem,network-outgoing,kubernetes-audit,waas-request,waas-response`]"} schema={{"description":"Type is the type of the custom rule","enum":[["processes","filesystem","network-outgoing","kubernetes-audit","waas-request","waas-response"]],"type":"string","title":"customrules.Type"}}></SchemaItem><SchemaItem collapsible={false} name={"vulnIDs"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"VulnIDs is the list of vulnerability IDs","items":{"type":"string","title":"string"},"type":"array","title":"customrules.VulnIDs"}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

OK

</div><div></div></TabItem><TabItem label={"default"} value={"default"}><div></div><div></div></TabItem></ApiTabs></div></div>
      