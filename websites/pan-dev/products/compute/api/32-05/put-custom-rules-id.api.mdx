---
id: put-custom-rules-id
title: "Update a Custom Rule"
description: "Creates or updates a custom rule."
sidebar_label: "Update a Custom Rule"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "put api-method"
info_path: compute/api/32-05/prisma-cloud-compute-api
custom_edit_url: null
show_extensions: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Update a Custom Rule</h1>

<MethodEndpoint method={"put"} path={"/api/v32.05/custom-rules/{id}"}></MethodEndpoint>



```
x-prisma-cloud-target-env: {"permission":"policyCustomRules","saas":true,"self-hosted":true}
x-public: true
```



Creates or updates a custom rule.

To invoke this endpoint in the Console UI:

1. Navigate to **Defend > Custom rules**.
2. Click **+ Add rule** or the dotted icon under the **Actions** column and choose to the **Manage** cog icon to open the update window.
3. Configure the custom rule's parameters. 
4. Click the **Add** or **Update** button to save the changes.

### cURL Request

Refer to the following example cURL command that updates a custom rule.

```bash
$ curl 'https://<CONSOLE>/api/v<VERSION>/custom-rules/{id}' \
  -k \
  -X PUT \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -d \
'{
   "_id":{id},
   "type":"processes",
   "message":"unexpected %proc.name was spawned",
   "name":"<CUSTOM_RULE_NAME>",
   "script":"proc.interactive"
}'
```

**Note:** No response will be returned upon successful execution.


## Request

<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Path Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"in":"path","name":"id","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details><MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"_id"} required={false} schemaName={"integer"} qualifierMessage={undefined} schema={{"description":"Rule ID. Must be unique.\n","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"attackTechniques"} required={false} schemaName={"mitre.Technique (string)[]"} qualifierMessage={"**Possible values:** [`exploitationForPrivilegeEscalation,exploitPublicFacingApplication,applicationExploitRCE,networkServiceScanning,endpointDenialOfService,exfiltrationGeneral,systemNetworkConfigurationDiscovery,unsecuredCredentials,credentialDumping,systemInformationDiscovery,systemNetworkConnectionDiscovery,systemUserDiscovery,accountDiscovery,cloudInstanceMetadataAPI,accessKubeletMainAPI,queryKubeletReadonlyAPI,accessKubernetesAPIServer,softwareDeploymentTools,ingressToolTransfer,lateralToolTransfer,commandAndControlGeneral,resourceHijacking,manInTheMiddle,nativeBinaryExecution,foreignBinaryExecution,createAccount,accountManipulation,abuseElevationControlMechanisms,supplyChainCompromise,obfuscatedFiles,hijackExecutionFlow,impairDefences,scheduledTaskJob,exploitationOfRemoteServices,eventTriggeredExecution,accountAccessRemoval,privilegedContainer,writableVolumes,execIntoContainer,softwareDiscovery,createContainer,kubernetesSecrets,fileAndDirectoryDiscovery,masquerading,webShell,compileAfterDelivery`]"} schema={{"description":"List of attack techniques.\n","items":{"description":"Technique is the MITRE framework attack technique","enum":[["exploitationForPrivilegeEscalation","exploitPublicFacingApplication","applicationExploitRCE","networkServiceScanning","endpointDenialOfService","exfiltrationGeneral","systemNetworkConfigurationDiscovery","unsecuredCredentials","credentialDumping","systemInformationDiscovery","systemNetworkConnectionDiscovery","systemUserDiscovery","accountDiscovery","cloudInstanceMetadataAPI","accessKubeletMainAPI","queryKubeletReadonlyAPI","accessKubernetesAPIServer","softwareDeploymentTools","ingressToolTransfer","lateralToolTransfer","commandAndControlGeneral","resourceHijacking","manInTheMiddle","nativeBinaryExecution","foreignBinaryExecution","createAccount","accountManipulation","abuseElevationControlMechanisms","supplyChainCompromise","obfuscatedFiles","hijackExecutionFlow","impairDefences","scheduledTaskJob","exploitationOfRemoteServices","eventTriggeredExecution","accountAccessRemoval","privilegedContainer","writableVolumes","execIntoContainer","softwareDiscovery","createContainer","kubernetesSecrets","fileAndDirectoryDiscovery","masquerading","webShell","compileAfterDelivery"]],"type":"string","title":"mitre.Technique"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"description"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Description of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Macro that is printed as part of the audit/incident message.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"minVersion"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Minimum version required to support the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"modified"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"Datetime when the rule was created or last modified.\n","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"owner"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"User who created or modified the rule.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"script"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Custom script.\n","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"type"} required={false} schemaName={"customrules.Type (string)"} qualifierMessage={"**Possible values:** [`processes,filesystem,network-outgoing,kubernetes-audit,waas-request,waas-response`]"} schema={{"description":"Type is the type of the custom rule","enum":[["processes","filesystem","network-outgoing","kubernetes-audit","waas-request","waas-response"]],"type":"string","title":"customrules.Type"}}></SchemaItem><SchemaItem collapsible={false} name={"vulnIDs"} required={false} schemaName={"string (string)[]"} qualifierMessage={undefined} schema={{"description":"VulnIDs is the list of vulnerability IDs","items":{"type":"string","title":"string"},"type":"array","title":"customrules.VulnIDs"}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

OK

</div><div></div></TabItem><TabItem label={"default"} value={"default"}><div></div><div></div></TabItem></ApiTabs></div></div>
      