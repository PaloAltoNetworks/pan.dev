---
id: list-vulnerable-assets
title: "Get Vulnerable Assets by RQL"
description: "Get the list of vulnerable Assets and their IDs based on an RQL query. For vulnerability RQL query attributes, see [Vulnerability Query Attributes](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-attributes). For example queries, see [Vulnerability Query Examples](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-examples)."
sidebar_label: "Get Vulnerable Assets by RQL"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: prisma-cloud/api/cspm/vulnerability-search-and-investigate-api
custom_edit_url: null
hide_send_button: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Get Vulnerable Assets by RQL</h1>

<MethodEndpoint method={"post"} path={"/uve/api/v1/vulnerabilities/search/asset"}></MethodEndpoint>



Get the list of vulnerable Assets and their IDs based on an RQL query. For vulnerability RQL query attributes, see [Vulnerability Query Attributes](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-attributes). For example queries, see [Vulnerability Query Examples](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-examples).
>**Note:** You need 'investigateVulnerabilityRql' feature with 'View' permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that **Investigate > Vulnerability** is enabled.

## Request

<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"page_token","in":"query","required":false,"schema":{"type":"string"},"description":"Token for pagination"}}></ParamsItem></ul></div></details><MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"query"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Search query","example":"vulnerability where age > 30 days"}}></SchemaItem><SchemaItem collapsible={false} name={"cveId"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"CVE ID"}}></SchemaItem><SchemaItem collapsible={false} name={"assetLifecycle"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** [`code`, `build`, `deploy`, `run`]"} schema={{"type":"string","description":"Asset Lifecycle","enum":["code","build","deploy","run"]}}></SchemaItem><SchemaItem collapsible={false} name={"assetType"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** [`package`, `serverlessFunction`, `iac`, `deployedImage`, `vmImage`, `registryImage`, `host`]"} schema={{"type":"string","description":"Asset Type","enum":["package","serverlessFunction","iac","deployedImage","vmImage","registryImage","host"]}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

Successful response

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>value</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

List of Asset Information

</div><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"id"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Asset ID"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Asset name"}}></SchemaItem><SchemaItem collapsible={false} name={"atRisk"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"type":"boolean","description":"At Risk"}}></SchemaItem><SchemaItem collapsible={false} name={"internetExposed"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"type":"boolean","description":"Internet Exposed"}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"nextPageToken"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Token for next page"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"value\": [\n    {\n      \"id\": \"string\",\n      \"name\": \"string\",\n      \"atRisk\": true,\n      \"internetExposed\": true\n    }\n  ],\n  \"nextPageToken\": \"string\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>

Bad Request

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"code"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error code"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error message"}}></SchemaItem><SchemaItem collapsible={false} name={"target"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error target"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"code\": \"string\",\n  \"message\": \"string\",\n  \"target\": \"string\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"401"} value={"401"}><div>

Unauthorized

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"code"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error code"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error message"}}></SchemaItem><SchemaItem collapsible={false} name={"target"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error target"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"code\": \"string\",\n  \"message\": \"string\",\n  \"target\": \"string\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"403"} value={"403"}><div>

Forbidden

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"code"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error code"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error message"}}></SchemaItem><SchemaItem collapsible={false} name={"target"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Error target"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"code\": \"string\",\n  \"message\": \"string\",\n  \"target\": \"string\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      