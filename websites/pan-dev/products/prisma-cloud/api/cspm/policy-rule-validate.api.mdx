---
id: policy-rule-validate
title: "Pre-validate Policy Rule"
description: "Pre-validates a policy rule without creating an actual policy."
sidebar_label: "Pre-validate Policy Rule"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: prisma-cloud/api/cspm/prisma-cloud-user-policy-api-overview
custom_edit_url: null
hide_send_button: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Heading from "@theme/Heading";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Pre-validate Policy Rule</h1>

<MethodEndpoint method={"post"} path={"/policy/rule/validate"}></MethodEndpoint>



Pre-validates a policy rule without creating an actual policy.  

The only request body parameters for this request are:

* **policyType** - Only the following are valid values for **policyType**:
    * "config" 
    * "network"
    * "audit_event" 
    * "iam" 

* **rule** - The **rule.criteria** value is the RQL search query for the rule you want to validate. Validation of this rule implies validation of a policy you might create with this rule.

Only the parameters above apply to this request, and both of these parameters are required.

The JSON below is an example of valid request body parameters:

```json
{
    "policyType": "config",
    "rule": {
        "criteria": "config from cloud.resource where cloud.type = '\''azure'\'' AND api.name = '\''azure-security-center-settings'\'' AND json.rule = '\''autoProvisioningSettings[*].name equals default and (autoProvisioningSettings[*].properties.autoProvision equals Off or autoProvisioningSettings[*] does not exist)'\''"
    }
}
``` 


## Request

<MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json; charset=UTF-8"} value={"application/json; charset=UTF-8-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}><div style={{"marginTop":"1rem","marginBottom":"1rem"}}>

Model for Policy

</div></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"cloudType"} required={false} schemaName={"string"} qualifierMessage={"**Possible values:** [`ALL`, `AWS`, `AZURE`, `GCP`, `ALIBABA_CLOUD`, `OCI`, `IBM`]"} schema={{"description":"Cloud type (Required for config policies). Not case-sensitive. Default is **ALL**.","enum":["ALL","AWS","AZURE","GCP","ALIBABA_CLOUD","OCI","IBM"],"type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>complianceMetadata</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

List of compliance data. Each item has compliance standard, requirement, and/or section information.

</div><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"complianceId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Compliance Section UUID","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"customAssigned"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"policyId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Policy ID","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"requirementDescription"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Requirement description","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"requirementId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Requirement ID","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"requirementName"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Requirement name","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"sectionDescription"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Section name","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"sectionId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Section Id","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"sectionLabel"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Section Label","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"standardDescription"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Compliance standard description","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"standardId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"standardName"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Compliance standard name","type":"string"}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"description"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Policy description","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"enabled"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"true=enabled. false=disabled.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"findingTypes"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Finding Type","items":{"type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"labels"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Labels","items":{"type":"string"},"type":"array","uniqueItems":true}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Policy name","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"policyType"} required={true} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","title":"PolicyType","description":"Policy type. Policy type **anomaly** is read-only."}}></SchemaItem><SchemaItem collapsible={false} name={"recommendation"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Remediation recommendation","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>remediation</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Model for Remediation

</div><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>actions</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Policy Action

</div><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem","paddingBottom":".5rem"}}>Array [</div></li><SchemaItem collapsible={false} name={"operation"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"payload"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string"}}></SchemaItem><li><div style={{"fontSize":"var(--ifm-code-font-size)","opacity":"0.6","marginLeft":"-.5rem"}}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"cliScriptTemplate"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"CLI Script Template","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"description"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Description","type":"string"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>rule</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Model for Rule

</div><SchemaItem collapsible={false} name={"criteria"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Saved search ID that defines the rule criteria.","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>dataCriteria</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Criteria for Rule

</div><SchemaItem collapsible={false} name={"classificationResult"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Data policy. Required for DLP rule criteria.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"exposure"} required={false} schemaName={"string"} qualifierMessage={"**Possible values:** [`private`, `public`, `conditional`]"} schema={{"description":"File exposure","enum":["private","public","conditional"],"type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"extension"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"File extensions","type":"array","uniqueItems":true,"items":{"type":"string"}}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"name"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>parameters</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Parameters (e.g. {"savedSearch": "true"})

</div><SchemaItem name={"property name*"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string"}} collapsible={false} discriminator={false}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"type"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** [`Config`, `Network`, `AuditEvent`, `DLP`, `IAM`, `NetworkConfig`]"} schema={{"description":"Type of rule or RQL query","enum":["Config","Network","AuditEvent","DLP","IAM","NetworkConfig"],"type":"string"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"severity"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** [`high`, `medium`, `low`]"} schema={{"description":"Severity","enum":["high","medium","low"],"type":"string"}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

successful operation

</div><div></div></TabItem><TabItem label={"400"} value={"400"}><div>

missing_required_parameter / saved_search_validation_not_supported / preprocessor_not_allowed_for_policy / invalid_search_type_for_policy / invalid_search_type_for_policy / insufficient_query_for_policy_creation  /invalid_hostfinding_type_redlock_in_search_query / invalid_search_cloud_type_for_policy / invalid_azure_resource_group_in_search_query / json_not_supported_in_event_query / anomaly_search_not_supported_in_event_query / rql_validation_service_unavailable / invalid_json_rule

</div><div></div></TabItem></ApiTabs></div></div>
      