---
id: request-domain-information
title: Request Domain Information
description: DNS Security API example showing how to request information about domains.
slug: /threat-vault/docs/examples/dns-security/request-domain-information
hide_title: false
hide_table_of_contents: false
keywords:
  - security subscription
---

The API Reference information for retrieving domain information can be found [here](/cdss/dns-security/api/dns-security#operation/PublicApi_V1DomainInfo).

## Overview

The DNS Security API can be used to request information about domains based on analysis information generated by the DNS Security subscription service. Consider the following examples:

Keep a few things in mind when formatting your API query:

1. All the query strings in Get requests must be a URL-Encoded parameter string. If you use a space in the URL-Encoded request, you must include either a plus sign (+) or %20 to replace the space.
2. You can specify the content type of the request body and response by specifying the Content-Type header. Some responses generate an HTTP response in addition to a JSON object.
3. Do not embed API keys in code or application source tree files. This can inadvertently expose the API key. Instead, consider storing the API key in environmental variables or files that are excluded from your application source tree files.

## Example 1: Request information about multiple domains in batch mode.

When start and end dates are not specified for each domain, all available data is returned. The domains in this example request are considered to be risky or dangerous (at the time of publication - this can change as domains are reanalyzed by DNS Security), and are classified with the following current threat categories: annexpublishers.org `malware`, tipmuch.com `malware`, and classclean.net `command-and-control`.

```shell-session
curl -X POST -d '{"domains": [{"domain": "annexpublishers.org"}, {"domain": "tipmuch.com"}, {"domain": "classclean.net"}]}' 'https://api.dns.service.paloaltonetworks.com/v1/domain/info' \
  -H 'X-DNS-API-APIKEY: api_key' \
  -H 'Content-Type: application/json'
```

A successful API call returns an HTTP response code of 200, indicating success; additionally, the API provides a JSON object with various data fields containing the results of the request.

```json
{
    "success": true,
    "message": "",
    "results": [
        {
            "domain": "annexpublishers.org",
            "verdict": 1,
            "category": "malware",
            "categoryHistories": [
                {
                    "category": "malware",
                    "time": "2022-09-05T08:55:38Z",
                    "evidences": [
                        "Corroborated by intelligence sources",
                        "URL sandbox analysis found this URL to be malicious."
                    ]
                },
                {
                    "category": "health-and-medicine",
                    "time": "2020-07-18T14:06:44Z",
                    "evidences": [
                        "Entity no longer malicious by PANW crawlers"
                    ]
                }
            ],
            "ipHistories": [
                {
                    "ip": "107.180.37.105",
                    "type": "a",
                    "first": "2020-03-25T06:04:21Z",
                    "last": "2022-09-15T11:11:12Z",
                    "count": 487,
                    "asn": {
                        "ASNumber": 26496,
                        "ASName": "AS26496, Unknown"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                },
                {
                    "ip": "162.222.227.194",
                    "type": "a",
                    "first": "2019-12-29T01:14:13Z",
                    "last": "2020-03-23T21:41:23Z",
                    "count": 2,
                    "asn": {
                        "ASNumber": 46606,
                        "ASName": "UNIFIEDLAYER-AS-1, US"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                }
            ]
        },
        {
            "domain": "tipmuch.com",
            "verdict": 1,
            "category": "malware",
            "categoryHistories": [
                {
                    "category": "malware",
                    "time": "2022-06-25T13:25:57Z",
                    "evidences": [
                        "Corroborated by intelligence sources",
                        "Associated with known malicious URL"
                    ]
                },
                {
                    "category": "training-and-tools",
                    "time": "2022-06-25T08:35:08Z",
                    "evidences": [
                        "Corroborated by intelligence sources",
                        "Associated with known malicious URL"
                    ]
                }
            ],
            "ipHistories": [
                {
                    "ip": "17.0.0.10",
                    "type": "a",
                    "first": "2022-04-18T16:46:29Z",
                    "last": "2022-04-18T16:46:29Z",
                    "count": 1,
                    "asn": {
                        "ASNumber": 714,
                        "ASName": "APPLE-ENGINEERING, US"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                },
                {
                    "ip": "34.98.99.30",
                    "type": "a",
                    "first": "2020-10-29T11:16:52Z",
                    "last": "2020-10-29T11:16:52Z",
                    "count": 2,
                    "asn": {
                        "ASNumber": 15169,
                        "ASName": "GOOGLE, US"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                },
                {
                    "ip": "192.3.3.147",
                    "type": "a",
                    "first": "2020-11-04T01:17:40Z",
                    "last": "2022-09-15T07:55:40Z",
                    "count": 10,
                    "asn": {
                        "ASNumber": 36352,
                        "ASName": "AS-COLOCROSSING, US"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                }
            ]
        },
        {
            "domain": "classclean.net",
            "verdict": 0,
            "category": "command-and-control",
            "categoryHistories": [
                {
                    "category": "command-and-control",
                    "time": "2021-09-10T18:36:35Z",
                    "evidences": [
                        "Associated with a malicious sample submitted and analyzed by WildFire",
                        "Corroborated by intelligence sources",
                        "Associated with known domain generation algorithms",
                        "Manual review",
                        "Associated with known bad IPs"
                    ]
                },
                {
                    "category": "malware",
                    "time": "2020-09-22T06:03:23Z",
                    "evidences": [
                        "Associated with a malicious sample submitted and analyzed by WildFire",
                        "Corroborated by intelligence sources",
                        "Manual review",
                        "Associated with known bad IPs"
                    ]
                }
            ],
            "ipHistories": []
        }
    ]
}
```

## Example 2: Request information about multiple domains in batch mode with range constraints.

The domain toglooman.com has an additional search constraint to return results for passive DNS `first seen` data generated between 2020-11-01 to 2021-12-31 and `last seen` data generated from 2022-02-01 to 2022-05-31, respectively. 

The domain gmail.om returns passive DNS `first seen` data between 2021-11-01 to 2021-05-31, but has no search range limitations for `last seen` data.

```shell-session
curl -X POST -d '{"domains": [{"domain": "toglooman.com","firstStart": "2020-11-01","firstEnd": "2021-12-31","lastStart": "2022-02-01","lastEnd": "2022-05-31"}, {"domain": "gmail.om","firstStart": "2021-11-01","firstEnd": "2021-12-31"}]}' 'https://api.dns.service.paloaltonetworks.com/v1/domain/info' \
  -H 'X-DNS-API-APIKEY: api_key' \
  -H 'Content-Type: application/json'
```

A successful API call returns an HTTP response code of 200, indicating success; additionally, the API provides a JSON object with various data fields containing the results of the request.

```json
{
    "success": true,
    "message": "",
    "results": [
        {
            "domain": "toglooman.com",
            "verdict": 1,
            "category": "malware",
            "categoryHistories": [
                {
                    "category": "malware",
                    "time": "2022-03-28T07:00:40Z",
                    "evidences": [
                        "Corroborated by intelligence sources",
                        "Entity no longer malicious by PANW and intelligence sources",
                        "Associated with known malicious URL",
                        "Manual review"
                    ]
                },
                {
                    "category": "malware",
                    "time": "2021-12-26T23:21:47Z",
                    "evidences": [
                        "Corroborated by intelligence sources",
                        "Associated with known malicious URL",
                        "Manual review"
                    ]
                }
            ],
            "ipHistories": [
                {
                    "ip": "::1",
                    "type": "aaaa",
                    "first": "2021-08-13T19:28:56Z",
                    "last": "2022-02-07T05:39:09Z",
                    "count": 7,
                    "asn": {
                        "ASNumber": 0,
                        "ASName": ""
                    },
                    "geo": {
                        "countryCode": "",
                        "countryName": ""
                    }
                }
            ]
        },
        {
            "domain": "gmail.om",
            "verdict": 1,
            "category": "malware",
            "categoryHistories": [
                {
                    "category": "malware",
                    "time": "2022-01-28T04:45:45Z",
                    "evidences": [
                        "Associated with a malicious sample submitted and analyzed by WildFire",
                        "Corroborated by intelligence sources"
                    ]
                },
                {
                    "category": "parked",
                    "time": "2018-11-28T06:29:18Z",
                    "evidences": []
                }
            ],
            "ipHistories": [
                {
                    "ip": "23.56.173.165",
                    "type": "a",
                    "first": "2021-12-12T08:12:43Z",
                    "last": "2021-12-12T08:12:43Z",
                    "count": 1,
                    "asn": {
                        "ASNumber": 20940,
                        "ASName": "AKAMAI-ASN1, NL"
                    },
                    "geo": {
                        "countryCode": "US",
                        "countryName": "United States"
                    }
                }
            ]
        }
    ]
}
```

