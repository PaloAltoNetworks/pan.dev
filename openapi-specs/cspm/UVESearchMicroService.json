{
  "openapi": "3.0.0",
  "info": {
    "title": "Vulnerability Search and Investigate API",
    "description": "Endpoint to search for vulnerabilities",
    "version": "1.0.0"
  },
  "tags": [
    {
      "name": "Unified Vulnerability Explorer",
      "description": "Endpoint to search for vulnerabilities"
    }
  ],
  "paths": {
    "/uve/api/v1/vulnerabilities/search": {
      "post": {
        "tags": [
          "Unified Vulnerability Explorer"
        ],
        "operationId": "vulnerabilities-search-api",
        "summary": "Get Vulnerabilities by RQL",
        "description": "Get the list of vulnerabilities and their details based on an RQL query. For vulnerability RQL query attributes, see [Vulnerability Query Attributes](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-attributes). For example queries, see [Vulnerability Query Examples](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-examples).\n:::info\nThis endpoint is available on the Prisma Cloud Darwin release only.\n:::\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VulnerabilitySearchRequest"
              }
            }
          }
        },
        "parameters": [
          {
            "name": "page_token",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Token for pagination"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VulnerabilitySearchResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "x-public": "true",
        "x-ga": "24.1.1-darwin",
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/uve/api/v1/vulnerabilities/search/asset": {
      "post": {
        "tags": [
          "Unified Vulnerability Explorer"
        ],
        "operationId": "list-vulnerable-assets",
        "summary": "Get Vulnerable Assets by RQL",
        "description": "Get the list of vulnerable Assets and their IDs based on an RQL query. For vulnerability RQL query attributes, see [Vulnerability Query Attributes](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-attributes). For example queries, see [Vulnerability Query Examples](https://docs.prismacloud.io/en/enterprise-edition/content-collections/search-and-investigate/vulnerability-queries/vulnerability-query-examples).\n:::info\nThis endpoint is available on the Prisma Cloud Darwin release only.\n:::\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssetsSearchRequest"
              }
            }
          }
        },
        "parameters": [
          {
            "name": "page_token",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Token for pagination"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssetsSearchResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "x-public": "true",
        "x-ga": "24.1.1-darwin",
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/uve/api/v1/vulnerabilities/download": {
      "post": {
        "tags": [
          "Unified Vulnerability Explorer"
        ],
        "operationId": "download-vulnerability-file",
        "summary": "Download CVE Details",
        "description": "Download the CVE details and impacted assets by CVE ID in a GZIP CSV format.\n:::info\nThis endpoint is available on the Prisma Cloud Darwin release only.\n:::\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VulnerabilityDownloadRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "x-public": "true",
        "x-ga": "24.1.1-darwin",
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "VulnerabilitySearchRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Search query",
            "example": "vulnerability where age > 30 days"
          },
          "id": {
            "type": "string",
            "description": "saved search ID"
          }
        },
        "required": [
          "query"
        ]
      },
      "VulnerabilitySearchResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Saved search ID"
          },
          "name": {
            "type": "string",
            "description": "Vulnerability name"
          },
          "description": {
            "type": "string",
            "description": "Vulnerability description"
          },
          "searchType": {
            "type": "string",
            "description": "Search type"
          },
          "saved": {
            "type": "boolean",
            "description": "Whether it's saved or not"
          },
          "timeRange": {
            "$ref": "#/components/schemas/ToNowTimeRange"
          },
          "query": {
            "type": "string",
            "description": "Query details"
          },
          "data": {
            "$ref": "#/components/schemas/VulnerabilitySearchResultData"
          }
        }
      },
      "VulnerabilitySearchResultData": {
        "type": "object",
        "properties": {
          "totalRows": {
            "type": "integer",
            "description": "Total number of rows"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CveDetails"
            }
          },
          "nextPageToken": {
            "type": "string",
            "description": "Token for next page"
          }
        }
      },
      "CveDetails": {
        "type": "object",
        "properties": {
          "cveId": {
            "type": "string",
            "description": "CVE ID"
          },
          "name": {
            "type": "string",
            "description": "Name"
          },
          "cvssScore": {
            "type": "number",
            "description": "CVSS Score",
            "example": 8
          },
          "totalImpactedAssets": {
            "type": "integer",
            "description": "Total Impacted Assets"
          },
          "riskFactors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Risk Factors"
          },
          "code": {
            "$ref": "#/components/schemas/Code"
          },
          "build": {
            "$ref": "#/components/schemas/Build"
          },
          "deploy": {
            "$ref": "#/components/schemas/Deploy"
          },
          "run": {
            "$ref": "#/components/schemas/Run"
          },
          "published": {
            "type": "integer",
            "description": "Published time"
          },
          "exploitable": {
            "type": "boolean",
            "description": "Exploitable"
          },
          "patchable": {
            "type": "boolean",
            "description": "Patchable"
          },
          "severity": {
            "type": "string",
            "description": "Severity"
          }
        }
      },
      "ToNowTimeRange": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of Time Range"
          },
          "value": {
            "type": "string",
            "description": "Value of Time Range"
          }
        }
      },
      "AssetsSearchRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Search query",
            "example": "vulnerability where age > 30 days"
          },
          "cveId": {
            "type": "string",
            "description": "CVE ID"
          },
          "assetLifecycle": {
            "type": "string",
            "description": "Asset Lifecycle",
            "enum": [
              "code",
              "build",
              "deploy",
              "run"
            ]
          },
          "assetType": {
            "type": "string",
            "description": "Asset Type",
            "enum": [
              "package",
              "serverlessFunction",
              "iac",
              "deployedImage",
              "vmImage",
              "registryImage",
              "host"
            ]
          }
        },
        "required": [
          "query",
          "cveId",
          "assetLifecycle",
          "assetType"
        ]
      },
      "AssetsSearchResponse": {
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssetInfo"
            },
            "description": "List of Asset Information"
          },
          "nextPageToken": {
            "type": "string",
            "description": "Token for next page"
          }
        }
      },
      "AssetInfo": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Asset ID"
          },
          "name": {
            "type": "string",
            "description": "Asset name"
          }
        }
      },
      "AutoSuggestRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Suggestion query"
          }
        }
      },
      "AutoSuggestInfo": {
        "type": "object",
        "properties": {
          "valid": {
            "type": "boolean",
            "description": "Validity of suggestions"
          },
          "suggestions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of suggestions"
          },
          "translate": {
            "type": "boolean",
            "description": "Translate flag"
          },
          "needsOffsetUpdate": {
            "type": "boolean",
            "description": "Offset update flag"
          },
          "offset": {
            "type": "integer",
            "description": "Offset value"
          }
        }
      },
      "Code": {
        "type": "object"
      },
      "Build": {
        "type": "object"
      },
      "Deploy": {
        "type": "object"
      },
      "Run": {
        "type": "object"
      },
      "VulnerabilityRQLToJsonResponse": {
        "type": "object",
        "properties": {
          "original": {
            "type": "string",
            "description": "Original string"
          },
          "transformed": {
            "type": "string",
            "description": "Transformed string"
          }
        }
      },
      "VulnerabilityDownloadRequest": {
        "type": "object",
        "required": [
          "cveId"
        ],
        "properties": {
          "cveId": {
            "type": "string",
            "description": "CVE ID"
          },
          "riskFactors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of risk factors"
          },
          "assetType": {
            "type": "string",
            "description": "Asset Type",
            "enum": [
              "package",
              "serverlessFunction",
              "iac",
              "deployedImage",
              "vmImage",
              "registryImage",
              "host"
            ]
          }
        }
      },
      "ApiErrorResponse": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Error code"
          },
          "message": {
            "type": "string",
            "description": "Error message"
          },
          "target": {
            "type": "string",
            "description": "Error target"
          }
        }
      }
    },
    "securitySchemes": {
      "x-redlock-auth": {
        "description": "The x-redlock-auth value is a JSON Web Token (JWT).",
        "in": "header",
        "name": "x-redlock-auth",
        "type": "apiKey"
      }
    }
  },
  "servers": [
    {
      "url": "https://api.prismacloud.io"
    },
    {
      "url": "https://api2.prismacloud.io"
    },
    {
      "url": "https://api3.prismacloud.io"
    },
    {
      "url": "https://api4.prismacloud.io"
    },
    {
      "url": "https://api.anz.prismacloud.io"
    },
    {
      "url": "https://api.eu.prismacloud.io"
    },
    {
      "url": "https://api2.eu.prismacloud.io"
    },
    {
      "url": "https://api.gov.prismacloud.io"
    },
    {
      "url": "https://api.prismacloud.cn"
    },
    {
      "url": "https://api.ca.prismacloud.io"
    },
    {
      "url": "https://api.sg.prismacloud.io"
    },
    {
      "url": "https://api.uk.prismacloud.io"
    },
    {
      "url": "https://api.ind.prismacloud.io"
    },
    {
      "url": "https://api.jp.prismacloud.io"
    },
    {
      "url": "https://api.fr.prismacloud.io"
    }
  ]
}
