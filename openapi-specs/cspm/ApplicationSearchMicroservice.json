{
  "openapi": "3.0.2",
  "info": {
    "title": "AppDNA API Specs",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "https://api.prismacloud.io"
    },
    {
      "url": "https://api2.prismacloud.io"
    },
    {
      "url": "https://api3.prismacloud.io"
    },
    {
      "url": "https://api4.prismacloud.io"
    },
    {
      "url": "https://api.anz.prismacloud.io"
    },
    {
      "url": "https://api.eu.prismacloud.io"
    },
    {
      "url": "https://api2.eu.prismacloud.io"
    },
    {
      "url": "https://api.gov.prismacloud.io"
    },
    {
      "url": "https://api.prismacloud.cn"
    },
    {
      "url": "https://api.ca.prismacloud.io"
    },
    {
      "url": "https://api.sg.prismacloud.io"
    },
    {
      "url": "https://api.uk.prismacloud.io"
    },
    {
      "url": "https://api.ind.prismacloud.io"
    },
    {
      "url": "https://api.jp.prismacloud.io"
    },
    {
      "url": "https://api.fr.prismacloud.io"
    }
  ],
  "paths": {
    "/appid/api/v2/app": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "Get All Applications",
        "description": "Get the list of all applications and its details. These are applications that are scanned based on the discovery criteria and displayed in the Application Inventory. This endpoint will return upto 2000 applications. You can further filter the application based on the values of business criticality, business owner, environment and name. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "list-Apps-V2",
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ListAppsRequest"
              },
              "examples": {
                "getAppsByRepositoryIds": {
                  "value": {
                    "repoIds": [
                      "6e453e07-d896-4c65-a902-cb52874fe399",
                      "012b49a5-4ddc-42db-a0fe-632279d1afc5"
                    ]
                  }
                },
                "getAppsByMetadataFields": {
                  "value": {
                    "businessCriticality": "High",
                    "displayName": "AppDNA-Test-APP",
                    "environment": "prod",
                    "owner": "owner1"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListAppsResponseV2"
                },
                "examples": {
                  "getAppsByRepositoryIds": {
                    "value": [
                      {
                        "metadata": {
                          "businessCriticality": [
                            "High"
                          ],
                          "displayName": [
                            "AppDNA-Test-APP"
                          ],
                          "environment": [
                            "prod"
                          ],
                          "owner": [
                            "owner1"
                          ],
                          "repos": [
                            {
                              "fullRepositoryName": "name-012b49a5-4ddc-42db-a0fe-632279d1afc5",
                              "id": "012b49a5-4ddc-42db-a0fe-632279d1afc5"
                            },
                            {
                              "fullRepositoryName": "name-6e453e07-d896-4c65-a902-cb52874fe399",
                              "id": "6e453e07-d896-4c65-a902-cb52874fe399"
                            }
                          ],
                          "reviewed": [
                            "true"
                          ],
                          "type": [
                            "NON_K8s"
                          ]
                        },
                        "id": "0622a20b-8db5-449d-b529-70ab3244be79",
                        "createdAt": 1713876184450,
                        "summary": null
                      },
                      {
                        "metadata": {
                          "displayName": [
                            "appid-tags-automation"
                          ],
                          "environment": [
                            "prod"
                          ],
                          "owner": [
                            "owner2"
                          ],
                          "repos": [
                            {
                              "fullRepositoryName": "name-012b49a5-4ddc-42db-a0fe-632279d1afc5",
                              "id": "012b49a5-4ddc-42db-a0fe-632279d1afc5"
                            },
                            {
                              "fullRepositoryName": "name-6e453e07-d896-4c65-a902-cb52874fe399",
                              "id": "6e453e07-d896-4c65-a902-cb52874fe399"
                            }
                          ],
                          "reviewed": [
                            "true"
                          ],
                          "type": [
                            "NON_K8s"
                          ]
                        },
                        "id": "88f3fd07-4096-3504-867d-f5cf3422ddae",
                        "createdAt": 1713876184450,
                        "summary": null
                      }
                    ]
                  },
                  "getAppsByMetadataFields": {
                    "value": [
                      {
                        "metadata": {
                          "businessCriticality": [
                            "High"
                          ],
                          "businessUnit": [
                            "pc"
                          ],
                          "clusterAssetId": [
                            "arn:aws:eks:us-east-1:661959982153:cluster/k8sdev-apps2"
                          ],
                          "complianceStandards": [
                            "pc"
                          ],
                          "description": [
                            "testing edit for an application"
                          ],
                          "devopsOwner": [
                            "pc"
                          ],
                          "displayName": [
                            "applicedev@k8sdev-apps2"
                          ],
                          "environment": [
                            "Production"
                          ],
                          "namespace": [
                            "applicedev"
                          ],
                          "owner": [
                            "pc"
                          ],
                          "repository": [
                            "pc"
                          ],
                          "reviewed": [
                            "true"
                          ],
                          "securityOwner": [
                            "pc"
                          ],
                          "type": [
                            "K8s"
                          ]
                        },
                        "id": "56e3a090-9510-33f8-a93e-ecb14a2ac38f",
                        "createdAt": -1,
                        "summary": {
                          "alertCountByPolicyType": {
                            "attack_path": 71,
                            "config": 3,
                            "iam": 46,
                            "network": 4
                          },
                          "alertCountsBySeverity": {
                            "critical": 8,
                            "high": 25,
                            "info": 60,
                            "low": 60,
                            "medium": 27
                          },
                          "assetCount": {
                            "total": 24
                          },
                          "cloudTypes": [
                            "aws"
                          ],
                          "findingCountByType": {
                            "INTERNET_EXPOSURE": 12,
                            "MISCONFIGURATION": 1,
                            "PRIVILEGE_ESCALATION": 8
                          },
                          "vulnCountsBySeverity": {
                            "critical": 0,
                            "high": 0,
                            "low": 0,
                            "medium": 0
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/{id}": {
      "get": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Application by ID",
        "description": "Get details of an application by application ID.\n >**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "get-App-V2",
        "parameters": [
          {
            "name": "id",
            "description": "id of app to get details for",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/V2ApplicationWithAssets"
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/{id}/assets": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Assets Associated with an Application",
        "description": "Get list of assets associated with an application by application ID.\n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "search-Assets-By-App",
        "parameters": [
          {
            "name": "id",
            "description": "id of application",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/V2ApplicationWithAssets"
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/{id}/vulnerabilities": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Vulnerabilities in an Application",
        "description": "Get details of the vulnerabilities in an application by application ID. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "search-Vulns-By-App",
        "parameters": [
          {
            "name": "id",
            "description": "id of application",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/V2ApplicationWithAssets"
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/{id}/alerts": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Alerts for an Application",
        "description": "Get details of alerts in an application by application ID. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "search-Alerts-By-App",
        "parameters": [
          {
            "name": "id",
            "description": "id of application",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/V2ApplicationWithAssets"
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/summary": {
      "get": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Application Summary",
        "description": "Get the statistical details about applications in your environment such as count of applications discovered, number of vulnerabilities, and so on. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "app-Summary",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SummaryOfApps"
                },
                "example": {
                  "totalAssets": 43334,
                  "totalApps": 12,
                  "newlyDiscoveredApps": 11,
                  "appsWithVuln": 12,
                  "appsWithCriticalAlerts": 102
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/app/{id}/grouped-counts": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "Get Risk Count of an Application",
        "description": "Get risk count of an application by application ID. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "search-Counts-By-App",
        "parameters": [
          {
            "name": "id",
            "description": "id of application",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequestGroupedCount"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskCountResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/api/v2/tags": {
      "get": {
        "tags": [
          "Applications"
        ],
        "summary": "List Tags",
        "description": "Get the list of tags which are used to scan and discover applications. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "operationId": "get-Tags-By-Prisma-Id",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetTagsResponse"
                },
                "example": {
                  "Tags": [
                    "managedby",
                    "application_id",
                    "api_name",
                    "cloudtype",
                    "confidentiality",
                    "compliance"
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/search/api/v1/app": {
      "post": {
        "summary": "Get Applications by RQL",
        "description": "Get the list of applications and its details that matches the search query. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "tags": [
          "Applications"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Unique identifier for the search query."
          },
          {
            "name": "searchType",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "application"
              ]
            },
            "description": "Type of search."
          },
          {
            "name": "saved",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            },
            "description": "Whether the search query is saved."
          },
          {
            "name": "timeRange",
            "in": "query",
            "required": false,
            "schema": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "to_now"
                  ]
                },
                "value": {
                  "type": "string",
                  "example": "epoch"
                }
              }
            },
            "description": "Time range for the search query."
          },
          {
            "name": "query",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The actual query string for searching applications."
          }
        ],
        "responses": {
          "200": {
            "description": "A JSON object containing the search results.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "The unique identifier of the search result."
                    },
                    "name": {
                      "type": "string",
                      "description": "The name of the search result."
                    },
                    "description": {
                      "type": "string",
                      "description": "The description of the search result."
                    },
                    "searchType": {
                      "type": "string",
                      "description": "The type of search."
                    },
                    "saved": {
                      "type": "boolean",
                      "description": "Indicates if the search is saved."
                    },
                    "timeRange": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The type of time range."
                        },
                        "value": {
                          "type": "string",
                          "description": "The value for the time range."
                        }
                      }
                    },
                    "query": {
                      "type": "string",
                      "description": "The query string used for searching."
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "totalRows": {
                          "type": "integer",
                          "description": "The total number of rows in the result."
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "applicationId": {
                                "type": "string",
                                "description": "The unique identifier of the application."
                              },
                              "name": {
                                "type": "string",
                                "description": "The name of the application."
                              },
                              "owner": {
                                "type": "string",
                                "description": "The owner of the application."
                              },
                              "environment": {
                                "type": "string",
                                "description": "The environment in which the application is running."
                              },
                              "businessCriticality": {
                                "type": "string",
                                "description": "The business criticality of the application."
                              },
                              "type": {
                                "type": "string",
                                "description": "The type of application."
                              },
                              "totalAssets": {
                                "type": "integer",
                                "description": "The total number of assets."
                              },
                              "impactedAssets": {
                                "type": "integer",
                                "description": "The number of impacted assets."
                              },
                              "vulnCount": {
                                "type": "integer",
                                "description": "The count of vulnerabilities."
                              },
                              "alertCount": {
                                "type": "integer",
                                "description": "The count of alerts."
                              },
                              "findingCount": {
                                "type": "integer",
                                "description": "The count of findings."
                              }
                            }
                          }
                        },
                        "nextPageToken": {
                          "type": "string",
                          "description": "Token for fetching the next page of results."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid search query."
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/search/api/v1/app/risk": {
      "post": {
        "summary": "Get Vulnerabilities and Alerts for an Application",
        "description": "Returns vulnerabilities and alerts associated with assets. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "tags": [
          "Applications"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequestRisk"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "A JSON object containing vulnerabilities and alerts.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "vulns": {
                      "type": "array",
                      "description": "List of vulnerabilities.",
                      "items": {
                        "type": "object"
                      }
                    },
                    "alerts": {
                      "type": "array",
                      "description": "List of alerts.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "unifiedAssetId": {
                            "type": "string",
                            "description": "Unique identifier for the asset associated with the alert."
                          },
                          "alertId": {
                            "type": "string",
                            "description": "Unique identifier for the alert."
                          },
                          "policy": {
                            "type": "object",
                            "description": "Details of the policy that triggered the alert.",
                            "properties": {
                              "policyId": {
                                "type": "string",
                                "description": "Unique identifier for the policy."
                              },
                              "name": {
                                "type": "string",
                                "description": "Name of the policy."
                              },
                              "severity": {
                                "type": "string",
                                "description": "Severity level of the policy.",
                                "enum": [
                                  "low",
                                  "medium",
                                  "high",
                                  "critical"
                                ]
                              },
                              "policyType": {
                                "type": "string",
                                "description": "Type of the policy."
                              },
                              "findingTypes": {
                                "type": "array",
                                "description": "Types of findings associated with the policy.",
                                "items": {
                                  "type": "string",
                                  "enum": [
                                    "PRIVILEGE_ESCALATION",
                                    "INTERNET_EXPOSURE",
                                    "OTHER"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters."
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/search/api/v1/app/service": {
      "post": {
        "summary": "Get Vulnerabilities and Alerts for a Service",
        "description": "Returns the counts of assets, vulnerabilities, and alerts associated with each service. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "tags": [
          "Applications"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequestRisk"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "A JSON object containing service vulnerability and alert counts.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "services": {
                      "type": "array",
                      "description": "List of services with associated counts.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "service": {
                            "type": "string",
                            "description": "The name of the service."
                          },
                          "counts": {
                            "type": "object",
                            "description": "Count details related to the service.",
                            "properties": {
                              "assetCount": {
                                "type": "integer",
                                "description": "The number of assets associated with the service."
                              },
                              "vulnCount": {
                                "type": "integer",
                                "description": "The number of vulnerabilities associated with the service."
                              },
                              "alertCount": {
                                "type": "integer",
                                "description": "The number of alerts associated with the service."
                              }
                            }
                          }
                        }
                      }
                    },
                    "nextPageToken": {
                      "type": "string",
                      "description": "Token for fetching the next page of results."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters."
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    },
    "/appid/app/service/{id}": {
      "get": {
        "summary": "Get Assets and Services of an Application",
        "description": "Returns details of assets and services associated with an application, including alerts associated with assets. \n>**Note:** You need `investigateApplicationRql` feature with `Read` permission to access this endpoint. Verify if your permission group includes this feature using the [Get Permission Group by ID](https://pan.dev/prisma-cloud/api/cspm/get-1/) endpoint. You can also check this in the Prisma Cloud console by ensuring that `Investigate` > `Applications` is enabled.",
        "tags": [
          "Applications"
        ],
        "parameters": [
          {
            "name": "id",
            "description": "Application ID",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A JSON object containing asset and service information.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "assets": {
                      "type": "array",
                      "description": "List of assets with associated details.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "unifiedAssetId": {
                            "type": "string",
                            "description": "Unique identifier for the asset."
                          },
                          "externalAssetId": {
                            "type": "string",
                            "description": "External identifier for the asset."
                          },
                          "type": {
                            "type": "string",
                            "description": "The type of asset (e.g., Compute)."
                          },
                          "name": {
                            "type": "string",
                            "description": "The name of the asset."
                          },
                          "alerts": {
                            "type": "array",
                            "description": "List of alerts associated with the asset.",
                            "items": {
                              "type": "object",
                              "properties": {
                                "unifiedAssetId": {
                                  "type": "string",
                                  "description": "Unique identifier for the asset associated with the alert."
                                },
                                "alertId": {
                                  "type": "string",
                                  "description": "Unique identifier for the alert."
                                },
                                "policy": {
                                  "type": "object",
                                  "description": "Details of the policy that triggered the alert.",
                                  "properties": {
                                    "policyId": {
                                      "type": "string",
                                      "description": "Unique identifier for the policy."
                                    },
                                    "name": {
                                      "type": "string",
                                      "description": "Name of the policy."
                                    },
                                    "severity": {
                                      "type": "string",
                                      "description": "Severity level of the policy.",
                                      "enum": [
                                        "low",
                                        "medium",
                                        "high",
                                        "critical"
                                      ]
                                    },
                                    "policyType": {
                                      "type": "string",
                                      "description": "Type of the policy."
                                    },
                                    "findingTypes": {
                                      "type": "array",
                                      "description": "Types of findings associated with the policy.",
                                      "items": {
                                        "type": "string",
                                        "enum": [
                                          "HIGH_PRIVILEGED_ROLE",
                                          "INTERNET_EXPOSURE",
                                          "OTHER"
                                        ]
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          },
                          "totalAlertsCount": {
                            "type": "integer",
                            "description": "Total number of alerts associated with the asset."
                          }
                        }
                      }
                    },
                    "services": {
                      "type": "array",
                      "description": "List of services with associated details.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "Raw": {
                            "type": "string",
                            "description": "Raw service identifier."
                          },
                          "Name": {
                            "type": "string",
                            "description": "Name of the service."
                          },
                          "Id": {
                            "type": "string",
                            "description": "Unique identifier for the service."
                          },
                          "Kind": {
                            "type": "array",
                            "description": "Types or categories of the service.",
                            "items": {
                              "type": "string"
                            }
                          },
                          "Region": {
                            "type": "string",
                            "description": "The region where the service is located."
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters."
          }
        },
        "security": [
          {
            "x-redlock-auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ListAppsRequest": {
        "type": "object",
        "properties": {
          "businessCriticality": {
            "type": "string"
          },
          "owner": {
            "type": "string"
          },
          "displayName": {
            "type": "string"
          },
          "environment": {
            "type": "string"
          }
        }
      },
      "ListAppsResponseV2": {
        "type": "object",
        "properties": {
          "apps": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/V2ApplicationWithoutAssets"
            }
          }
        }
      },
      "V2ApplicationWithoutAssets": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "createdAt": {
            "type": "integer"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "summary": {
            "$ref": "#/components/schemas/V2ApplicationSummary"
          }
        }
      },
      "RiskCountResponse": {
        "type": "object",
        "properties": {
          "response": {
            "type": "object",
            "properties": {
              "counts": {
                "type": "object",
                "properties": {
                  "Compute": {
                    "type": "integer"
                  }
                }
              },
              "groupBy": {
                "type": "string"
              },
              "cardinalityField": {
                "type": "string"
              }
            }
          }
        }
      },
      "V2ApplicationWithAssets": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "createdAt": {
            "type": "integer"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "assets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssetWithRisks"
            }
          },
          "summary": {
            "$ref": "#/components/schemas/V2ApplicationSummary"
          }
        }
      },
      "V2ApplicationSummary": {
        "type": "object",
        "properties": {
          "cloudTypes": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "assetCount": {
            "$ref": "#/components/schemas/AssetCount"
          },
          "alertCountByPolicyType": {
            "$ref": "#/components/schemas/CountsByKey"
          },
          "alertCountBySeverity": {
            "$ref": "#/components/schemas/AlertCountBySeverity"
          },
          "vulnCountBySeverity": {
            "$ref": "#/components/schemas/VulnCountBySeverity"
          },
          "findingCountByType": {
            "$ref": "#/components/schemas/CountsByKey"
          }
        }
      },
      "SummaryOfApps": {
        "type": "object",
        "properties": {
          "totalAssets": {
            "type": "integer"
          },
          "totalApps": {
            "type": "integer"
          },
          "appsWithVuln": {
            "type": "integer"
          },
          "appsWithCriticalAlerts": {
            "type": "integer"
          },
          "newlyDiscoveredApps": {
            "type": "integer"
          }
        }
      },
      "AssetListResponse": {
        "type": "object",
        "properties": {
          "assets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssetWithRiskSummary"
            }
          }
        }
      },
      "AssetWithRiskSummary": {
        "type": "object",
        "properties": {
          "unifiedId": {
            "type": "string"
          },
          "externalId": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "Asset": {
        "type": "object",
        "properties": {
          "unifiedId": {
            "type": "string"
          },
          "externalId": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "vuln": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Vulnerability"
            }
          }
        },
        "required": [
          "unifiedId",
          "type"
        ]
      },
      "AssetWithRisks": {
        "type": "object",
        "properties": {
          "unifiedAssetId": {
            "type": "string"
          },
          "externalAssetId": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "assetType": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "cloudType": {
            "type": "string"
          },
          "region": {
            "type": "string"
          },
          "apiId": {
            "type": "string"
          },
          "alerts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Alert"
            }
          },
          "vuln": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Vulnerability"
            }
          },
          "vulnCountBySeverity": {
            "$ref": "#/components/schemas/VulnCountBySeverity"
          },
          "findings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Finding"
            }
          },
          "findingCountByType": {
            "$ref": "#/components/schemas/CountsByKey"
          }
        },
        "required": [
          "unifiedId",
          "type"
        ]
      },
      "Vulnerability": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "score": {
            "type": "number"
          },
          "severity": {
            "type": "string"
          }
        },
        "required": [
          "id"
        ]
      },
      "Finding": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "findingTypes": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "AlertCountBySeverity": {
        "type": "object",
        "properties": {
          "critical": {
            "type": "integer"
          },
          "high": {
            "type": "integer"
          },
          "medium": {
            "type": "integer"
          },
          "low": {
            "type": "integer"
          },
          "informational": {
            "type": "integer"
          }
        }
      },
      "AlertCountByPolicyType": {
        "type": "object",
        "properties": {
          "critical": {
            "type": "integer"
          },
          "high": {
            "type": "integer"
          },
          "medium": {
            "type": "integer"
          },
          "low": {
            "type": "integer"
          },
          "informational": {
            "type": "integer"
          }
        }
      },
      "VulnCountBySeverity": {
        "type": "object",
        "properties": {
          "critical": {
            "type": "integer"
          },
          "high": {
            "type": "integer"
          },
          "medium": {
            "type": "integer"
          },
          "low": {
            "type": "integer"
          }
        }
      },
      "CountByKey": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string"
          },
          "value": {
            "type": "integer"
          }
        }
      },
      "CountsByKey": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/CountByKey"
        }
      },
      "AssetCount": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer"
          },
          "byAlertSeverity": {
            "$ref": "#/components/schemas/AlertCountBySeverity"
          },
          "byVulnSeverity": {
            "$ref": "#/components/schemas/VulnCountBySeverity"
          }
        }
      },
      "Alert": {
        "type": "object",
        "properties": {
          "unifiedAssetId": {
            "type": "string"
          },
          "alertId": {
            "type": "string"
          },
          "policy": {
            "type": "object",
            "properties": {
              "policyId": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "severity": {
                "type": "string"
              },
              "policyType": {
                "type": "string"
              }
            }
          }
        }
      },
      "AppDefMetadata": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string"
          },
          "owner": {
            "type": "string"
          },
          "businessCriticality": {
            "type": "string"
          },
          "environment": {
            "type": "string"
          },
          "reviewed": {
            "type": "string"
          },
          "clusterAssetId": {
            "type": "string"
          },
          "namespace": {
            "type": "string"
          }
        }
      },
      "Defintion": {
        "type": "object",
        "additionalProperties": true
      },
      "AppDefinitionPatchRequest": {
        "type": "object",
        "properties": {
          "owner": {
            "type": "string"
          },
          "displayName": {
            "type": "string"
          },
          "environment": {
            "type": "string"
          },
          "businessCriticality": {
            "type": "string"
          },
          "reviewed": {
            "type": "string"
          }
        }
      },
      "SearchRequest": {
        "type": "object",
        "properties": {
          "filters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Filter"
            }
          },
          "nextPageToken": {
            "type": "string"
          }
        }
      },
      "AppDefinitionSearchRequest": {
        "type": "object",
        "properties": {
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      },
      "AppDefinition": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "clusterId": {
            "type": "string"
          },
          "lastSeen": {
            "type": "integer"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "definition": {
            "type": "object",
            "additionalProperties": {
              "type": "object"
            }
          }
        }
      },
      "ListAppDefintion": {
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AppDefinition"
            }
          }
        }
      },
      "SearchRequestRisk": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "applicationId": {
            "type": "string"
          }
        }
      },
      "SearchRequestGroupedCount": {
        "type": "object",
        "properties": {
          "filters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Filter"
            }
          }
        }
      },
      "AppDefSearchRequest": {
        "type": "object",
        "properties": {
          "prismaId": {
            "type": "integer",
            "format": "int64"
          },
          "owner": {
            "type": "string"
          },
          "displayName": {
            "type": "string"
          },
          "environment": {
            "type": "string"
          },
          "businessCriticality": {
            "type": "string"
          },
          "reviewed": {
            "type": "string"
          }
        }
      },
      "GetTagsResponse": {
        "type": "object",
        "properties": {
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "Filter": {
        "type": "object",
        "properties": {
          "op": {
            "type": "string",
            "example": "=, >, <, in, >=, <="
          },
          "attribute": {
            "type": "string"
          },
          "value": {
            "type": "object",
            "example": "string, int"
          }
        }
      }
    },
    "securitySchemes": {
      "x-redlock-auth": {
        "description": "The x-redlock-auth value is a JSON Web Token (JWT).",
        "in": "header",
        "name": "x-redlock-auth",
        "type": "apiKey"
      }
    }
  }
}
