components:
  schemas:
    IncidentAssignee:
      properties:
        createdAt:
          description: create at
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        emailAddress:
          description: email address of the assignee
          type: string
        firstName:
          description: assignee first name
          type: string
        id:
          description: ID of the assignee
          format: uuid
          type: string
        lastName:
          description: assignee last name
          type: string
        status:
          description: active assignee or inactivate assignee
          enum:
          - ACTIVE
          - INACTIVE
          example: '"ACTIVE" or "INACTIVE"'
          type: string
        tenantId:
          description: dlp tenant id
          type: string
        updatedAt:
          description: ''
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
      required:
      - status
      title: IncidentAssignee
      type: object
    IncidentDTO:
      properties:
        action:
          description: The action taken on the Incident.
          enum:
          - alert
          - block
          - none
          type: string
        app_id:
          description: The ID of the application.
          type: string
        app_name:
          description: The name of the application.
          type: string
        channel:
          description: The product the indcident was recorded in.
          enum:
          - ngfw
          - prisma-access
          - prisma-cloud
          - prisma-saas
          type: string
        data_profile_id:
          description: The ID of the data profile used to capture the incident.
          format: int64
          type: integer
        data_profile_name:
          description: The name of the data profile used to capture the incident.
          type: string
        file_name:
          description: The file name of the capture file.
          type: string
        file_sha:
          description: The SHA hash of the captured file.
          type: string
        file_type:
          description: The specific file type of the captured file.
          type: string
        incident_creation_time:
          description: The datetime of th incident.
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        incident_id:
          description: The automatically generated incident ID.
          format: uuid
          type: string
        report_id:
          description: The automatically generated report ID.
          type: string
        source:
          description: Source of the incident report.
          type: string
        tenant_id:
          description: ID of the TSG enabled tentant.
          type: string
        user:
          description: User identified by the DLP engine.
          type: string
      title: IncidentDTO
      type: object
    IncidentResponse:
      properties:
        page:
          $ref: '#/components/schemas/PageData'
          description: Inidicates the page of the current response.
        resources:
          description: Inidicates the current status of the Email DLP incident, this
            can indicate whether the incident is open, under review, resovled, or
            closed
          items:
            $ref: '#/components/schemas/IncidentDTO'
          type: array
      required:
      - page
      title: PagedDataResponse<IncidentDTO>
      type: object
    IncidentResponseDTO:
      description: ''
      example:
        action: alert
        assignee_id: 00d53ebf-c386-4b95-ad05-6819517c3450
        channel: prisma-access
        data_profile_id: 11995590
        data_profile_name: PatricksDPwEDM
        file_name: 100_rows_10_cols_tail.csv
        file_sha: 9d8ce237eff10b5ac4b4c8fed0d7988ca6cc4f090f90230acd8dad36fb7da636
        incident_creation_time: 2024-Jan-11 17:14:30 UTC
        incident_id: 4adeefe4-8358-411e-8ba7-5f45e5625c58
        incident_notes: test notes
        match_info:
          65a0209ce36cd3480011d677:
            detection_technique: edm
            edm_columns:
            - credit_card_number
            - social_security_number
            hcf: 10
            lcf: 10
            mcf: 0
            name: EDM - PatricksDataSet20240111
            score: 0
            uhcf: 10
            ulcf: 10
            umcf: 0
            version: 1
        report_id: '530470823'
        resolution_status: Assigned
        source: prisma-access
        tenant_id: '5886928188517009408'
      properties:
        action:
          enum:
          - alert
          - block
          type: string
        app_id:
          type: string
        app_name:
          type: string
        assignee_id:
          type: string
        channel:
          enum:
          - ngfw
          - prisma-access
          - prisma-cloud
          - prisma-saas
          type: string
        data_profile_id:
          format: int64
          type: integer
        data_profile_name:
          type: string
        file_name:
          type: string
        file_sha:
          type: string
        file_type:
          type: string
        incident_creation_time:
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        incident_feedback_status:
          type: string
        incident_id:
          format: uuid
          type: string
        incident_notes:
          type: string
        match_info:
          $ref: '#/components/schemas/MatchInfo'
          description: ''
          example: "\"65a0209ce36cd3480011d677\": {\n            \"name\": \"EDM -\
            \ PatricksDataSet20240111\",\n            \"version\": 1,\n          \
            \  \"lcf\": 10,\n            \"hcf\": 10,\n            \"mcf\": 0,\n \
            \           \"ulcf\": 10,\n            \"uhcf\": 10,\n            \"umcf\"\
            : 0,\n            \"score\": 0.0,\n            \"detection_technique\"\
            : \"edm\",\n            \"edm_columns\": [\n                \"credit_card_number\"\
            ,\n                \"social_security_number\"\n            ]\n       \
            \ }\n"
        report_id:
          type: string
        resolution_status:
          type: string
        session_key:
          type: string
        snippets:
          type: string
        source:
          type: string
        tenant_id:
          type: string
        user:
          type: string
      type: object
    MatchInfo:
      properties:
        detection_technique:
          description: One of several techniques used to identify the incident.
          enum:
          - document_fingerprint
          - edm
          - file_property
          - ml
          - ml_document
          - regex
          - titus_tag
          - trainable_classifier
          - weighted_regex
          type: string
        edm_columns:
          description: "Exact Data Matching (EDM) is a method of detecting and protecting\
            \ your most sensitive content. Unlike data patterns, EDM uses specific\
            \ data\u2014such as a patient\u2019s first and last name or a patient\u2019\
            s social security number or a customer\u2019s bank account number\u2014\
            to identify matches."
          items:
            type: string
          type: array
          uniqueItems: true
        hcf:
          description: The indicator for high confidence freqeuncy.
          format: int32
          type: integer
        lcf:
          description: The indicator for low confidence frequency.
          format: int32
          type: integer
        mcf:
          description: Indicator for medium confidence frequency.
          format: int32
          type: integer
        name:
          description: The name of the pattern.
          type: string
        score:
          description: The score given to the pattern based on severity.
          format: double
          type: number
        uhcf:
          description: The unique high confidence frequency pattern.
          format: int32
          type: integer
        ulcf:
          description: The unique low confidence freqeuncy pattern.
          format: int32
          type: integer
        umcf:
          description: The unique medium confidence frequency pattern.
          format: int32
          type: integer
        version:
          description: Data pattern version.
          format: int32
          type: integer
      title: MatchInfo
      type: object
    PageData:
      properties:
        number:
          description: Pagination support for the API, this enables you to limit the
            response size.
          format: int32
          type: integer
        size:
          description: Indicates the size of the responose.
          format: int32
          type: integer
        total_elements:
          description: Indicates the total number of incidents included.
          format: int32
          type: integer
        total_pages:
          description: Indicates the total number of pages available.
          format: int32
          type: integer
      title: PageData
      type: object
  securitySchemes:
    Bearer:
      scheme: bearer
      type: http
info:
  contact: {}
  description: The DLP APIs enable you to programatically update incidents with details,
    update assignees, and view incident details.
  license:
    name: GNU AGPLv3
    url: https://www.gnu.org/licenses/agpl.txt
  title: DLP APIs
  version: 1.0.0
openapi: 3.0.2
paths:
  /v1/api/incidents/assignee:
    get:
      operationId: get-v1-api-incidents-assignee
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentAssignee'
          description: Get all assignees
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Get all assignees
      tags:
      - DLP API
    put:
      operationId: put-v1-api-incidents-assignee
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncidentAssignee'
        required: true
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
      security:
      - Bearer: []
      summary: Update Incident Assignee
      tags:
      - DLP API
  /v1/api/incidents/assignee/{assigneeId}:
    get:
      operationId: get-v1-api-incidents-assignee-assigneeid
      parameters:
      - description: The ID of the asignee for the incident.
        in: path
        name: assigneeId
        required: true
        schema:
          type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentAssignee'
          description: Get assignee
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Get Assignee by ID
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/assignee:
    put:
      operationId: put-v1-api-incidents-incidentid-assignee
      parameters:
      - description: The region/country of the incident.
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      - description: The ID of the updated incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - in: path
        name: incidentID
        required: true
        schema:
          type: string
      responses:
        '200':
          content:
            application/json:
              examples:
                assignee uuid:
                  value: 00d53ebf-c386-4b95-ad5-6819517c3450
              schema:
                type: string
          description: Updated the incident assignee.
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Assign incidents
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/notes:
    delete:
      operationId: delete-v1-api-incidents-incidentid-notes
      parameters:
      - description: The ID of the recorded incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident (defaults to the
          US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      - description: Incident UUID
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: region(default to us)
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      responses:
        '200':
          content:
            application/json: {}
          description: Deleted the note for the incident.
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Remove Incident Notes
      tags:
      - DLP API
    put:
      operationId: put-v1-api-incidents-incidentid-notes
      parameters:
      - description: The ID of the recorded incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident (defaults to the
          US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      - description: Incident UUID
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: region(default to us)
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      requestBody:
        content:
          application/json:
            examples:
              sample notes:
                value: This is a note for incident
            schema:
              type: string
        description: The content of the note you want to update on the incident.
        required: true
      responses:
        '200':
          description: Updated the note for the incident.
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Update Inicident Note
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/resolution-status:
    put:
      operationId: put-v1-api-incidents-incidentid-resolution-status
      parameters:
      - description: ID of the Incident to be updated
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident.
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      - in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: region(default to us)
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      responses:
        '200':
          content:
            application/json:
              examples:
                sample status:
                  value: assigned
              schema:
                type: string
          description: incident is updated with note
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Update Incident Resolution
      tags:
      - DLP API
  /v2/api/incidents:
    get:
      operationId: get-v2-api-incidents
      parameters:
      - description: Sort incidents in ascending order
        in: query
        name: ascending
        required: false
        schema:
          type: boolean
      - description: Source of the DLP incident you are viewing
        in: query
        name: channel
        required: false
        schema:
          enum:
          - ngfw
          - prisma-access
          type: string
      - description: The end time of the incident
        in: query
        name: end_time
        required: false
        schema:
          format: date-time
          type: string
      - description: The file SHA assosciated with the incident
        in: query
        name: file_shas
        required: false
        schema:
          pattern: ^[a-fA-F0-9]{64}((,\s*)[a-fA-F0-9]{64})*$
          type: string
      - description: Pagination support to track the number incidents you retrieved
        in: query
        name: page_number
        required: false
        schema:
          format: int32
          type: integer
      - description: Pagination support to reduce the number incidents you retrieved
        in: query
        name: page_size
        required: false
        schema:
          format: int32
          type: integer
      - description: Region the incident was triggered in
        in: query
        name: region
        required: false
        schema:
          type: string
      - description: ID of the retrieved report
        in: query
        name: report_ids
        required: false
        schema:
          items:
            type: string
          type: array
      - description: sort by. default sort by creation time
        in: query
        name: sort_by
        required: false
        schema:
          type: string
      - description: start_time
        in: query
        name: start_time
        required: false
        schema:
          format: date-time
          type: string
      - description: User IDs assosciated with the incident.
        in: query
        name: user_ids
        required: false
        schema:
          items:
            type: string
          type: array
      responses:
        '200':
          content:
            application/json:
              examples:
                incidentResponseExample:
                  value:
                    page:
                      number: 1
                      size: 10
                      total_elements: 290
                      total_pages: 29
                    resources:
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-07 18:41:12 UTC
                      incident_id: 7c3dca3d-1c08-4147-b171-9faba84739d4
                      report_id: '1572154781'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995410
                      data_profile_name: Portugal_LNAME_high
                      file_name: test_portugal_LNAME.txt
                      file_sha: 6c25d79cd1dee00b3a6ee6bbb985dae6ee5bdfa31a8dfcffa241786c8c3893a7
                      incident_creation_time: 2023-Dec-07 18:39:38 UTC
                      incident_id: 81985a40-dae5-4e80-8147-678892ccfc00
                      report_id: '2968440380'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995410
                      data_profile_name: Portugal_LNAME_high
                      file_name: test_portugal_LNAME.txt
                      file_sha: 6c25d79cd1dee00b3a6ee6bbb985dae6ee5bdfa31a8dfcffa241786c8c3893a7
                      incident_creation_time: 2023-Dec-07 18:38:48 UTC
                      incident_id: c5387039-abbc-46a3-8933-41bd0c74061b
                      report_id: '3588258117'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-07 04:30:53 UTC
                      incident_id: af724f3e-ab01-4715-902a-373a28282483
                      report_id: '928726859'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-07 04:19:10 UTC
                      incident_id: 5c1a8589-d812-449e-8a66-64ed8b122dfc
                      report_id: '4353201'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-07 01:42:11 UTC
                      incident_id: e6d611f4-10cf-4fcf-933e-22af71020c23
                      report_id: '352752608'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-07 01:41:29 UTC
                      incident_id: 3fb38abe-a83b-44e5-99d5-4bec3765bba6
                      report_id: '305868581'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995355
                      data_profile_name: inline_timing_11_12_edm
                      file_name: all_patterns_data_1_MB.txt
                      file_sha: 6c8d18c544aba3b44cfa487d5020ec102a6317a6a5164e270bbecf6ea37df925
                      incident_creation_time: 2023-Dec-06 19:39:46 UTC
                      incident_id: 08f014d8-ed13-490e-bfc4-7363f43a4af1
                      report_id: '1347859663'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995295
                      data_profile_name: DemoWideNestedProfile
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-05 21:54:21 UTC
                      incident_id: 6c7d838a-1b25-44fe-8917-1ff760c0eae5
                      report_id: '3741398016'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995295
                      data_profile_name: DemoWideNestedProfile
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      incident_creation_time: 2023-Dec-05 21:53:12 UTC
                      incident_id: 559d06c9-b56b-40a4-a7e6-d7cda3c6faa2
                      report_id: '3058206582'
                      source: ngfw
                      tenant_id: '5886928188517009408'
              schema:
                $ref: '#/components/schemas/IncidentResponse'
          description: 200 ok
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Get Incidents
      tags:
      - DLP API
  /v2/api/incidents/{incidentID}:
    get:
      operationId: get-v2-api-incidents-incidentid
      parameters:
      - description: ID of the incident
        examples:
          IncidentID Example:
            value: 3fb38abe-a83b-44e5-99d5-4bec3765bba6
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: incidentID(UUID)
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: region(default to us)
        in: query
        name: region
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ca
          type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentResponseDTO'
          description: 200 ok
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
      - Bearer: []
      summary: Get Incident Details
      tags:
      - DLP API
tags:
- name: DLP API
