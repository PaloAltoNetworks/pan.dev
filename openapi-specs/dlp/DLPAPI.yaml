components:
  schemas:
    IncidentAssignee:
      properties:
        createdAt:
          description: The creation time of the DLP incident
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        emailAddress:
          description: Email address of the assignee
          type: string
        firstName:
          description: First name of the assignee
          type: string
        id:
          description: ID of the assignee
          format: uuid
          type: string
        lastName:
          description: Last name of the assignee
          type: string
        status:
          description: Signifies whether the assignee is active or inactive
          enum:
          - ACTIVE
          - INACTIVE
          example: '"ACTIVE" or "INACTIVE"'
          type: string
        tenantId:
          description: The TSG enabled tenant group ID
          type: string
        updatedAt:
          description: The last updated time of the incident
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
      required:
      - status
      title: IncidentAssignee
      type: object
    IncidentAssigneeDTO:
      properties:
        emailAddress:
          description: Email address of the assignee
          type: string
        firstName:
          description: Assignees first name
          type: string
        id:
          description: ID of the assignee(optional). If you do not provide an ID,
            the API will create a new assignee.
          format: uuid
          type: string
        lastName:
          description: assignee last name
          type: string
        status:
          description: active assignee or inactivate assignee
          enum:
          - ACTIVE
          - INACTIVE
          example: '"ACTIVE" or "INACTIVE"'
          type: string
      required:
      - status
      - emailAddress
      - firstName
      - lastName
      title: IncidentAssigneeDTO
      type: object
    IncidentDTO:
      properties:
        action:
          description: The action taken on the Incident.
          enum:
          - alert
          - block
          - none
          type: string
        app_id:
          description: The ID of the application.
          type: string
        app_name:
          description: The name of the application.
          type: string
        channel:
          description: The product the incident was recorded in.
          enum:
          - ngfw
          - prisma-access
          type: string
        data_profile_id:
          description: The ID of the data profile used to capture the incident.
          format: int64
          type: integer
        data_profile_name:
          description: The name of the data profile used to capture the incident.
          type: string
        file_name:
          description: The file name of the capture file.
          type: string
        file_sha:
          description: The SHA hash of the captured file.
          type: string
        file_type:
          description: The specific file type of the captured file.
          type: string
        incident_creation_time:
          description: The datetime of the incident.
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        incident_id:
          description: The automatically generated incident ID.
          format: uuid
          type: string
        report_id:
          description: The automatically generated report ID.
          type: string
        source:
          description: Source of the incident report.
          type: string
        tenant_id:
          description: ID of the TSG enabled tenant.
          type: string
        user:
          description: User identified by the DLP engine.
          type: string
      title: IncidentDTO
      type: object
    IncidentResponse:
      properties:
        page:
          $ref: '#/components/schemas/PageData'
          description: Indicates the page of the current response.
        resources:
          description: Indicates the current status of the DLP incident whether it
            is open, under review, resolved, or closed
          items:
            $ref: '#/components/schemas/IncidentDTO'
          type: array
      required:
      - page
      title: PagedDataResponse<IncidentDTO>
      type: object
    IncidentResponseDTO:
      example:
        action: alert
        assignee_id: 00d53ebf-c386-4b95-ad05-6819517c3450
        channel: prisma-access
        data_profile_id: 11995590
        data_profile_name: PatricksDPwEDM
        file_name: 100_rows_10_cols_tail.csv
        file_sha: 9d8ce237eff10b5ac4b4c8fed0d7988ca6cc4f090f90230acd8dad36fb7da636
        incident_creation_time: 2024-Jan-11 17:14:30 UTC
        incident_id: 4adeefe4-8358-411e-8ba7-5f45e5625c58
        incident_notes: test notes
        match_info:
          65a0209ce36cd3480011d677:
            detection_technique: edm
            edm_columns:
            - credit_card_number
            - social_security_number
            hcf: 10
            lcf: 10
            mcf: 0
            name: EDM - PatricksDataSet20240111
            uhcf: 10
            ulcf: 10
            umcf: 0
            version: 1
        report_id: '530470823'
        resolution_status: Assigned
        source: prisma-access
        tenant_id: '5886928188517009408'
      properties:
        action:
          description: Action taken on the incident.
          enum:
          - alert
          - block
          type: string
        app_id:
          description: Palo Alto Networks assigned Application ID.
          type: string
        app_name:
          description: The name of the application.
          type: string
        assignee_id:
          description: Automatically assigned ID of the assignee.
          type: string
        channel:
          description: The Palo Alto Networks channel that identified the incident.
          enum:
          - ngfw
          - prisma-access
          type: string
        data_profile_id:
          description: The UUID profile descriptor used to characterize the incident.
          format: int64
          type: integer
        data_profile_name:
          description: The data profile descriptor used to characterize the incident.
          type: string
        file_name:
          description: The analyzed file name.
          type: string
        file_sha:
          description: The analyzed file SHA hash.
          type: string
        file_type:
          description: The analyzed file type.
          type: string
        incident_creation_time:
          description: The time the incident first occurred.
          example: yyyy-MMM-dd HH:mm:ss z
          type: string
        incident_feedback_status:
          description: Current status of the feedback assosicated with the incident.
          type: string
        incident_id:
          description: The Palo Alto Networks automatically assigned incident ID.
          format: uuid
          type: string
        incident_notes:
          description: User defined notes for the incident.
          type: string
        match_info:
          $ref: '#/components/schemas/MatchInfo'
          description: ''
          example: "\"65a0209ce36cd3480011d677\": {\n            \"name\": \"EDM -\
            \ PatricksDataSet20240111\",\n            \"version\": 1,\n          \
            \  \"lcf\": 10,\n            \"hcf\": 10,\n            \"mcf\": 0,\n \
            \           \"ulcf\": 10,\n            \"uhcf\": 10,\n            \"umcf\"\
            : 0,\n            \"detection_technique\": \"edm\",\n            \"edm_columns\"\
            : [\n                \"credit_card_number\",\n                \"social_security_number\"\
            \n            ]\n        }\n"
        report_id:
          description: The Palo Alto Networks automatically assigned report ID that
            you can use to retrieve reports.
          type: string
        resolution_status:
          description: Resolution status from Enterprise DLP status.
          type: string
        session_key:
          description: Specifies a session key assosciated with the incident.
          type: string
        snippets:
          description: A JSON structure containing snippet data, if snippets are not
            enabled, the field returns as null.
          type: string
        source:
          description: The Palo Alto Networks source that identified the incident.
          type: string
        tenant_id:
          description: The TSG enabled tenant used to identify the Incident.
          type: string
        user:
          description: The user assosciated with te incident.
          type: string
      title: IncidentResponseDTO
      type: object
    MatchInfo:
      properties:
        detection_technique:
          description: One of several techniques used to identify the incident.
          enum:
          - document_fingerprint
          - edm
          - file_property
          - ml
          - ml_document
          - regex
          - titus_tag
          - trainable_classifier
          - weighted_regex
          type: string
        edm_columns:
          description: "Exact Data Matching (EDM) is a method of detecting and protecting\
            \ your most sensitive content. Unlike data patterns, EDM uses specific\
            \ data\u2014such as a patient\u2019s first and last name or a patient\u2019\
            s social security number or a customer\u2019s bank account number\u2014\
            to identify matches."
          items:
            type: string
          type: array
          uniqueItems: true
        hcf:
          description: The indicator for high confidence frequency.
          format: int32
          type: integer
        lcf:
          description: The indicator for low confidence frequency.
          format: int32
          type: integer
        mcf:
          description: Indicator for medium confidence frequency.
          format: int32
          type: integer
        name:
          description: The name of the pattern.
          type: string
        uhcf:
          description: The unique high confidence frequency pattern.
          format: int32
          type: integer
        ulcf:
          description: The unique low confidence frequency pattern.
          format: int32
          type: integer
        umcf:
          description: The unique medium confidence frequency pattern.
          format: int32
          type: integer
        version:
          description: Data pattern version.
          format: int32
          type: integer
      title: MatchInfo
      type: object
    PageData:
      properties:
        number:
          description: Pagination support for the API, this enables you to limit the
            response size.
          format: int32
          type: integer
        size:
          description: Indicates the size of the response.
          format: int32
          type: integer
        total_elements:
          description: Indicates the total number of incidents included.
          format: int32
          type: integer
        total_pages:
          description: Indicates the total number of pages available.
          format: int32
          type: integer
      title: PageData
      type: object
    ScanContentResponse:
      properties:
        data_pattern_rule_1_verdict:
          enum:
          - MATCHED
          - NOT_EVALUATED
          - NOT_MATCHED
          type: string
        data_pattern_rule_2_verdict:
          enum:
          - MATCHED
          - NOT_EVALUATED
          - NOT_MATCHED
          type: string
        data_profile_name:
          description: Profile of the detection rules
          type: string
        file_name:
          description: Name of the scanned file
          type: string
        report_id:
          description: ID of the retrieved report
          type: string
        scanContentRawReport:
          description: List of report data
          type: string
        tenant_id:
          description: DLP tenant ID
          type: string
      title: ScanContentResponse
      type: object
  securitySchemes:
    Bearer:
      scheme: bearer
      type: http
info:
  contact: {}
  description: The DLP APIs enable you to programatically update incidents with details,
    update assignees, and view incident details.
  license:
    name: MIT
    url: https://opensource.org/license/mit
  title: DLP APIs
  version: 1.0.0
openapi: 3.0.2
paths:
  /v1/api/incidents/assignee:
    get:
      description: Retrieve information about all assignees that you can use to monitor
        team members who can examine incidents.
      operationId: get-v1-api-incidents-assignee
      responses:
        '200':
          content:
            application/json:
              examples:
                assignees:
                  value:
                  - createdAt: 2024-Jan-11 23:16:33 UTC
                    emailAddress: test@test.com
                    firstName: test u
                    id: 00d53ebf-c386-4b95-ad05-6819517c3450
                    lastName: test
                    status: ACTIVE
                    tenantId: '5886928188517009408'
                    updatedAt: 2024-Feb-14 19:13:01 UTC
                  - createdAt: 2023-Aug-03 21:23:39 UTC
                    emailAddress: user1@test.com
                    firstName: user
                    id: 133b9b0d-6e64-40ca-abec-15ff3b906b80
                    lastName: my last name
                    status: ACTIVE
                    tenantId: '5886928188517009408'
              schema:
                items:
                  $ref: '#/components/schemas/IncidentAssignee'
                type: array
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Retrieve All Assignees
      tags:
      - DLP API
    put:
      description: Update information about all assignees  who can examine incidents.
      operationId: put-v1-api-incidents-assignee
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncidentAssigneeDTO'
        required: true
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Update Information About Assignees
      tags:
      - DLP API
  /v1/api/incidents/assignee/{assigneeId}:
    get:
      description: Retrieve information about your assignees that you can use to monitor
        team members who can examine incidents.
      operationId: get-v1-api-incidents-assignee-assigneeid
      parameters:
      - description: The ID of the assignee for the incident.
        in: path
        name: assigneeId
        required: true
        schema:
          type: string
      responses:
        '200':
          content:
            application/json:
              examples:
                assignee:
                  value:
                    createdAt: 2024-Jan-11 23:16:33 UTC
                    emailAddress: test@test.com
                    firstName: test
                    id: 00d53ebf-c386-4b95-ad05-6819517c3450
                    lastName: test
                    status: ACTIVE
                    tenantId: '5886928188517009408'
              schema:
                $ref: '#/components/schemas/IncidentAssignee'
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Retrieve Assignee Details
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/assignee:
    put:
      description: 'You can assign your incidents using the API. These assignees can
        then:

        * [Update Notes](/dlp/api/put-v-1-api-incidents-incidentid-notes/)

        * [Update Incident Resolution Statuses](/dlp/api/put-v-1-api-incidents-incidentid-resolution-status/)

        '
      operationId: put-v1-api-incidents-incidentid-assignee
      parameters:
      - description: The region/country of the incident (defaults to the US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      - description: The ID of the updated incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            examples:
              UUID of assignee:
                value: 00d53ebf-c386-4b95-ad05-6819517c3450
            schema:
              type: string
        description: UUID of assignee
        required: true
      responses:
        '200':
          description: Updated the incident assignee.
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Assign Incident Assignee
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/notes:
    delete:
      description: For additional auditing and clarity for your team members, you
        can programatically delete notes to remove details.
      operationId: delete-v1-api-incidents-incidentid-notes
      parameters:
      - description: The ID of the recorded incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident (defaults to the
          US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      responses:
        '200':
          description: Deleted the note for the incident.
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Delete Incident Notes
      tags:
      - DLP API
    put:
      description: For additional auditing and clarity for your team members, you
        can programatically edit notes to provide further details.
      operationId: put-v1-api-incidents-incidentid-notes
      parameters:
      - description: The ID of the recorded incident.
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident (defaults to the
          US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      requestBody:
        content:
          application/json:
            examples:
              sample notes:
                value: This is a note for incident
            schema:
              type: string
        description: The content of the note you want to update on the incident.
        required: true
      responses:
        '200':
          description: Updated the note for the incident.
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Updated incident notes.
      tags:
      - DLP API
  /v1/api/incidents/{incidentID}/resolution-status:
    put:
      description: Update the resolution status for a specific incident
      operationId: put-v1-api-incidents-incidentid-resolution-status
      parameters:
      - description: ID of the Incident to be updated
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: The region/country of the recorded incident (defaults to the
          US).
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      requestBody:
        content:
          application/json:
            examples:
              resolution status:
                value: assigned
            schema:
              type: string
        required: true
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Update Incident Resolution Status
      tags:
      - DLP API
  /v1/public/report/{reportId}:
    get:
      description: "A GET request to this endpoint retrieves the DLP reports. You\
        \ can use the report ID from Cortex Data Lake or from an [incident](/dlp/api/get-v-2-api-incidents/).\
        \ A report contains metadata and detection information about a file or payload,uch\
        \ as pattern matches, but does not include unique incident information. [Get\
        \ Incident Details](/dlp/api/get-v-2-api-incidents-incidentid/) for user,\
        \ app, URL and channel information. A report can contain many incidents. \n\
        [Set Up Enterprise Data Loss Prevention](https://docs.paloaltonetworks.com/enterprise-dlp/enterprise-dlp-admin/set-up-enterprise-data-loss-prevention)\
        \ provides more information. You can also opt to retrieve snippets in the\
        \ response. You can then view this sensitive content called a snippet. A snippet\
        \ is evidence or identifiable\ninformation associated with a pattern match.\
        \ For example, if you specified a data pattern of Credit Card Number, the\
        \ API returns the credit card number of the user as the matched snippet.\n"
      operationId: get-v1-public-report-reportid
      parameters:
      - description: ID of the retrieved report
        in: path
        name: reportId
        required: true
        schema:
          type: string
      - description: (Optional) Boolean field when set to true, retrieves snippets
          from the DLP report.
        in: query
        name: fetchSnippets
        schema:
          type: boolean
      responses:
        '200':
          content:
            application/json:
              examples:
                report with snippets:
                  value:
                    action: block
                    data_pattern_rule_1_verdict: MATCHED
                    data_profile_id: '11995044'
                    data_profile_name: PII
                    data_profile_version: 1
                    detection_time: 02/10/2024 23:34:14 GMT
                    extracted_file_size_in_bytes: 937
                    fileSha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                    file_name: SSNpattern
                    file_size_in_bytes: 930
                    file_type: pdf
                    report_id: '163570374'
                    scanContentRawReport:
                      data_pattern_rule_1_results:
                      - data_pattern_id: 6374e1b4dee31d91c40b179d
                        detection_frequency: 7
                        detections:
                        - detection: '*******00'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip "
                          origOffSet: 75
                          original_text: '*******00'
                          right: " | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-****-6246 SHAKAI\
                            \ HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-**"
                          textLength: 0
                        - detection: '*******55'
                          left: "HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-****-6333\n\
                            UK Tax UTR ******1030 ******1031 NINO GP 32 76 63 *****280B\
                            \ Germany Tax ID *******1827 *******8911 *******8796 visa\
                            \ 4556501518562241 4929091695478411 aba "
                          origOffSet: 446
                          original_text: '*******55'
                          right: ' *****3532 ssn 098-07-33 16 480-33-1945 Canada SIN
                            *** *** 425 *****3197 Australia Tax ID 45322 1716 98754015
                            Access Key ID 022QF06E7MXBSH9DHM02 AWS Secret Key kWcrlUX5JEDGM/LtmEENI/
                            aVmYvHNif5zB+d9+c'
                          textLength: 0
                        - detection: '***-**-**99'
                          left: "\n\n\n\n\n\n tax id number "
                          origOffSet: 21
                          original_text: '***-**-**99'
                          right: " abs cupp\nIBAN CH9300762011623852957 cusip *******00\
                            \ | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-***"
                          textLength: 0
                        edm_columns: []
                        high_confidence_detections: {}
                        high_confidence_frequency: 7
                        low_confidence_detections: {}
                        low_confidence_frequency: 7
                        matched_confidence_level: high
                        medium_confidence_detections: {}
                        medium_confidence_frequency: 0
                        name: National Id - US Social Security Number - SSN
                        proximity_detection_frequency: 7
                        state: EVALUATED
                        strict_detection_frequency: 0
                        technique: regex
                        type: predefined
                        unique_checksum_detection_frequency: 0
                        unique_detection_frequency: 7
                        unique_high_confidence_frequency: 7
                        unique_low_confidence_frequency: 7
                        unique_medium_confidence_frequency: 0
                        unique_proximity_detection_frequency: 7
                        unique_strict_detection_frequency: 0
                        version: 1
                        weighted_frequency: 0
                    tenant_id: '5886928188517009408'
                    txn_id: '163570374'
                    type: basic
                sample report:
                  value:
                    data_pattern_rule_1_verdict: MATCHED
                    data_profile_id: '11995014'
                    data_profile_name: Sensitive Content
                    detection_time: 10/15/2020 21:16:24 UTC
                    extracted_file_size_in_bytes: 1005635
                    fileSha: 90d068df2381ebd8342c99cf59907e7c9fc7ab3d7c4c6fdc2a3d814eb7ed374f
                    file_name: google_finance_template_1mb.txt
                    file_size_in_bytes: 1005626
                    file_type: txt
                    report_id: '483332512'
                    scanContentRawReport:
                      data_pattern_rule_1_results:
                      - data_pattern_id: 5ee3c51c99025d000161ab9a
                        detection_frequency: 0
                        high_confidence_frequency: 0
                        low_confidence_frequency: 0
                        medium_confidence_frequency: 0
                        name: Bank - American Bankers Association Routing Number -
                          ABA
                        proximity_detection_frequency: 0
                        state: EVALUATED
                        strict_detection_frequency: 0
                        technique: regex
                        type: predefined
                        unique_checksum_detection_frequency: 0
                        unique_detection_frequency: 0
                        unique_high_confidence_frequency: 0
                        unique_low_confidence_frequency: 0
                        unique_medium_confidence_frequency: 0
                        unique_proximity_detection_frequency: 0
                        unique_strict_detection_frequency: 0
                        version: 1
                        weighted_frequency: 0
                      - data_pattern_id: 5ee3c51c99025d000161aba6
                        detection_frequency: 0
                        high_confidence_frequency: 0
                        low_confidence_frequency: 0
                        medium_confidence_frequency: 0
                        name: Voyager Credit Card
                        proximity_detection_frequency: 0
                        state: EVALUATED
                        strict_detection_frequency: 0
                        technique: regex
                        type: predefined
                        unique_checksum_detection_frequency: 0
                        unique_detection_frequency: 0
                        unique_high_confidence_frequency: 0
                        unique_low_confidence_frequency: 0
                        unique_medium_confidence_frequency: 0
                        unique_proximity_detection_frequency: 0
                        unique_strict_detection_frequency: 0
                        version: 1
                        weighted_frequency: 0
                      - data_pattern_id: 5ee3c51d99025d000161ac52
                        detection_frequency: 3
                        high_confidence_frequency: 3
                        low_confidence_frequency: 3
                        matched_confidence_level: high
                        medium_confidence_frequency: 0
                        name: NationalId - US Social Security Number - SSN
                        proximity_detection_frequency: 3
                        state: EVALUATED
                        strict_detection_frequency: 0
                        technique: regex
                        type: predefined
                        unique_checksum_detection_frequency: 0
                        unique_detection_frequency: 3
                        unique_high_confidence_frequency: 3
                        unique_low_confidence_frequency: 3
                        unique_medium_confidence_frequency: 0
                        unique_proximity_detection_frequency: 3
                        unique_strict_detection_frequency: 0
                        version: 1
                        weighted_frequency: 0
                    tenant_id: '7830962012064884736'
                    txn_id: '483332512'
                    type: basic
              schema:
                $ref: '#/components/schemas/ScanContentResponse'
          description: OK
        '400':
          description: Bad Request. Got an invalid JSON.
        '401':
          description: Unauthorized access. An issue occurred during authentication.
            This can indicate an incorrect key, ID, or other invalid authentication
            parameters.
        '403':
          description: Forbidden access. The provided API Key does not have the required
            permissions to run this API.
        '500':
          description: Internal server error. A unified status for API communication
            type errors.
      security:
      - Bearer: []
      summary: Get Report Details
      tags:
      - DLP API
  /v2/api/incidents:
    get:
      description: 'Similarly to how you can view [DLP Incidents on Panorama or Strata
        Cloud Manager](https://docs.paloaltonetworks.com/enterprise-dlp/enterprise-dlp-admin/monitor-enterprise-dlp/view-dlp-log-details),
        you can view your DLP incidents programatically. The API retrieves all DLP
        incidents which you can filter using the query parameters.

        '
      operationId: get-v2-api-incidents
      parameters:
      - description: Sort incidents in ascending order
        in: query
        name: ascending
        required: false
        schema:
          type: boolean
      - description: Source of the DLP incident you are viewing
        in: query
        name: channel
        required: false
        schema:
          enum:
          - ngfw
          - prisma-access
          type: string
      - description: 'The end time of the incident(s) you want to query for in UTC,
          for example: 2023-10-17T02:29:04.402Z.'
        in: query
        name: end_time
        required: false
        schema:
          format: date-time
          type: string
      - description: The file SHA associated with the incident
        in: query
        name: file_shas
        required: false
        schema:
          type: string
      - description: Pagination support to track the number incidents you retrieved
        in: query
        name: page_number
        required: false
        schema:
          format: int32
          type: integer
      - description: Pagination support to reduce the number incidents you retrieved
        in: query
        name: page_size
        required: false
        schema:
          format: int32
          type: integer
      - description: Region the incident was triggered in
        in: query
        name: region
        required: false
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      - description: ID of the retrieved report
        in: query
        name: report_ids
        required: false
        schema:
          items:
            type: string
          type: array
      - description: Sorts incidents. The default sort order is by creation time.
        in: query
        name: sort_by
        required: false
        schema:
          type: string
      - description: 'The start time of the incident(s) that you want to query for
          in UTC, for example: 2023-10-17T02:29:04.402Z.'
        in: query
        name: start_time
        required: false
        schema:
          format: date-time
          type: string
      - description: User IDs associated with the incident.
        in: query
        name: user_ids
        required: false
        schema:
          items:
            type: string
          type: array
      responses:
        '200':
          content:
            application/json:
              examples:
                incidentResponseExample:
                  value:
                    page:
                      number: 1
                      size: 10
                      total_elements: 290
                      total_pages: 29
                    resources:
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995044
                      data_profile_name: PII
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      file_type: pdf
                      incident_creation_time: 2023-Dec-07 18:41:12 UTC
                      incident_id: 7c3dca3d-1c08-4147-b171-9faba84739d4
                      report_id: '1572154781'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995410
                      data_profile_name: Portugal_LNAME_high
                      file_name: test_portugal_LNAME.txt
                      file_sha: 6c25d79cd1dee00b3a6ee6bbb985dae6ee5bdfa31a8dfcffa241786c8c3893a7
                      file_type: txt
                      incident_creation_time: 2023-Dec-07 18:39:38 UTC
                      incident_id: 81985a40-dae5-4e80-8147-678892ccfc00
                      report_id: '2968440380'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995355
                      data_profile_name: inline_timing_11_12_edm
                      file_name: all_patterns_data_1_MB.txt
                      file_sha: 6c8d18c544aba3b44cfa487d5020ec102a6317a6a5164e270bbecf6ea37df925
                      file_type: txt
                      incident_creation_time: 2023-Dec-06 19:39:46 UTC
                      incident_id: 08f014d8-ed13-490e-bfc4-7363f43a4af1
                      report_id: '1347859663'
                      source: ngfw
                      tenant_id: '5886928188517009408'
                    - action: alert
                      channel: ngfw
                      data_profile_id: 11995295
                      data_profile_name: DemoWideNestedProfile
                      file_name: SSNpattern
                      file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                      file_type: pdf
                      incident_creation_time: 2023-Dec-05 21:54:21 UTC
                      incident_id: 6c7d838a-1b25-44fe-8917-1ff760c0eae5
                      report_id: '3741398016'
                      source: ngfw
                      tenant_id: '5886928188517009408'
              schema:
                $ref: '#/components/schemas/IncidentResponse'
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Retrieve DLP Incidents
      tags:
      - DLP API
  /v2/api/incidents/{incidentID}:
    get:
      description: "Similarly to how you can view [DLP Incidents on Panorama](https://docs.paloaltonetworks.com/enterprise-dlp/enterprise-dlp-admin/monitor-enterprise-dlp/view-dlp-log-details),\
        \ you can view your DLP incidents programatically. The API retrieves all DLP\
        \ incidents which you can filter using the query parameters. \n  When using\
        \ the API note: \n  * If you are using multiple filtering parameters such\
        \ as report ID, user ID, file SHA, and channel, all are combined via an \"\
        AND\" operation \n  * All filters are exact matches \n  * Fields with null\
        \ values are not included in the response.\n"
      operationId: get-v2-api-incidents-incidentid
      parameters:
      - description: The incident ID to filter.
        examples:
          IncidentID Example:
            value: 3fb38abe-a83b-44e5-99d5-4bec3765bba6
        in: path
        name: incidentID
        required: true
        schema:
          type: string
      - description: region(default to us)
        in: query
        name: region
        schema:
          enum:
          - us
          - eu
          - uk
          - jp
          - in
          - ap
          - ca
          - au
          - par
          type: string
      responses:
        '200':
          content:
            application/json:
              examples:
                incident detail:
                  value:
                    action: alert
                    channel: ngfw
                    data_profile_id: 11995044
                    data_profile_name: PII
                    file_name: SSNpattern
                    file_sha: a4d58aa3caeb73b56028f597de2b3263d64e2835f277f31c97be53bc76a29e47
                    incident_creation_time: 2024-Jan-18 21:46:54 UTC
                    incident_id: 1a762308-3735-4d29-8edd-4595d4e3f982
                    match_info:
                      6374e1b4dee31d91c40b1705:
                        detection_technique: regex
                        hcf: 0
                        lcf: 5
                        mcf: 0
                        name: Driver License - Slovenia
                        uhcf: 0
                        ulcf: 5
                        umcf: 0
                        version: 1
                      6374e1b4dee31d91c40b1708:
                        detection_technique: regex
                        hcf: 0
                        lcf: 13
                        mcf: 0
                        name: Driver License - Canada
                        uhcf: 0
                        ulcf: 13
                        umcf: 0
                        version: 1
                      6374e1b4dee31d91c40b1709:
                        detection_technique: regex
                        hcf: 0
                        lcf: 17
                        mcf: 0
                        name: Driver License - US
                        uhcf: 0
                        ulcf: 17
                        umcf: 0
                        version: 1
                    report_id: '1107089697'
                    snippets:
                      6374e1b4dee31d91c40b1705:
                        low_confidence_detections:
                        - detection: '*******00'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip "
                          origOffSet: 75
                          original_text: '*******00'
                          right: " | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-****-6246 SHAKAI\
                            \ HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-**"
                          textLength: 0
                        - detection: '*******55'
                          left: "HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-****-6333\n\
                            UK Tax UTR ******1030 ******1031 NINO GP 32 76 63 *****280B\
                            \ Germany Tax ID *******1827 *******8911 *******8796 visa\
                            \ 4556501518562241 4929091695478411 aba "
                          origOffSet: 446
                          original_text: '*******55'
                          right: ' *****3532 ssn 098-07-33 16 480-33-1945 Canada SIN
                            *** *** 425 *****3197 Australia Tax ID 45322 1716 98754015
                            Access Key ID 022QF06E7MXBSH9DHM02 AWS Secret Key kWcrlUX5JEDGM/LtmEENI/
                            aVmYvHNif5zB+d9+c'
                          textLength: 0
                        - detection: '*****3532'
                          left: "BANG\u014C SEIDO MAINANBA ****-****-6333\nUK Tax\
                            \ UTR ******1030 ******1031 NINO GP 32 76 63 *****280B\
                            \ Germany Tax ID *******1827 *******8911 *******8796 visa\
                            \ 4556501518562241 4929091695478411 aba *******55 "
                          origOffSet: 456
                          original_text: '*****3532'
                          right: ' ssn 098-07-33 16 480-33-1945 Canada SIN *** ***
                            425 *****3197 Australia Tax ID 45322 1716 98754015 Access
                            Key ID 022QF06E7MXBSH9DHM02 AWS Secret Key kWcrlUX5JEDGM/LtmEENI/
                            aVmYvHNif5zB+d9+ct ;5301250'
                          textLength: 0
                        version: 1
                      6374e1b4dee31d91c40b1708:
                        low_confidence_detections:
                        - detection: '*******00'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip "
                          origOffSet: 75
                          original_text: '*******00'
                          right: " | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-****-6246 SHAKAI\
                            \ HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-**"
                          textLength: 0
                        - detection: '*****5341'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip *******00 | *****0BG4\
                            \ DEA *****3839 | "
                          origOffSet: 113
                          original_text: '*****5341'
                          right: " CLIA 24C3872984 | 05D0911402\nHETU number ******-856E\
                            \ | *******0490\L\nCPF | **************1-30 CNPJ\L\n*-****-****-6246\
                            \ SHAKAI HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-****-6333\n\
                            UK Tax UTR ******1030 ******10"
                          textLength: 0
                        - detection: '*****3839'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip *******00 | *****0BG4\
                            \ DEA "
                          origOffSet: 101
                          original_text: '*****3839'
                          right: " | *****5341 CLIA 24C3872984 | 05D0911402\nHETU\
                            \ number ******-856E | *******0490\L\nCPF | **************1-30\
                            \ CNPJ\L\n*-****-****-6246 SHAKAI HOSH\u014C ZEI BANG\u014C\
                            \ SEIDO MAINANBA ****-****-6333\nUK Tax UTR ******1"
                          textLength: 0
                        version: 1
                      6374e1b4dee31d91c40b1709:
                        low_confidence_detections:
                        - detection: '*******00'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip "
                          origOffSet: 75
                          original_text: '*******00'
                          right: " | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-****-6246 SHAKAI\
                            \ HOSH\u014C ZEI BANG\u014C SEIDO MAINANBA ****-**"
                          textLength: 0
                        - detection: '******'
                          left: "\n\n\n\n\n\n tax id number ***-**-**99 abs cupp\n\
                            IBAN CH9300762011623852957 cusip *******00 | *****0BG4\
                            \ DEA *****3839 | *****5341 CLIA 24C3872984 | 05D0911402\n\
                            HETU number "
                          origOffSet: 164
                          original_text: '******'
                          right: "-856E | *******0490\L\nCPF | **************1-30\
                            \ CNPJ\L\n*-****-****-6246 SHAKAI HOSH\u014C ZEI BANG\u014C\
                            \ SEIDO MAINANBA ****-****-6333\nUK Tax UTR ******1030\
                            \ ******1031 NINO GP 32 76 63 *****280B Germany Tax ID\
                            \ ***"
                          textLength: 0
                        - detection: '***-**-**99'
                          left: "\n\n\n\n\n\n tax id number "
                          origOffSet: 21
                          original_text: '***-**-**99'
                          right: " abs cupp\nIBAN CH9300762011623852957 cusip *******00\
                            \ | *****0BG4 DEA *****3839 | *****5341 CLIA 24C3872984\
                            \ | 05D0911402\nHETU number ******-856E | *******0490\L\
                            \nCPF | **************1-30 CNPJ\L\n*-****-***"
                          textLength: 0
                        version: 1
                    source: ngfw
                    tenant_id: '5886928188517009408'
              schema:
                $ref: '#/components/schemas/IncidentResponseDTO'
          description: OK
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal server error
      security:
      - Bearer: []
      summary: Retrieve Specific DLP Incident Details
      tags:
      - DLP API
servers:
- url: https://api.dlp.paloaltonetworks.com
tags:
- name: DLP API
