components:
  securitySchemes:
    Bearer:
      scheme: bearer
      type: http
info:
  contact:
    email: support@paloaltonetworks.com
  description: "This Open API spec file represents the APIs available for Prisma Access\
    \ Insights 3.0.\nThe Prisma Access Insights 3.0 APIs allow you to query your Prisma\
    \ Access tenant for the health of\nyour Prisma Access network deployment. The\
    \ 3.0 APIs are are intended for cloud-managed Prisma Access\ncustomers, where\
    \ the tenants have been onboarded by Palo Alto Networks using a Tenant Service\
    \ Group\n(TSG) identifier.\n\nThese APIs use the common SASE authentication mechanism\
    \ and base URL. See the\n[Prisma SASE API Get Started](https://pan.dev/sase/docs/getstarted)\
    \ guide for more information.\n\nThis Open API spec file was created on March\
    \ 13, 2025. To check for a more recent version of this file, see\n[Prisma Insights\
    \ APIs on pan.dev](https://pan.dev//access/api/insights/).\n\n\xA9 2024 Palo Alto\
    \ Networks, Inc. Palo Alto Networks is a registered trademark of Palo\nAlto Networks.\
    \ A list of our trademarks can be found at\n\n[https://www.paloaltonetworks.com/company/trademarks.html](https://www.paloaltonetworks.com/company/trademarks.html)\n\
    \nAll other marks mentioned herein may be trademarks of their respective companies.\n"
  license:
    name: MIT
    url: https://opensource.org/license/mit
  termsOfService: https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/legal/palo-alto-networks-end-user-license-agreement-eula.pdf
  title: Palo Alto Networks 3.0 APIs
  version: '3.0'
openapi: 3.0.1
paths:
  /insights/v3.0/resource/query/applications/application_list:
    post:
      description: "Retrieves list of applications. \n"
      operationId: post-insights-v3.0-resource-query-applications-application_list
      parameters:
      - description: CDL Region
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Mandatory Filters:
                value:
                  filter:
                    rules:
                    - operator: between
                      property: event_time
                      values:
                      - 1721324700000
                      - 1721325600000
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
                      - ngfw
              Possible Filters:
                value:
                  filter:
                    rules:
                    - operator: between
                      property: event_time
                      values:
                      - 1721324700000
                      - 1721325600000
                    - operator: in
                      property: mobileuser
                      values:
                      - John.Smith
                    - operator: in
                      property: experience_score
                      values:
                      - poor
                    - operator: in_nested
                      property: usergroups
                      values:
                      - staff
                    - operator: in
                      property: app
                      values:
                      - doordash
                    - operator: in
                      property: app_category
                      values:
                      - saas
                    - operator: in
                      property: risk_of_app
                      values:
                      - 3
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
                      - ngfw
                    - operator: in
                      property: application_type
                      values:
                      - saas
                    - operator: in
                      property: security_service_type
                      values:
                      - thread_protection
                    - operator: in
                      property: source_type
                      values:
                      - user
                    - operator: equals
                      property: threats_active
                      values:
                      - true
                    - operator: in
                      property: threat_severity
                      values:
                      - Critical
                    - operator: in
                      property: threat_category
                      values:
                      - Malware
                    - operator: in
                      property: deployment_type
                      values:
                      - mu
                      - rn
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - '5'
                  - operator: in
                    property: platform_type
                    values:
                    - prisma_access
              properties:
                app:
                  description: Application name
                  example: doordash
                  type: string
                app_category:
                  description: Category of the application
                  example: saas
                  type: string
                application_type:
                  description: Type of the application
                  enum:
                  - saas
                  - private_apps
                  - internet
                  example: saas
                  type: string
                deployment_type:
                  description: Filters for specific ADEM deployments
                  enum:
                  - mu
                  - rn
                  example: mu
                  type: string
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                event_time:
                  description: Time of the event
                  example: 1709226000000
                  type: integer
                experience_score:
                  description: This filter applies to User/Site experience score.
                    Any application where user or site experience score matches this
                    filter values will be returned.
                  enum:
                  - poor
                  - fair
                  - good
                  example: poor
                  type: string
                mobileuser:
                  description: ADEM Mobile user name
                  example: John.Smith
                  type: string
                platform_type:
                  description: Platform name
                  enum:
                  - prisma_access
                  - ngfw
                  example: prisma_access
                  type: string
                risk_of_app:
                  description: Risk of application
                  enum:
                  - 1
                  - 2
                  - 3
                  - 4
                  - 5
                  example: 3
                  type: integer
                security_service_type:
                  description: Security service type
                  enum:
                  - threat_protection
                  - wildfire
                  - dns_security
                  - url_filtering
                  example: thread_protection
                  type: string
                source_type:
                  description: Type of the source
                  enum:
                  - user
                  - iot
                  - other
                  example: user
                  type: string
                threat_category:
                  description: Category of threats
                  enum:
                  - Malware
                  - Grayware
                  - Phishing
                  - C2
                  - Vulnerability
                  example: Malware
                  type: string
                threat_severity:
                  description: Severity of the threat
                  enum:
                  - High
                  - Critical
                  - Medium
                  - Low
                  - Information
                  example: Critical
                  type: string
                threats_active:
                  description: Apps which have seen any threats
                  enum:
                  - true
                  - false
                  example: false
                  type: boolean
                usergroups:
                  description: Group of the user
                  example: staff
                  type: string
              required:
              - event_time
              - platform_type
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - app: http-video
                  app_category: media
                  app_sub_category: photo-video
                  application_sub_type: unsanctioned
                  port: 443
                  risk_of_app: 4
                  rule_name: rule
                  total_threats: 452
                  url_count: 65011
                  usage_bytes: 4245407346960
                  user_count: 2000
                - app: gmail-base
                  app_category: saas
                  app_sub_category: email
                  application_sub_type: unsanctioned
                  application_test_name: Gmail
                  application_test_target_name: mail.google.com
                  port: 443
                  risk_of_app: 4
                  rule_name: rule
                  total_threats: 0
                  url_count: 648
                  usage_bytes: 1182385504410
                  user_count: 10000
                  user_exp_score: 89.5
                  user_exp_score_verdict: good
                  user_exp_test_uuid: c4ed3e67-c32a-4be1-94ab-ccffb2ed78d6
              schema:
                example:
                  data:
                  - accelerated: true
                    app: doordash
                    app_category: saas
                    app_sub_category: sub_category
                    application_test_name: App Test
                    application_test_target_name: test_target
                    avg_throughput: 100.5
                    pab_event_count: 5
                    port: 443
                    risk_of_app: 3
                    rule_name: rule_1
                    site_exp_score: 90
                    site_exp_score_verdict: excellent
                    site_exp_test_uuid: uuid-5678
                    total_threats: 10
                    url_count: 250
                    usage_bytes: 123456789
                    user_count: 5000
                    user_exp_score: 85
                    user_exp_score_verdict: good
                    user_exp_test_uuid: uuid-1234
                properties:
                  accelerated:
                    description: If application was accelerated
                    type: boolean
                  app:
                    description: Application name
                    type: string
                  app_category:
                    description: Application category
                    type: string
                  app_sub_category:
                    description: Application sub category
                    type: string
                  application_test_name:
                    description: Application test name
                    type: string
                  application_test_target_name:
                    description: Application test target name
                    type: string
                  avg_throughput:
                    description: Average throughput
                    type: number
                  pab_event_count:
                    description: Count of PAB events
                    type: integer
                  port:
                    description: Destination port
                    type: integer
                  risk_of_app:
                    description: Application risk level
                    type: integer
                  rule_name:
                    description: Rule name matched for application
                    type: string
                  site_exp_score:
                    description: Site experience score
                    type: integer
                  site_exp_score_verdict:
                    description: Site experience score verdict
                    type: string
                  site_exp_test_uuid:
                    description: Site experience test UUID
                    type: string
                  total_threats:
                    description: Total threat count
                    type: integer
                  url_count:
                    description: Count of url
                    type: integer
                  usage_bytes:
                    description: Application data usage
                    type: integer
                  user_count:
                    description: Count of users
                    type: integer
                  user_exp_score:
                    description: User experience score
                    type: integer
                  user_exp_score_verdict:
                    description: User experience score verdict
                    type: string
                  user_exp_test_uuid:
                    description: User experience test UUID
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Application list
      tags:
      - Application
  /insights/v3.0/resource/query/locations/location_current_status_count:
    post:
      description: "Retrieves the current location count per node type and location\
        \ state. \n"
      operationId: post-insights-v3.0-resource-query-locations-location_current_status_count
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Mobile User - with adem filter:
                value:
                  filter:
                    rules:
                    - operator: last_n_days
                      property: event_time
                      values:
                      - 7
                    - operator: in
                      property: mu_state
                      values:
                      - 0
                      - 1
                      - 2
                      - 3
                    - operator: in
                      property: deployment_type
                      values:
                      - mu
                      - rn
                    - operator: in
                      property: user_experience_score
                      values:
                      - fair
                      - good
                  properties:
                  - property: mu_state
                  - property: current_mu_locations
              Monitor > Prisma Access Locations > Prisma Access Location RN Status:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: rn_state
                      values:
                      - 1
                  properties:
                  - property: rn_state
                  - property: current_rn_locations
              Monitor > Prisma Access Locations > Prisma Access Location SC Status:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: sc_state
                      values:
                      - 1
                  properties:
                  - property: sc_state
                  - property: current_sc_locations
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - 5
              properties:
                application_name:
                  description: Application name
                  example: doordash
                  type: string
                deployment_type:
                  description: Filters for specific ADEM deployments
                  enum:
                  - mu
                  - rn
                  example: mu
                  type: string
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                ep_state:
                  description: State of the EP
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: integer
                event_time:
                  description: Time of the event
                  example: '1709226000000'
                  type: string
                mu_state:
                  description: State of the MU
                  enum:
                  - 0
                  - 1
                  - 2
                  - 3
                  example: 1
                  type: integer
                nhp_state:
                  description: State of the NHP
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: integer
                rn_state:
                  description: State of the RN
                  enum:
                  - 0
                  - 1
                  - 2
                  - 3
                  example: 1
                  type: integer
                sc_state:
                  description: State of the SC
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: integer
                site_experience_score:
                  description: Quality of application
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                user_experience_score:
                  description: Quality of application
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
              required: []
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              examples:
                MU Count:
                  value:
                    data:
                    - current_mu_locations: 100
                      mu_state: 1
                RN Count:
                  value:
                    data:
                    - current_rn_locations: 24
                      rn_state: 1
              schema:
                example:
                  data:
                  - current_ep_locations: 10
                    current_mu_locations: 100
                    current_nhp_locations: 15
                    current_rn_locations: 24
                    current_sc_locations: 30
                properties:
                  current_ep_locations:
                    description: Count of the explicit-proxy locations
                    type: integer
                  current_mu_locations:
                    description: Count of the mobile-user locations
                    type: integer
                  current_nhp_locations:
                    description: Count of next hop proxy locations
                    type: integer
                  current_rn_locations:
                    description: Count of the remote-network locations
                    type: integer
                  current_sc_locations:
                    description: Count of the service-connection locations
                    type: integer
                  ep_state:
                    description: Location EP State
                    type: integer
                  mu_state:
                    description: Location MU State
                    type: integer
                  nhp_state:
                    description: Location NHP State
                    type: integer
                  rn_state:
                    description: Location RN State
                    type: integer
                  sc_state:
                    description: Location SC State
                    type: integer
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Current location count
      tags:
      - Location
  /insights/v3.0/resource/query/locations/location_gp_mobile_users_logins:
    post:
      description: 'Provides details of the top five Prisma Access location by mobile
        users count.

        '
      operationId: post-insights-v3.0-resource-query-locations-location_gp_mobile_users_logins
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Mandatory Filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
              Possible Filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: node_type
                      values:
                      - 49
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - 5
              properties:
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                event_time:
                  description: Time of the event
                  example: '1709226000000'
                  type: string
                node_type:
                  description: Type of the node
                  example: 49
                  type: number
              required:
              - event_time
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - edge_location_display_name: India West
                  unique_users: 10
                  unique_users_gp: 10
                - edge_location_display_name: US Central
                  unique_users: 10
                  unique_users_gp: 10
                - edge_location_display_name: US East
                  unique_users: 10
                  unique_users_gp: 10
                - edge_location_display_name: US South
                  unique_users: 10
                  unique_users_gp: 10
                - edge_location_display_name: US West
                  unique_users: 10
                  unique_users_gp: 10
              schema:
                example:
                  data:
                  - edge_location_display_name: India West
                    unique_users: 10
                    unique_users_gp: 10
                  - edge_location_display_name: US Central
                    unique_users: 10
                    unique_users_gp: 10
                  - edge_location_display_name: US East
                    unique_users: 10
                    unique_users_gp: 10
                  - edge_location_display_name: US South
                    unique_users: 10
                    unique_users_gp: 10
                  - edge_location_display_name: US West
                    unique_users: 10
                    unique_users_gp: 10
                properties:
                  edge_location_display_name:
                    description: Display name of the location
                    type: string
                  unique_users:
                    description: Number of unique GlobalProtect users at the location
                    type: integer
                  unique_users_gp:
                    description: Number of unique GlobalProtect users at the location
                    type: integer
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Global-Protect mobile users login location
      tags:
      - Location
  /insights/v3.0/resource/query/locations/noc_location_list_rn_sc:
    post:
      description: 'Provides details on Prisma Access locations of branch and data
        center sites.

        '
      operationId: post-insights-v3.0-resource-query-locations-noc_location_list_rn_sc
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Dashboards>Sase Health>Current Sites>Map:
                value:
                  filter:
                    rules: []
              Dashboards>Sase Health>Current Sites>Map>LocationFilter:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
              SiteLocationFilter:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: source_country
                      values:
                      - United States
                    - operator: in
                      property: source_city
                      values:
                      - Santa Clara
            schema:
              example:
                filter:
                  rules: []
              properties:
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                source_city:
                  description: Name of city
                  example: Santa Clara
                  type: string
                source_country:
                  description: Name of country
                  example: United States
                  type: string
              required: []
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - aggregate_status: Up
                  edge_location_display_name: US West
                  latitude: 37.7749
                  longitude: -122.4194
                  rn_count: 1
                  rn_status: Up
                  rn_up_count: 1
                  sc_count: 7
                  sc_status: Up
                  sc_up_count: 7
                - aggregate_status: Up
                  edge_location_display_name: US Northeast
                  latitude: 40.71455
                  longitude: -74.00714
                  rn_count: 1
                  rn_status: Up
                  rn_up_count: 1
                  sc_count: 3
                  sc_status: Up
                  sc_up_count: 0
              schema:
                example:
                  data:
                  - aggregate_status: Up
                    edge_location_display_name: US West
                    latitude: 37.7749
                    longitude: -122.4194
                    rn_count: 1
                    rn_status: Up
                    rn_up_count: 1
                    sc_count: 7
                    sc_status: Up
                    sc_up_count: 7
                properties:
                  aggregate_status:
                    description: Status of the PA Location - UP/DOWN
                    type: string
                  edge_location_display_name:
                    description: Name of PA location
                    type: string
                  latitude:
                    description: Latitude for the PA Location
                    type: number
                  longitude:
                    description: Longitude for the PA Location
                    type: number
                  rn_count:
                    description: Number of RN sites configured
                    type: number
                  rn_status:
                    description: RN Status of the PA Location - UP/DOWN
                    type: string
                  rn_up_count:
                    description: Number of RN sites which are up
                    type: number
                  sc_colo_connection_count:
                    description: Number of Colo Connect Connections
                    type: number
                  sc_colo_connection_up_count:
                    description: Number of Up SC Colo connections
                    type: number
                  sc_colo_count:
                    description: Number of Colo Connect SCs
                    type: number
                  sc_colo_link_count:
                    description: Number of Colo Connect Links
                    type: number
                  sc_colo_link_up_count:
                    description: Number of Up SC Colo connections
                    type: number
                  sc_count:
                    description: Number of SC sites configured
                    type: number
                  sc_status:
                    description: Service Connection Status of the PA Location - UP/DOWN
                    type: string
                  sc_up_count:
                    description: Number of SC sites which are up
                    type: number
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Location and data center sites details
      tags:
      - Location
  /insights/v3.0/resource/query/mobileusers/connected_entity_count:
    post:
      description: "Retrieves the total number of users and devices connected to the\
        \ GlobalProtect Gateway. \nThe count will also include users and devices monitored\
        \ by the ADEM Agent if an ADEM or DEM license is present.\n"
      operationId: post-insights-v3.0-resource-query-mobileusers-connected_entity_count
      parameters:
      - description: CDL Region
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Monitor>Users>Users Table:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: node_type
                      values:
                      - 49
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
              With application_name, platform_type and connection_method:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: connection_method
                      values:
                      - gp
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
              With username filter:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: username
                      values:
                      - John.Smith
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - '5'
                  - operator: in
                    property: node_type
                    values:
                    - '49'
                  - operator: in
                    property: platform_type
                    values:
                    - prisma_access
              properties:
                alternate_username:
                  description: GP user name
                  example: ry06135
                  type: string
                application_score_aggregate_value:
                  description: Quality of application
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                client_gp_version:
                  description: Version of the GP client
                  example: 3.0.1
                  type: string
                client_os_version:
                  description: Version of the client OS
                  example: Apple Mac OS X 12.6.8
                  type: string
                connection_method:
                  description: Type of connection
                  enum:
                  - ep
                  - gp
                  example: gp
                  type: string
                device_name:
                  description: Name of the user device
                  example: WLTH2Q15X3
                  type: string
                device_score_aggregate_value:
                  description: Quality of device score aggregate
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                device_self_serve_status:
                  description: Is device self service
                  example: true
                  type: boolean
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                event_time:
                  description: Time of the event
                  example: '1709226000000'
                  type: string
                internet_score_aggregate_value:
                  description: Quality of internet
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                lan_score_aggregate_value:
                  description: Quality of LAN
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                node_type:
                  description: Type of the node
                  example: 49
                  type: number
                pa_score_aggregate_value:
                  description: Quality of PA
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                platform_type:
                  description: Platform name
                  example: prisma_access
                  type: string
                source_city:
                  description: Name of city
                  example: Santa Clara
                  type: string
                source_country:
                  description: Name of country
                  example: United States
                  type: string
                user_source_ip_address:
                  description: IP address of the user
                  example: 203.129.129.106
                  type: string
                usergroups:
                  description: Group of the user
                  example: staff
                  type: string
                username:
                  description: Mobile user name
                  example: John.Smith@email.com
                  type: string
                wifi_score_aggregate_value:
                  description: Quality of wifi
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
              required:
              - event_time
              - node_type
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - device_count: 1200
                  user_count: 1000
              schema:
                example:
                  data:
                  - device_count: 1200
                    user_count: 1000
                properties:
                  device_count:
                    description: device_count
                    type: integer
                  user_count:
                    description: user_count
                    type: integer
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Total number of connected entities
      tags:
      - MobileUsers
  /insights/v3.0/resource/query/mobileusers/gp/noc_current_connected_user_list:
    post:
      description: 'Retrieves a list of all users currently active on the GlobalProtect
        Gateway.

        If a DEM or ADEM license is present, the time range filter is used to compute
        the experience score.

        '
      operationId: post-insights-v3.0-resource-query-mobileusers-gp-noc_current_connected_user_list
      parameters:
      - description: CDL Region
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Dashboard>Sase Health:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - '5'
              properties:
                connection_method:
                  description: Type of connection
                  enum:
                  - ep
                  - gp
                  example: gp
                  type: string
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                event_time:
                  description: Time of the event
                  example: '1709226000000'
                  type: string
                node_type:
                  description: Type of the node
                  example: 49
                  type: number
                platform_type:
                  description: Platform name
                  example: prisma_access
                  type: string
                source_city:
                  description: Name of city
                  example: Santa Clara
                  type: string
                source_country:
                  description: Name of country
                  example: United States
                  type: string
              required:
              - event_time
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - device_name: John's MacBook
                  distance: 15.5
                  is_connected: true
                  is_degraded: false
                  last_login_time: 1709226000000
                  latitude: 37.7749
                  longitude: -122.4194
                  pa_location: US West
                  username: test_user
              schema:
                example:
                  data:
                  - device_name: John's MacBook
                    distance: 15.5
                    is_connected: true
                    is_degraded: false
                    last_login_time: 1709226000000
                    latitude: 37.7749
                    longitude: -122.4194
                    pa_location: US West
                    username: test_user
                properties:
                  device_name:
                    description: Device name
                    type: string
                  distance:
                    description: distance
                    type: number
                  is_connected:
                    description: Is connected
                    type: boolean
                  is_degraded:
                    description: Indicates if experience degraded
                    type: boolean
                  last_login_time:
                    description: Most recent login time of this user
                    type: integer
                  latitude:
                    description: latitude
                    type: number
                  longitude:
                    description: longitude
                    type: number
                  pa_location:
                    description: Prisma Access location
                    type: string
                  username:
                    description: Username
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: User connected list
      tags:
      - MobileUsers
  /insights/v3.0/resource/query/mobileusers/user_list:
    post:
      description: 'Retrieves a list of all mobile users who connected within the
        specified time range, including all their details.

        '
      operationId: post-insights-v3.0-resource-query-mobileusers-user_list
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Monitor > Users > Users Table:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: node_type
                      values:
                      - 49
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
              Without application_name filter, platform_type:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: username
                      values:
                      - John.Smith
                    - operator: in_nested
                      property: usergroups
                      values:
                      - staff
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: device_name
                      values:
                      - WLTH2Q15X3
                    - operator: in
                      property: source_country
                      values:
                      - United States
                    - operator: in
                      property: source_city
                      values:
                      - Santa Clara
                    - operator: in
                      property: source_ip_address
                      values:
                      - 208.127.155.45
                    - operator: in
                      property: client_os_version
                      values:
                      - Apple Mac OS X 12.6.8
                    - operator: in
                      property: client_gp_version
                      values:
                      - 3.0.1
                    - operator: in
                      property: device_score_aggregate_value
                      values:
                      - good
                    - operator: in
                      property: lan_score_aggregate_value
                      values:
                      - good
                    - operator: in
                      property: pa_score_aggregate_value
                      values:
                      - good
                    - operator: in
                      property: application_score_aggregate_value
                      values:
                      - good
                    - operator: equals
                      property: device_self_serve_status
                      values:
                      - true
                    - operator: in
                      property: platform_type
                      values:
                      - prisma_access
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - '5'
                  - operator: in
                    property: node_type
                    values:
                    - '49'
                  - operator: in
                    property: platform_type
                    values:
                    - prisma_access
              properties:
                alternate_username:
                  description: Mobile user alternate name
                  example: ry06135
                  type: string
                application_score_aggregate_value:
                  description: Quality of application
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                client_gp_version:
                  description: Version of the GP client
                  example: 3.0.1
                  type: string
                client_os_version:
                  description: Version of the client OS
                  example: Apple Mac OS X 12.6.8
                  type: string
                connection_method:
                  description: Type of connection
                  enum:
                  - ep
                  - gp
                  example: gp
                  type: string
                device_name:
                  description: Name of the user device
                  example: WLTH2Q15X3
                  type: string
                device_score_aggregate_value:
                  description: Quality of device score aggregate
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                device_self_serve_status:
                  description: Is device self service
                  example: true
                  type: boolean
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                event_time:
                  description: Time of the event
                  example: '1709226000000'
                  type: string
                internet_score_aggregate_value:
                  description: Quality of internet
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                lan_score_aggregate_value:
                  description: Quality of LAN
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                location_group_name:
                  description: Name of connected location group
                  example: US West
                  type: string
                node_type:
                  description: Type of the node
                  example: 49
                  type: number
                pa_score_aggregate_value:
                  description: Quality of PA
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
                platform_type:
                  description: Platform type
                  example: prisma_access
                  type: string
                project_name:
                  description: Name of the project the user connected to
                  example: Project 1
                  type: string
                source_city:
                  description: Name of city
                  example: Santa Clara
                  type: string
                source_country:
                  description: Name of country
                  example: United States
                  type: string
                source_ip_address:
                  description: IP address of user device
                  example: 208.127.155.45
                  type: string
                user_source_ip_address:
                  description: IP address of the user
                  example: 203.129.129.106
                  type: string
                usergroups:
                  description: Group of the user
                  example: staff
                  type: string
                username:
                  description: Mobile user name
                  example: John.Smith@email.com
                  type: string
                wifi_score_aggregate_value:
                  description: Quality of wifi
                  enum:
                  - poor
                  - fair
                  - good
                  example: good
                  type: string
              required:
              - event_time
              - node_type
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - alternate_usernames:
                  - test_user
                  app_count: 27
                  application_score: 94.80555555555556
                  device_count: 1
                  device_details:
                  - adem_username: test_user
                    alternate_username: test_user
                    application_score: 94.80555555555556
                    application_score_value: good
                    device_agent_uuid: d7b28c1a-ca0a-479d-80d2-8bbf474e3c96
                    device_auth_type: Cookie
                    device_client_gp_version: 6.2.3
                    device_client_private_address: 10.47.147.238
                    device_count: 1
                    device_count_1: 1
                    device_isp_name: ATT-INTERNET4
                    device_last_connected_pa_location: US South
                    device_last_connected_source_city: San Antonio
                    device_last_connected_source_country: United States
                    device_last_login_timestamp_epoc_millis: 1721296808000
                    device_name: M-F727N7FWLW
                    device_os_version: Apple Mac OS X 14.5.0
                    device_score_aggregate: 100.0
                    device_score_aggregate_value: good
                    device_self_serve_notifications_count_internet_connectivity: 0
                    device_self_serve_notifications_count_system_cpu: 0
                    device_self_serve_notifications_count_system_cpu_memory: 0
                    device_self_serve_notifications_count_system_memory: 0
                    device_self_serve_notifications_count_total: 0
                    device_self_serve_notifications_count_wifi_connectivity: 0
                    device_self_serve_notifications_count_wifi_link_quality: 0
                    device_self_serve_notifications_count_wifi_ssid_change: 0
                    device_self_serve_status: true
                    device_source_ip_address: 23.118.233.5
                    internet_score_value: good
                    lan_score_value: fair
                    last_activity_timestamp_epoc_millis: 1721349000000
                    pa_score_value: good
                    platform_type: prisma_access
                    threat_count_1: 0
                    user_last_connected_pa_location: US South
                    user_last_connected_source_city: San Antonio
                    user_last_connected_source_country: United States
                    user_last_login_timestamp_epoc_millis: 1721296808000
                    username: test_user
                    wifi_score_value: good
                  last_activity_timestamp_epoc_millis: 1721349000000
                  platform_type:
                  - prisma_access
                  threat_count: 0
                  total_bytes: 65502354
                  user_agent_uuid:
                  - d7b28c1a-ca0a-479d-80d2-8bbf474e3c96
                  user_auth_type:
                  - Cookie
                  user_client_gp_version:
                  - 6.2.3
                  user_client_private_address:
                  - 10.47.147.238
                  user_isp_name:
                  - ATT-INTERNET4
                  user_last_connected_pa_location: US South
                  user_last_connected_source_city: San Antonio
                  user_last_connected_source_country: United States
                  user_last_login_timestamp_epoc_millis: 1721296808000
                  user_os_version:
                  - Apple Mac OS X 14.5.0
                  user_score_aggregate: 100.0
                  user_self_serve_notifications_count_internet_connectivity: 0
                  user_self_serve_notifications_count_system_cpu: 0
                  user_self_serve_notifications_count_system_cpu_memory: 0
                  user_self_serve_notifications_count_system_memory: 0
                  user_self_serve_notifications_count_total: 0
                  user_self_serve_notifications_count_wifi_connectivity: 0
                  user_self_serve_notifications_count_wifi_link_quality: 0
                  user_self_serve_notifications_count_wifi_ssid_change: 0
                  user_self_serve_status: true
                  user_source_ip_address:
                  - 23.118.233.5
                  username: test_user
              schema:
                example:
                  data:
                  - accelerated: true
                    adem_username: John.Smith
                    alternate_username: ry06135
                    app_count: 5
                    application_score: 95
                    application_score_value: good
                    device_agent_uuid: uuid-1234
                    device_auth_type: Certificate
                    device_client_gp_version: 3.0.1
                    device_client_private_address: 10.0.0.1
                    device_count: 1
                    device_isp_name: ISP Name
                    device_last_connected_pa_location: US West
                    device_last_connected_source_city: Santa Clara
                    device_last_connected_source_country: United States
                    device_last_login_timestamp_epoc_millis: 1709226000000
                    device_name: WLTH2Q15X3
                    device_os_version: Apple Mac OS X 12.6.8
                    device_score_aggregate: 100
                    device_score_aggregate_value: good
                    device_self_serve_notifications_count_internet_connectivity: 0
                    device_self_serve_notifications_count_system_cpu: 0
                    device_self_serve_notifications_count_system_cpu_memory: 0
                    device_self_serve_notifications_count_system_memory: 0
                    device_self_serve_notifications_count_total: 0
                    device_self_serve_notifications_count_wifi_connectivity: 0
                    device_self_serve_notifications_count_wifi_link_quality: 0
                    device_self_serve_notifications_count_wifi_ssid_change: 0
                    device_self_serve_status: true
                    device_source_ip_address: 203.129.129.106
                    internet_score_value: good
                    lan_score_value: good
                    last_activity_timestamp_epoc_millis: 1709226000000
                    location_group_name: US West
                    pa_score_value: good
                    platform_type: prisma_access
                    project_name: Project 1
                    threat_count: 0
                    total_bytes: 1024000
                    user_last_connected_pa_location: US West
                    user_last_connected_source_city: Santa Clara
                    user_last_connected_source_country: United States
                    user_last_login_timestamp_epoc_millis: 1709226000000
                    username: John.Smith@email.com
                    wifi_score_value: good
                properties:
                  accelerated:
                    description: accelerated
                    type: boolean
                  adem_username:
                    description: adem username
                    type: string
                  alternate_username:
                    description: alternate username
                    type: string
                  app_count:
                    description: Applications count
                    type: integer
                  application_score:
                    description: Average Application score for the user/device
                    type: integer
                  application_score_value:
                    description: application_score_value
                    type: string
                  device_agent_uuid:
                    description: device_agent_uuid
                    type: string
                  device_auth_type:
                    description: device_auth_type
                    type: string
                  device_client_gp_version:
                    description: Client GP version
                    type: string
                  device_client_private_address:
                    description: device_client_private_address
                    type: string
                  device_count:
                    description: device count
                    type: integer
                  device_isp_name:
                    description: device isp
                    type: string
                  device_last_connected_pa_location:
                    description: device_last_connected_pa_location
                    type: string
                  device_last_connected_source_city:
                    description: device_last_connected_source_city
                    type: string
                  device_last_connected_source_country:
                    description: device_last_connected_source_country
                    type: string
                  device_last_login_timestamp_epoc_millis:
                    description: device_last_login_timestamp_epoc_millis
                    type: string
                  device_name:
                    description: user device name
                    type: string
                  device_os_version:
                    description: device_os_version
                    type: string
                  device_score_aggregate:
                    description: device_score_aggregate
                    type: integer
                  device_score_aggregate_value:
                    description: device_score_aggregate_value
                    type: string
                  device_self_serve_notifications_count_internet_connectivity:
                    description: internet connectivity notification count
                    type: integer
                  device_self_serve_notifications_count_system_cpu:
                    description: cpu notification count
                    type: integer
                  device_self_serve_notifications_count_system_cpu_memory:
                    description: system cpu memory count
                    type: integer
                  device_self_serve_notifications_count_system_memory:
                    description: system memory count
                    type: integer
                  device_self_serve_notifications_count_total:
                    description: total count
                    type: integer
                  device_self_serve_notifications_count_wifi_connectivity:
                    description: wiki connectivity notification count
                    type: integer
                  device_self_serve_notifications_count_wifi_link_quality:
                    description: wiki link quality count
                    type: integer
                  device_self_serve_notifications_count_wifi_ssid_change:
                    description: wiki ssid change count
                    type: integer
                  device_self_serve_status:
                    description: device serve status
                    type: boolean
                  device_source_ip_address:
                    description: device_source_ip_address
                    type: string
                  internet_score_value:
                    description: internet_score_value
                    type: string
                  lan_score_value:
                    description: lan_score_value
                    type: string
                  last_activity_timestamp_epoc_millis:
                    description: Last activity timestamp
                    type: integer
                  location_group_name:
                    description: Location group name
                    type: string
                  pa_score_value:
                    description: pa_score_value
                    type: string
                  platform_type:
                    description: platform type
                    type: string
                  project_name:
                    description: Project name
                    type: string
                  threat_count:
                    description: Threat count
                    type: integer
                  total_bytes:
                    description: Total data transferred
                    type: integer
                  user_last_connected_pa_location:
                    description: user_last_connected_pa_location
                    type: string
                  user_last_connected_source_city:
                    description: user_last_connected_source_city
                    type: string
                  user_last_connected_source_country:
                    description: user_last_connected_source_country
                    type: string
                  user_last_login_timestamp_epoc_millis:
                    description: user_last_login_timestamp_epoc_millis
                    type: integer
                  username:
                    description: username
                    type: string
                  wifi_score_value:
                    description: wifi_score_value
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Mobile users list
      tags:
      - MobileUsers
  /insights/v3.0/resource/query/sites/bandwidth_consumption_histogram:
    post:
      description: "Retrieves histogram details on the Bandwidth Consumption. \n"
      operationId: post-insights-v3.0-resource-query-sites-bandwidth_consumption_histogram
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              With mandatory filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                  histogram:
                    enableEmptyInterval: true
                    property: event_time
                    range: minute
                    value: 30
              With possible filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: site_state
                      values:
                      - 1
                      - 2
                      - 3
                      - 4
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: site_name
                      values:
                      - Remote-Conn1
                    - operator: in
                      property: node_type
                      values:
                      - 48
                      - 157
                    - operator: in
                      property: instance_state
                      values:
                      - 0
                      - 1
                      - 2
                    - operator: in
                      property: aggregate_region_display_name
                      values:
                      - US West
                    - operator: in
                      property: transport_type
                      values:
                      - IPSEC
                      - GRE
                  histogram:
                    enableEmptyInterval: true
                    property: event_time
                    range: minute
                    value: 30
            schema:
              properties:
                filter:
                  properties:
                    rules:
                      items:
                        properties:
                          aggregate_region_display_name:
                            description: Compute Location
                            example: US West
                            type: string
                          edge_location_display_name:
                            description: Prisma Access Locations
                            example: US West
                            type: string
                          event_time:
                            description: Time of the event.
                            example: 5
                            type: number
                          instance_state:
                            description: State of Instance
                            example: 0
                            type: number
                          node_type:
                            description: Type of node to which site is connected
                            example: 48
                            type: number
                          site_state:
                            description: State of the site
                            example: 1
                            type: number
                          transport_type:
                            description: Type of tunnel
                            example: IPSEC
                            type: string
                        type: object
                      required:
                      - event_time
                      type: array
                  type: object
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  avg_egress:
                    description: Average egress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  avg_ingress:
                    description: Average ingress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  event_time:
                    description: Event time
                    example: 1709226000000
                    type: number
                  median_egress:
                    description: Median egress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  median_ingress:
                    description: Median ingress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  peak_egress:
                    description: Peak egress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  peak_ingress:
                    description: Peak ingress bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                type: object
          description: OK
        '400':
          description: Resource property is not valid
        '403':
          description: Permission Denied
        '404':
          description: Resource not found
        '500':
          description: Failed to process request
      security:
      - Bearer: []
      summary: Bandwidth Consumption Histogram
      tags:
      - Bandwidth Consumption Histogram
  /insights/v3.0/resource/query/sites/rn_list:
    post:
      description: 'Retrieves a list of all branch sites along with their details.

        '
      operationId: post-insights-v3.0-resource-query-sites-rn_list
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              List of Sites with status down:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: site_state
                      subQuery:
                        name: topology_current_status_site_state
                      values:
                      - 0
              Monitor > Branch Sites > Site List:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
              Remote networks list with possible filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: site_state
                      subQuery:
                        name: topology_current_status_site_state
                      values:
                      - 0
                    - operator: in
                      property: instance_state
                      subQuery:
                        name: topology_current_status_instance_state
                      values:
                      - 1
                    - operator: in
                      property: geoip_destination
                      subQuery:
                        name: topology_current_status_geo_location
                      values:
                      - Denver, United States
                    - operator: in
                      property: site_name
                      values:
                      - RN1
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: compute_location
                      values:
                      - US East
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - 5
              properties:
                compute_location:
                  description: Compute Location
                  example: US East
                  type: string
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                geoip_destination:
                  description: Geo IP of the destination
                  example: Denver, United States
                  type: string
                instance_state:
                  description: Instance state
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: number
                site_name:
                  description: Name of the site
                  example: Remote-Conn1
                  type: string
                site_state:
                  description: State of the site
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 0
                  type: number
              required:
              - event_time
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - avg_throughput: 100.5
                  bgp_all_tunnels: 3
                  bgp_site_state: 1
                  bgp_site_state_name: Up
                  bgp_up_tunnels: 2
                  compute_location: US East
                  destination_ip: 192.168.1.2
                  destination_ip_string: 192.168.1.2
                  edge_location_display_name: US West
                  instance_state: 1
                  instance_state_name: Up
                  median_throughput: 95.5
                  node_type: 48
                  peak_throughput: 150.5
                  site_aggregate_capacity: 2000
                  site_all_tunnels: 3
                  site_capacity: 1000
                  site_city: Denver
                  site_connection_duration: 120
                  site_country: USA
                  site_disconnection: 0
                  site_location: Denver, CO
                  site_location_string: Denver, CO
                  site_name: Remote-Conn1
                  site_state: 1
                  site_state_name: Up
                  site_type: Third-Party
                  site_up_tunnels: 2
                  source_ip: 192.168.1.1
                  source_ip_string: 192.168.1.1
              schema:
                example:
                  data:
                  - avg_throughput: 85.2
                    bgp_all_tunnels: 4
                    bgp_site_state: 1
                    bgp_site_state_name: Up
                    bgp_up_tunnels: 3
                    compute_location: US East
                    destination_ip: 203.0.113.2
                    destination_ip_string: 203.0.113.2
                    edge_location_display_name: US West
                    instance_state: 1
                    instance_state_name: Up
                    median_throughput: 80.3
                    node_type: 48
                    peak_throughput: 160.4
                    site_aggregate_capacity: 2500
                    site_all_tunnels: 4
                    site_capacity: 1500
                    site_city: San Francisco
                    site_connection_duration: 150
                    site_country: USA
                    site_disconnection: 0
                    site_location: San Francisco, CA
                    site_location_string: San Francisco, CA
                    site_name: Remote-Conn2
                    site_state: 1
                    site_state_name: Up
                    site_type: Remote Network
                    site_up_tunnels: 3
                    source_ip: 203.0.113.1
                    source_ip_string: 203.0.113.1
                properties:
                  avg_throughput:
                    description: Average throughput
                    example: 100.5
                    type: number
                  bgp_all_tunnels:
                    description: Count of BGP tunnels
                    example: 3
                    type: number
                  bgp_site_state:
                    description: BGP Site State
                    example: 1
                    type: number
                  bgp_site_state_name:
                    description: BGP Site State Name
                    example: Up
                    type: string
                  bgp_up_tunnels:
                    description: Count of Up Tunnels
                    example: 2
                    type: number
                  compute_location:
                    description: Compute Location
                    example: US East
                    type: string
                  destination_ip:
                    description: Destination IP
                    example: 192.168.1.2
                    type: string
                  destination_ip_string:
                    description: Destination IP
                    example: 192.168.1.2
                    type: string
                  edge_location_display_name:
                    description: PA Location
                    example: US West
                    type: string
                  instance_state:
                    description: Instance State
                    example: 1
                    type: number
                  instance_state_name:
                    description: Instance State Name
                    example: Up
                    type: string
                  median_throughput:
                    description: Median throughput
                    example: 95.5
                    type: number
                  node_type:
                    description: Node Type
                    example: 48
                    type: integer
                  peak_throughput:
                    description: Peak throughput
                    example: 150.5
                    type: number
                  site_aggregate_capacity:
                    description: Site Aggregate Capacity
                    example: 2000
                    type: number
                  site_all_tunnels:
                    description: Count of tunnels
                    example: 3
                    type: number
                  site_capacity:
                    description: Site Capacity
                    example: 1000
                    type: number
                  site_city:
                    description: Site City
                    example: Denver
                    type: string
                  site_connection_duration:
                    description: Site Connection Duration
                    example: 120
                    type: number
                  site_country:
                    description: Site Country
                    example: USA
                    type: string
                  site_disconnection:
                    description: Site Disconnection
                    example: 0
                    type: number
                  site_location:
                    description: Site Location
                    example: Denver, CO
                    type: string
                  site_location_string:
                    description: Site Location String
                    example: Denver, CO
                    type: string
                  site_name:
                    description: Site name
                    example: Remote-Conn1
                    type: string
                  site_state:
                    description: Site State
                    example: 1
                    type: number
                  site_state_name:
                    description: Site State Name
                    example: Up
                    type: string
                  site_type:
                    description: Site type
                    example: Remote Network
                    type: string
                  site_up_tunnels:
                    description: Count of Up Tunnels
                    example: 2
                    type: number
                  source_ip:
                    description: Source IP
                    example: 192.168.1.1
                    type: string
                  source_ip_string:
                    description: Source IP
                    example: 192.168.1.1
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: List of branch sites
      tags:
      - Sites
  /insights/v3.0/resource/query/sites/sc_list:
    post:
      description: 'Retrieves the status of Sites and Service Connections.

        '
      operationId: post-insights-v3.0-resource-query-sites-sc_list
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Monitor > Data Centers > SC List:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
              SC list with possible filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: site_state
                      subQuery:
                        name: topology_current_status_site_state
                      values:
                      - 0
                    - operator: in
                      property: instance_state
                      subQuery:
                        name: topology_current_status_instance_state
                      values:
                      - 1
                    - operator: in
                      property: site_name
                      values:
                      - SC1
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: transport_type
                      values:
                      - IPSec
            schema:
              example:
                filter:
                  rules:
                  - operator: last_n_hours
                    property: event_time
                    values:
                    - 5
              properties:
                edge_location_display_name:
                  description: Name of PA location
                  example: US West
                  type: string
                instance_state:
                  description: Instance state
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: number
                site_name:
                  description: Name of the site
                  example: SC-Conn1
                  type: string
                site_state:
                  description: State of the SC
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 0
                  type: number
                transport_type:
                  description: Transport Type
                  enum:
                  - IPSec
                  - Colo-Connect
                  example: IPSec
                  type: string
              required:
              - event_time
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - avg_throughput: 100.5
                  bgp_all_tunnels: 3
                  bgp_site_state: 1
                  bgp_site_state_name: Up
                  bgp_up_tunnels: 2
                  destination_ip: 192.168.1.2
                  destination_ip_string: 192.168.1.2
                  edge_location_display_name: US West
                  instance_state: 1
                  instance_state_name: Up
                  median_throughput: 95.5
                  peak_throughput: 150.5
                  site_all_tunnels: 3
                  site_connection_duration: 120
                  site_disconnection: 0
                  site_name: SC-Conn1
                  site_state: 1
                  site_state_name: Up
                  site_up_tunnels: 2
                  source_ip: 192.168.1.1
                  source_ip_string: 192.168.1.1
                  transport_type: IPSec
              schema:
                example:
                  data:
                  - avg_throughput: 100.5
                    bgp_all_tunnels: 3
                    bgp_site_state: 1
                    bgp_site_state_name: Up
                    bgp_up_tunnels: 2
                    destination_ip: 192.168.1.2
                    destination_ip_string: 192.168.1.2
                    edge_location_display_name: US West
                    instance_state: 1
                    instance_state_name: Up
                    median_throughput: 95.5
                    peak_throughput: 150.5
                    site_all_tunnels: 3
                    site_connection_duration: 120
                    site_disconnection: 0
                    site_name: SC-Conn1
                    site_state: 1
                    site_state_name: Up
                    site_up_tunnels: 2
                    source_ip: 192.168.1.1
                    source_ip_string: 192.168.1.1
                    transport_type: IPSec
                properties:
                  avg_throughput:
                    description: Average throughput
                    example: 100.5
                    type: number
                  bgp_all_tunnels:
                    description: Count of BGP tunnels
                    example: 3
                    type: number
                  bgp_site_state:
                    description: BGP Site State
                    example: 1
                    type: number
                  bgp_site_state_name:
                    description: BGP Site State Name
                    example: Up
                    type: string
                  bgp_up_tunnels:
                    description: Count of Up Tunnels
                    example: 2
                    type: number
                  destination_ip:
                    description: Destination IP
                    example: 192.168.1.2
                    type: string
                  destination_ip_string:
                    description: Destination IP
                    example: 192.168.1.2
                    type: string
                  edge_location_display_name:
                    description: PA Location
                    example: US West
                    type: string
                  instance_state:
                    description: Instance State
                    example: 1
                    type: number
                  instance_state_name:
                    description: Instance State Name
                    example: Up
                    type: string
                  median_throughput:
                    description: Median throughput
                    example: 95.5
                    type: number
                  peak_throughput:
                    description: Peak throughput
                    example: 150.5
                    type: number
                  site_all_tunnels:
                    description: Count of tunnels
                    example: 3
                    type: number
                  site_connection_duration:
                    description: Site Connection Duration
                    example: 120
                    type: number
                  site_disconnection:
                    description: Site Disconnection
                    example: 0
                    type: number
                  site_name:
                    description: Site Name
                    example: SC-Conn1
                    type: string
                  site_state:
                    description: Site State
                    example: 1
                    type: number
                  site_state_name:
                    description: Site State Name
                    example: Up
                    type: string
                  site_up_tunnels:
                    description: Count of Up Tunnels
                    example: 2
                    type: number
                  source_ip:
                    description: Source IP
                    example: 192.168.1.1
                    type: string
                  source_ip_string:
                    description: Source IP
                    example: 192.168.1.1
                    type: string
                  transport_type:
                    description: Transport Type
                    example: IPSec
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: Status of Branch Site and Data Center
      tags:
      - Sites
  /insights/v3.0/resource/query/sites/session_count:
    post:
      description: "Retrieves the number of sessions. \n"
      operationId: post-insights-v3.0-resource-query-sites-session_count
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              With possible filters:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: node_type
                      values:
                      - 51
                    - operator: in
                      property: site_name
                      values:
                      - Remote-Conn1
            schema:
              properties:
                filter:
                  properties:
                    rules:
                      items:
                        properties:
                          node_type:
                            description: Type of the node
                            example: 51
                            type: number
                          site_name:
                            description: Site name
                            example: Remote-Conn1
                            type: string
                        type: object
                      type: array
                  type: object
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  active_max_sessions:
                    description: Maximum number of active sessions
                    example: 10
                    type: number
                  active_sessions:
                    description: Number of active sessions
                    example: 5
                    type: number
                type: object
          description: OK
        '400':
          description: Resource property is not valid
        '403':
          description: Permission Denied
        '404':
          description: Resource not found
        '500':
          description: Failed to process request
      security:
      - Bearer: []
      summary: Session Count API
      tags:
      - Session Count
  /insights/v3.0/resource/query/sites/site_count:
    post:
      description: 'Retrieves the number of sites.

        '
      operationId: post-insights-v3.0-resource-query-sites-site_count
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              With possible filters:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: node_type
                      values:
                      - 48
            schema:
              properties:
                filter:
                  properties:
                    rules:
                      items:
                        properties:
                          node_type:
                            description: Type of the node
                            example: 48
                            type: number
                        type: object
                      type: array
                  type: object
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  node_type:
                    description: node type
                    example: 48
                    type: number
                  site_count:
                    description: Site Count
                    example: 10
                    type: number
                type: object
          description: OK
        '400':
          description: Resource property is not valid
        '403':
          description: Permission Denied
        '404':
          description: Resource not found
        '500':
          description: Failed to process request
      security:
      - Bearer: []
      summary: Site Count API
      tags:
      - Site Count
  /insights/v3.0/resource/query/sites/site_location_search_contains:
    post:
      description: "Retrieves the location search data for the site. \n"
      operationId: post-insights-v3.0-resource-query-sites-site_location_search_contains
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              With possible filters:
                value:
                  filter:
                    rules:
                    - operator: equals
                      property: location
                      values:
                      - United States, Ashburn
            schema:
              properties:
                filter:
                  properties:
                    rules:
                      items:
                        properties:
                          location:
                            description: Location of the site
                            example: United States, Ashburn
                            type: string
                        type: object
                      type: array
                  type: object
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                items:
                  properties:
                    location:
                      description: Site Location
                      example: United States, Ashburn
                      type: string
                  type: object
                type: array
          description: OK
        '400':
          description: Resource property is not valid
        '403':
          description: Permission Denied
        '404':
          description: Resource not found
        '500':
          description: Failed to process request
      security:
      - Bearer: []
      summary: Site Location Search API
      tags:
      - Site Location Search
  /insights/v3.0/resource/query/sites/site_status:
    post:
      description: "Retrieves a list of Service Connections and their details. \n"
      operationId: post-insights-v3.0-resource-query-sites-site_status
      parameters:
      - description: "Region mapping for the tenant. \n"
        in: header
        name: X-PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: TSG ID
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              Monitor > Branch Sites > Site Status:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: node_type
                      values:
                      - 48
              Monitor > Data Centers > SC Status:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: node_type
                      values:
                      - 51
              Possible filters:
                value:
                  filter:
                    rules:
                    - operator: in
                      property: node_type
                      values:
                      - 48
                    - operator: in
                      property: site_state
                      values:
                      - 0
                    - operator: in
                      property: instance_state
                      values:
                      - 1
                    - operator: in
                      property: geoip_destination
                      subQuery:
                        name: topology_current_status_geo_location
                      values:
                      - Denver, United States
                    - operator: in
                      property: site_name
                      values:
                      - RN1
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - US West
                    - operator: in
                      property: compute_location
                      values:
                      - US East
                    - operator: in
                      property: transport_type
                      values:
                      - IPSec
            schema:
              example:
                filter:
                  rules:
                  - operator: in
                    property: node_type
                    values:
                    - 48
              properties:
                geoip_destination:
                  description: Geo IP of the destination
                  example: Denver, United States
                  type: string
                instance_state:
                  description: Instance state
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 1
                  type: number
                site_name:
                  description: Name of the site or data center
                  example: RN-1
                  type: string
                site_state:
                  description: State of the site
                  enum:
                  - 0
                  - 1
                  - 2
                  example: 0
                  type: number
                transport_type:
                  description: Transport Type
                  enum:
                  - IPSec
                  - Colo-Connect
                  example: IPSec
                  type: string
              required: []
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              example:
                data:
                - node_type: 48
                  site_count: 25
                  site_state: 1
                  site_state_name: Up
                - node_type: 48
                  site_count: 5
                  site_state: 0
                  site_state_name: Down
              schema:
                example:
                  data:
                  - node_type: 48
                    site_count: 25
                    site_state: 1
                    site_state_name: Up
                properties:
                  node_type:
                    description: Node Type
                    type: integer
                  site_count:
                    description: Site Count
                    type: integer
                  site_state:
                    description: Site State
                    type: integer
                  site_state_name:
                    description: Site State Name
                    type: string
                type: object
          description: OK
      security:
      - Bearer: []
      summary: List of Data Centers
      tags:
      - Sites
  /insights/v3.0/resource/query/sites/site_traffic:
    post:
      description: "Get details on the site traffic. \n"
      operationId: post-insights-v3.0-resource-query-sites-site_traffic
      parameters:
      - description: 'Region mapping for the tenant.

          '
        in: header
        name: PANW-Region
        required: true
        schema:
          example: americas
          type: string
      - description: 'A Prisma-Tenant is a unique identifier for a tenant or a subtenant
          within a single or multi-tenant architecture, providing precise tenant management
          and resource allocation.

          '
        in: header
        name: Prisma-Tenant
        required: false
        schema:
          example: 12345678:12345679
          type: string
      requestBody:
        content:
          application/json:
            examples:
              api with all possible filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
                    - operator: in
                      property: node_type
                      values:
                      - 48
                    - operator: in
                      property: edge_location_display_name
                      values:
                      - us-west
                    - operator: in
                      property: site_name
                      values:
                      - Remote-Conn1
                    - operator: in
                      property: site_state
                      values:
                      - 1
                      - 2
                      - 3
                      - 4
                    - operator: in
                      property: spn_name
                      values:
                      - SPN1
                    - operator: in
                      property: instance_state
                      values:
                      - 0
                      - 1
                      - 2
                    - operator: in
                      property: compute_location
                      values:
                      - us-east
                    - operator: in
                      property: transport_type
                      values:
                      - IPSEC
                      - GRE
              api with required filters:
                value:
                  filter:
                    rules:
                    - operator: last_n_hours
                      property: event_time
                      values:
                      - 5
            schema:
              properties:
                filter:
                  properties:
                    rules:
                      items:
                        properties:
                          compute_location:
                            description: Location of the device
                            example: US East
                            type: string
                          edge_location_display_name:
                            description: Name of PA location
                            example: US West
                            type: string
                          event_time:
                            description: Time of the event
                            example: 5
                            type: number
                          instance_state:
                            description: State of the instance
                            example: 0
                            type: number
                          node_type:
                            description: Type of the node
                            example: 48
                            type: number
                          site_name:
                            description: Name of the site
                            example: Remote-Conn1
                            type: string
                          site_state:
                            description: State of the site
                            example: 1
                            type: number
                          spn_name:
                            description: Name of the SPN
                            example: SPN1
                            type: string
                          transport_type:
                            description: Type of transport
                            example: IPSEC
                            type: string
                        type: object
                      required:
                      - event_time
                      type: array
                  type: object
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  egress_bytes_pa_to_gcp:
                    description: Total Egress Bandwidth consumed from PA to GCP
                    example: 1000000.0
                    format: float
                    type: number
                  egress_bytes_pa_to_internet:
                    description: Total Egress Bandwidth consumed from PA to Internet
                    example: 1000000.0
                    format: float
                    type: number
                  egress_bytes_transferred:
                    description: Total Egress Bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  ingress_bytes_transferred:
                    description: Total Ingress Bandwidth consumed
                    example: 1000000.0
                    format: float
                    type: number
                  pa_to_gcp_distr:
                    description: Percentage of traffic from PA to GCP
                    example: 1000000.0
                    format: float
                    type: number
                  pa_to_internet_distr:
                    description: Percentage of traffic from PA to Internet
                    example: 1000000.0
                    format: float
                    type: number
                type: object
          description: OK
        '400':
          description: Resource property is not valid
        '403':
          description: Permission Denied
        '404':
          description: Resource not found
        '500':
          description: Failed to process request
      security:
      - Bearer: []
      summary: Site Traffic details
      tags:
      - Site Traffic
servers:
- url: https://api.sase.paloaltonetworks.com
tags:
- description: 'Endpoint to retrieve the bandwidth consumption histogram that provides
    detailed metrics on the total amount of data transferred across a network using
    trend.

    '
  name: Bandwidth Consumption Histogram API
- description: 'Endpoint to retrieve the session count API provides insights into
    the number of active sessions across various network locations.

    '
  name: Session Count API
- description: 'The Site Count API provides a count of sites based on the specified
    filter criteria. It offers insights into the overall site distribution within
    a network, enabling users to understand the scale and composition of their infrastructure.
    This API is typically used for network planning, capacity management, and reporting
    purposes.

    '
  name: Site Count API
- description: 'Endpoint to retrieve the site traffic API provides detailed metrics
    on the total amount of data transferred across a network.

    '
  name: Site Location Search API
- description: 'Endpoint to retrieve the site location search API provides a comprehensive
    list of geo ip destination country names allowing for efficient management, and
    performance monitoring.

    '
  name: Site Location Search API
- description: 'Location API

    '
  name: Location API
- description: 'Mobile users API

    '
  name: Mobile Users API
- description: 'Sites API

    '
  name: Sites API
- description: 'Application API

    '
  name: Application API
