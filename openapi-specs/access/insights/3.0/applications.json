{
  "openapi" : "3.0.1",
  "info" : {
    "title" : "SASE IA - Resource API",
    "version" : "v3"
  },
  "servers" : [ {
    "url" : "http://localhost:8080"
  }, {
    "url" : "https://dev.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://qa.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://staging.us.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://api.sase.paloaltonetworks.com"
  } ],
  "security" : [ {
    "JWT" : [ ]
  } ],
  "paths" : {
    "/insights/v3.0/resource/query/applications/application_list" : {
      "post" : {
        "summary" : "Endpoint to get all application list",
        "operationId" : "getApplicationList",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time", "injected_time_range_seconds" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "app" : {
                    "type" : "string",
                    "description" : "Application name",
                    "example" : "doordash"
                  },
                  "app_category" : {
                    "type" : "string",
                    "description" : "Category of the application",
                    "example" : "saas"
                  },
                  "risk_of_app" : {
                    "type" : "integer",
                    "description" : "Risk of application",
                    "example" : 3,
                    "enum" : [ 0, 1, 2, 3, 4, 5 ]
                  },
                  "edge_location_display_name" : {
                    "type" : "string",
                    "description" : "Name of PA location",
                    "example" : "US West"
                  },
                  "user_exp_score" : {
                    "type" : "string",
                    "description" : "User experience score",
                    "example" : "94.5"
                  },
                  "site_exp_score" : {
                    "type" : "string",
                    "description" : "Site experience score",
                    "example" : "94.5"
                  },
                  "user_exp_score_verdict" : {
                    "type" : "string",
                    "description" : "User experience score verdict",
                    "example" : "good",
                    "enum" : [ "unknown", "poor", "fair", "good" ]
                  },
                  "site_exp_score_verdict" : {
                    "type" : "string",
                    "description" : "Site experience score verdict",
                    "example" : "good",
                    "enum" : [ "unknown", "poor", "fair", "good" ]
                  },
                  "usergroups" : {
                    "type" : "string",
                    "description" : "Group of the user",
                    "example" : "staff"
                  },
                  "mobileuser" : {
                    "type" : "string",
                    "description" : "Mobile user name",
                    "example" : "John.Smith"
                  },
                  "experience_score" : {
                    "type" : "string",
                    "description" : "User experience score",
                    "example" : "poor",
                    "enum" : [ "unknown", "poor", "fair", "good" ]
                  },
                  "application_name" : {
                    "type" : "string",
                    "description" : "Name of the application",
                    "example" : "smb"
                  },
                  "injected_time_range_seconds" : {
                    "type" : "string",
                    "description" : "Time range in seconds",
                    "example" : "60"
                  },
                  "platform_type" : {
                    "type" : "string",
                    "description" : "Platform name",
                    "example" : "PRISMA_ACCESS"
                  },
                  "application_type" : {
                    "type" : "string",
                    "description" : "Type of the application",
                    "example" : "saas",
                    "enum" : [ "saas", "private_apps", "internet" ]
                  },
                  "security_service_type" : {
                    "type" : "string",
                    "description" : "Security service type",
                    "example" : "thread_protection",
                    "enum" : [ "url_filtering", "threat_protection", "wildfire" ]
                  },
                  "source_type" : {
                    "type" : "string",
                    "description" : "Type of the source",
                    "example" : "user",
                    "enum" : [ "user", "iot", "other" ]
                  },
                  "threats_active" : {
                    "type" : "boolean",
                    "description" : "Is the threat active",
                    "example" : false,
                    "enum" : [ true, false ]
                  }
                }
              },
              "examples" : {
                "With platform type" : {
                  "value" : {
                    "filter" : {
                      "rules" : [ {
                        "property" : "event_time",
                        "operator" : "last_n_hours",
                        "values" : [ 5 ]
                      }, {
                        "property" : "mobileuser",
                        "operator" : "in",
                        "values" : [ "John.Smith" ]
                      }, {
                        "property" : "experience_score",
                        "operator" : "in",
                        "values" : [ "poor" ]
                      }, {
                        "property" : "usergroups",
                        "operator" : "in_nested",
                        "values" : [ "staff" ]
                      }, {
                        "property" : "app",
                        "operator" : "in",
                        "values" : [ "doordash" ]
                      }, {
                        "property" : "app_category",
                        "operator" : "in",
                        "values" : [ "saas" ]
                      }, {
                        "property" : "risk_of_app",
                        "operator" : "in",
                        "values" : [ 3 ]
                      }, {
                        "property" : "edge_location_display_name",
                        "operator" : "in",
                        "values" : [ "US West" ]
                      }, {
                        "property" : "platform_type",
                        "operator" : "in",
                        "values" : [ "PRISMA_ACCESS" ]
                      } ]
                    }
                  }
                },
                "Monitor>Applications" : {
                  "value" : {
                    "filter" : {
                      "rules" : [ {
                        "property" : "event_time",
                        "operator" : "last_n_hours",
                        "values" : [ 5 ]
                      } ]
                    }
                  }
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "app" : {
                      "type" : "string",
                      "description" : "Application name"
                    },
                    "app_category" : {
                      "type" : "string",
                      "description" : "Application category"
                    },
                    "risk_of_app" : {
                      "type" : "integer",
                      "description" : "Application risk level"
                    },
                    "usage_bytes" : {
                      "type" : "integer",
                      "description" : "Application data usage"
                    },
                    "total_threats" : {
                      "type" : "integer",
                      "description" : "Total threat count"
                    },
                    "user_exp_score" : {
                      "type" : "integer",
                      "description" : "User experience score"
                    },
                    "user_exp_score_verdict" : {
                      "type" : "string",
                      "description" : "User experience score verdict"
                    },
                    "site_exp_score" : {
                      "type" : "integer",
                      "description" : "Site experience score"
                    },
                    "site_exp_score_verdict" : {
                      "type" : "string",
                      "description" : "Site experience score verdict"
                    },
                    "user_exp_test_uuid" : {
                      "type" : "string",
                      "description" : "User experience test UUID"
                    },
                    "site_exp_test_uuid" : {
                      "type" : "string",
                      "description" : "Site experience test UUID"
                    },
                    "application_test_name" : {
                      "type" : "string",
                      "description" : "Application test name"
                    },
                    "application_test_target_name" : {
                      "type" : "string",
                      "description" : "Application test target name"
                    },
                    "accelerated" : {
                      "type" : "boolean",
                      "description" : "accelerated"
                    },
                    "avg_throughput" : {
                      "type" : "number",
                      "description" : "Average throughput"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    }
  },
  "components" : {
    "securitySchemes" : {
      "JWT" : {
        "type" : "http",
        "description" : "JWT authentication with bearer token",
        "scheme" : "bearer",
        "bearerFormat" : "Bearer [token]"
      }
    }
  }
}