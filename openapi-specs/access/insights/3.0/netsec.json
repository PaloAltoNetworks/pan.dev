{
  "openapi" : "3.0.1",
  "info" : {
    "title" : "SASE IA - Resource API",
    "version" : "v3"
  },
  "servers" : [ {
    "url" : "http://localhost:8080"
  }, {
    "url" : "https://dev.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://qa.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://staging.us.api.sase.paloaltonetworks.com"
  }, {
    "url" : "https://api.sase.paloaltonetworks.com"
  } ],
  "security" : [ {
    "JWT" : [ ]
  } ],
  "paths" : {
    "/insights/v3.0/resource/query/netsec/traffic_application_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, security_service_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getTrafficApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "bytes_total_volume_all" : {
                      "type" : "integer",
                      "description" : "traffic bytes count for application_types by application_type (internet, private_apps, saas_apps)"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/per_application_experience_score_v2" : {
      "post" : {
        "summary" : "get per application experiance score",
        "operationId" : "get_per_application_experience_score",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "data transferred bytes"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "avg_app_score" : {
                      "type" : "number",
                      "description" : "Average app score"
                    },
                    "poor_experience_user_count" : {
                      "type" : "integer",
                      "description" : "Poor app experience user count"
                    },
                    "good_experience_user_count" : {
                      "type" : "string",
                      "description" : "Good app experience user count"
                    },
                    "non_monitored_user_count" : {
                      "type" : "string",
                      "description" : "Non monitored user count"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_count_histogram" : {
      "post" : {
        "summary" : "Endpoint to timeseries view of number of threats broken down by different dimensions. dimensions include source_type, security_service_type, app_type",
        "operationId" : "getThreatCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_bin_type" : {
                    "type" : "string",
                    "description" : "Bin type",
                    "example" : "three_hours",
                    "enum" : [ "twelve_hours", "three_hours", "five_minutes", "thirty_minutes" ]
                  },
                  "injected_bin_offset" : {
                    "type" : "string",
                    "description" : "Offset from the bin",
                    "example" : "40"
                  },
                  "injected_force_aligned_timerange" : {
                    "type" : "integer",
                    "description" : "Should force timerange to align",
                    "example" : 1,
                    "enum" : [ 0, 1 ]
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  },
                  "injected_aggregation_window_length" : {
                    "type" : "integer",
                    "description" : "Aggregation window length in minutes",
                    "example" : 60
                  },
                  "injected_query_time_start" : {
                    "type" : "integer",
                    "description" : "Query start time since epoch",
                    "example" : 1709226000
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_bin_type",
                    "operator" : "in",
                    "values" : [ "three_hours" ]
                  }, {
                    "property" : "injected_bin_offset",
                    "operator" : "in",
                    "values" : [ "40" ]
                  }, {
                    "property" : "injected_force_aligned_timerange",
                    "operator" : "in",
                    "value" : [ 1 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  }, {
                    "property" : "injected_aggregation_window_length",
                    "operator" : "in",
                    "value" : [ 60 ]
                  }, {
                    "property" : "injected_query_time_start",
                    "operator" : "in",
                    "value" : [ 1709226000 ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "event_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "histogram_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "blocked_count" : {
                      "type" : "integer",
                      "description" : "number of threats blocked"
                    },
                    "allowed_count" : {
                      "type" : "integer",
                      "description" : "number of threats allowed"
                    },
                    "total_count" : {
                      "type" : "integer",
                      "description" : "number of threats blocked and allowed"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_application_count" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, security_service_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getTrafficApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "bytes_total_volume_all" : {
                      "type" : "integer",
                      "description" : "traffic bytes count for application_types by application_type (internet, private_apps, saas_apps)"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_source_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, app_type, platform_type",
        "operationId" : "getAdemSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating traffic"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get data transferred broken down by different dimensions. dimensions include bytes_total, source_type, source_sub_type, app_type",
        "operationId" : "getTrafficCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic"
                    },
                    "source_sub_type" : {
                      "type" : "string",
                      "description" : "sub type of Origin for traffic"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total" : {
                      "type" : "integer",
                      "description" : "total bytes transferred"
                    },
                    "bytes_inspected_total" : {
                      "type" : "integer",
                      "description" : "bytes count for which traffic is inspected and session terminated with reason threat"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/security_subscriptions" : {
      "post" : {
        "summary" : "Get List of Security Subscriptions and for each type of subscription returns number of devices/pa locations the license is enabled on. ",
        "operationId" : "getThreatApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "license_enabled" : {
                      "type" : "integer",
                      "description" : "Type of application that the source was hitting"
                    },
                    "license_purchased" : {
                      "type" : "integer",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_count_per_application_v2" : {
      "post" : {
        "summary" : "Endpoint to get traffic volume (data transferred) per application broken down by different dimensions. dimensions include application name, severity,source_type",
        "operationId" : "getTrafficCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "data transferred bytes"
                    },
                    "user_count_per_app" : {
                      "type" : "integer",
                      "description" : "users accessing each app"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_application_count" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getAdemApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_site_experience_volume" : {
      "post" : {
        "summary" : "Endpoint to get count of ADEM site experience",
        "operationId" : "getAdemSiteExperienceScore",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "for ADEM source_type is always 'user'"
                    },
                    "source_sub_type" : {
                      "type" : "string",
                      "description" : "for ADEM source_type is always 'user_branch'"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "for ADEM source_type is always 'Users'"
                    },
                    "source_sub_type_label" : {
                      "type" : "string",
                      "description" : "for ADEM source_type is always 'BRANCH USERS'"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "for ADEM platform_type is 'prisma_access' for now"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "for ADEM platform_type is 'Prisma_access' for now"
                    },
                    "good_experience_site_count" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 30 percent for the site experience"
                    },
                    "poor_experience_site_count" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 30 percent for the site experience"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_count_per_application" : {
      "post" : {
        "summary" : "Endpoint to get number of threats broken down by different dimensions. dimensions include application name, severity,source_type, security_service_type",
        "operationId" : "getThreatCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "severity" : {
                      "type" : "string",
                      "description" : "Critical/High/Medium/Low"
                    },
                    "total_threat_count" : {
                      "type" : "integer",
                      "description" : "number of threats"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_experience_volume" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, security_service_type, app_type, platform_type",
        "operationId" : "getThreatSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "source_sub_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_sub_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "poor_experience_user_count" : {
                      "type" : "integer",
                      "description" : "number of threats allowed"
                    },
                    "good_experience_user_count" : {
                      "type" : "integer",
                      "description" : "number of threats allowed"
                    },
                    "non_monitored_user_count" : {
                      "type" : "integer",
                      "description" : "number of threats allowed"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_application_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, security_service_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getThreatApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_source_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, security_service_type, app_type, platform_type",
        "operationId" : "getThreatSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating threat"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/dns_request_histogram" : {
      "post" : {
        "summary" : "Endpoint to timeseries view of count of DNS requests broken down by different dimensions. dimensions include source_type, platform_type, app_type",
        "operationId" : "getDNSRequest",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_bin_type" : {
                    "type" : "string",
                    "description" : "Bin type",
                    "example" : "three_hours",
                    "enum" : [ "twelve_hours", "three_hours", "five_minutes", "thirty_minutes" ]
                  },
                  "injected_bin_offset" : {
                    "type" : "string",
                    "description" : "Offset from the bin",
                    "example" : "40"
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_bin_type",
                    "operator" : "in",
                    "values" : [ "three_hours" ]
                  }, {
                    "property" : "injected_bin_offset",
                    "operator" : "in",
                    "values" : [ "40" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "event_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "histogram_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin of DNS request"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting - not valid for DNS requests"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "total_count" : {
                      "type" : "integer",
                      "description" : "total number of DNS request"
                    },
                    "malicious_count" : {
                      "type" : "integer",
                      "description" : "number of malicious DNS request"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_experience_count" : {
      "post" : {
        "summary" : "Endpoint to get count of ADEM segment wise experience (Device, WiFi, LAN, Internet, Application)",
        "operationId" : "getAdemSegmentWiseExperienceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "for ADEM source_type is always 'user'"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting - 'saas' hardcoded for now TODO"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "for ADEM platform_type is 'prisma_access' for now"
                    },
                    "device_score_good" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 70 percent for the device experience"
                    },
                    "device_score_poor" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 70 percent for the device experience"
                    },
                    "wifi_score_good" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 70 percent for the wifi experience"
                    },
                    "wifi_score_poor" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 70 percent for the wifi experience"
                    },
                    "lan_score_good" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 70 percent for the lan experience"
                    },
                    "lan_score_poor" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 70 percent for the lan experience"
                    },
                    "internet_score_good" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 70 percent for the internet experience"
                    },
                    "internet_score_poor" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 70 percent for the internet experience"
                    },
                    "app_score_good" : {
                      "type" : "integer",
                      "description" : "number of users having a score of greater than or equal to 70 percent for the application experience"
                    },
                    "app_score_poor" : {
                      "type" : "integer",
                      "description" : "number of users having a score of less than 70 percent for the application experience"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_count_histogram" : {
      "post" : {
        "summary" : "Endpoint to timeseries view of traffic and bpa broken down by different dimensions. dimensions include source_type, app_type",
        "operationId" : "getTrafficCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_bin_type" : {
                    "type" : "string",
                    "description" : "Bin type",
                    "example" : "three_hours",
                    "enum" : [ "twelve_hours", "three_hours", "five_minutes", "thirty_minutes" ]
                  },
                  "injected_bin_offset" : {
                    "type" : "string",
                    "description" : "Offset from the bin",
                    "example" : "40"
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_bin_type",
                    "operator" : "in",
                    "values" : [ "three_hours" ]
                  }, {
                    "property" : "injected_bin_offset",
                    "operator" : "in",
                    "values" : [ "40" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "event_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "histogram_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "data transferred per application"
                    },
                    "bpa_result" : {
                      "type" : "string",
                      "description" : "bpa result true or false"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_source_count" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, app_type, platform_type",
        "operationId" : "getTrafficSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating traffic"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "total bytes transferred"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_count_per_application" : {
      "post" : {
        "summary" : "Endpoint to get traffic volume (data transferred) per application broken down by different dimensions. dimensions include application name, severity,source_type",
        "operationId" : "getTrafficCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "data transferred bytes"
                    },
                    "user_count_per_app" : {
                      "type" : "integer",
                      "description" : "users accessing each app"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_application_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getAdemApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_count" : {
      "post" : {
        "summary" : "Endpoint to get number of threats broken down by different dimensions. dimensions include severity, threat_category_group, source_type, source_sub_type, security_service_type, security_service_sub_type, app_type",
        "operationId" : "getThreatCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "source_sub_type" : {
                      "type" : "string",
                      "description" : "sub type of Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "security_service_sub_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "threat_category_group" : {
                      "type" : "string",
                      "description" : "Name of threat groups traffic can be classified into"
                    },
                    "severity" : {
                      "type" : "string",
                      "description" : "Critical/High/Medium/Low"
                    },
                    "blocked_count" : {
                      "type" : "integer",
                      "description" : "number of threats blocked"
                    },
                    "allowed_count" : {
                      "type" : "integer",
                      "description" : "number of threats allowed"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_sub_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_source_count" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, security_service_type, app_type, platform_type",
        "operationId" : "getThreatSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating threat"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/adem_source_count" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, app_type, platform_type",
        "operationId" : "getAdemSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating traffic"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/url_count_histogram" : {
      "post" : {
        "summary" : "Endpoint to timeseries view of count of urls broken down by different dimensions. dimensions include source_type, platform_type, app_type",
        "operationId" : "getUrlCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_bin_type" : {
                    "type" : "string",
                    "description" : "Bin type",
                    "example" : "three_hours",
                    "enum" : [ "twelve_hours", "three_hours", "five_minutes", "thirty_minutes" ]
                  },
                  "injected_bin_offset" : {
                    "type" : "string",
                    "description" : "Offset from the bin",
                    "example" : "40"
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_bin_type",
                    "operator" : "in",
                    "values" : [ "three_hours" ]
                  }, {
                    "property" : "injected_bin_offset",
                    "operator" : "in",
                    "values" : [ "40" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "event_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "histogram_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "total_count" : {
                      "type" : "integer",
                      "description" : "total number of urls analyzed"
                    },
                    "malicious_count" : {
                      "type" : "integer",
                      "description" : "number of malicious urls"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/wildfire_count_histogram" : {
      "post" : {
        "summary" : "Endpoint to timeseries view of number of Wildfire threats broken down by different dimensions. dimensions include source_type, security_service_type, app_type",
        "operationId" : "getWildfireThreatCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_bin_type" : {
                    "type" : "string",
                    "description" : "Bin type",
                    "example" : "three_hours",
                    "enum" : [ "twelve_hours", "three_hours", "five_minutes", "thirty_minutes" ]
                  },
                  "injected_bin_offset" : {
                    "type" : "string",
                    "description" : "Offset from the bin",
                    "example" : "40"
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_bin_type",
                    "operator" : "in",
                    "values" : [ "three_hours" ]
                  }, {
                    "property" : "injected_bin_offset",
                    "operator" : "in",
                    "values" : [ "40" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "event_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "histogram_time" : {
                      "type" : "string",
                      "description" : "Timestamp of the bin"
                    },
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "wildfire_files_submitted_count" : {
                      "type" : "integer",
                      "description" : "number of wildfire files submitted"
                    },
                    "wildfire_malicious_verdict_count" : {
                      "type" : "integer",
                      "description" : "number of malicious verdicts found for wildfire threats"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/per_application_experience_score" : {
      "post" : {
        "summary" : "get per application experiance score",
        "operationId" : "get_per_application_experience_score",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "data transferred bytes"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "avg_app_score" : {
                      "type" : "number",
                      "description" : "Average app score"
                    },
                    "poor_experience_user_count" : {
                      "type" : "integer",
                      "description" : "Poor app experience user count"
                    },
                    "good_experience_user_count" : {
                      "type" : "string",
                      "description" : "Good app experience user count"
                    },
                    "non_monitored_user_count" : {
                      "type" : "string",
                      "description" : "Non monitored user count"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_application_count" : {
      "post" : {
        "summary" : "Endpoint to get count of number of applications broken down by different dimensions. dimensions include source_type, security_service_type, platform_type. Result also contains the list of those applications (top 15 sorted by volume)",
        "operationId" : "getThreatApplicationCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "application_count" : {
                      "type" : "integer",
                      "description" : "number of source applications generating threat"
                    },
                    "top_applications" : {
                      "type" : "array",
                      "description" : "Name of top 20 apps"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/threat_count_per_application_v2" : {
      "post" : {
        "summary" : "Endpoint to get number of threats broken down by different dimensions. dimensions include application name, severity,source_type, security_service_type",
        "operationId" : "getThreatCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic which was marked as threat"
                    },
                    "security_service_type" : {
                      "type" : "string",
                      "description" : "security service which marked the traffic as threat"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "application_name" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "severity" : {
                      "type" : "string",
                      "description" : "Critical/High/Medium/Low"
                    },
                    "total_threat_count" : {
                      "type" : "integer",
                      "description" : "number of threats"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "security_service_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    },
    "/insights/v3.0/resource/query/netsec/traffic_source_count_v2" : {
      "post" : {
        "summary" : "Endpoint to get count of source users/entities broken down by different dimensions. dimensions include source_type, app_type, platform_type",
        "operationId" : "getTrafficSourceCount",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "required" : [ "event_time" ],
                "type" : "object",
                "properties" : {
                  "event_time" : {
                    "type" : "string",
                    "description" : "Time of the event",
                    "example" : "1709226000000"
                  },
                  "injected_aggregation_type" : {
                    "type" : "string",
                    "description" : "Type of the aggregation",
                    "example" : "last_3_hours",
                    "enum" : [ "last_3_hours", "last_30_days", "last_1_hours", "last_7_days", "last_24_hours" ]
                  }
                }
              },
              "example" : {
                "filter" : {
                  "rules" : [ {
                    "property" : "event_time",
                    "operator" : "last_n_hours",
                    "values" : [ 5 ]
                  }, {
                    "property" : "injected_aggregation_type",
                    "operator" : "in",
                    "values" : [ "last_3_hours" ]
                  } ]
                }
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "properties" : {
                    "source_type" : {
                      "type" : "string",
                      "description" : "Origin for traffic"
                    },
                    "application_type" : {
                      "type" : "string",
                      "description" : "Type of application that the source was hitting"
                    },
                    "platform_type" : {
                      "type" : "string",
                      "description" : "Name of platform - NGFW or Prisma Access"
                    },
                    "entity_count" : {
                      "type" : "integer",
                      "description" : "number of source users/entities generating traffic"
                    },
                    "parent" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the parent type of entity on UI"
                    },
                    "type" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "source_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "application_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "platform_type_label" : {
                      "type" : "string",
                      "description" : "Enriched field denoting the sub type of entity on UI"
                    },
                    "bytes_total_volume" : {
                      "type" : "integer",
                      "description" : "total bytes transferred"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters" : [ {
        "name" : "Prisma-Tenant",
        "in" : "header",
        "description" : "TSG ID",
        "required" : false,
        "schema" : {
          "type" : "string"
        }
      } ]
    }
  },
  "components" : {
    "securitySchemes" : {
      "JWT" : {
        "type" : "http",
        "description" : "JWT authentication with bearer token",
        "scheme" : "bearer",
        "bearerFormat" : "Bearer [token]"
      }
    }
  }
}