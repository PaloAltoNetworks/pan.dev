schemas:
  ErrorResponse:
    type: object
    properties:
      code:
        type: string
        description: STATUS_CODE
      msg:
        type: string
        description: GENERAL_MESSAGE

  IoTDeviceDetailResponse:
    type: object
    properties:
      deviceid:
        type: string
        description: The device ID, which IoT Security uses to identify and track a device
      hostname:
        type: string
        description: The device hostname
      category:
        type: string
        description: The category to which the device belongs
      profile:
        type: string
        description: The device profile assigned to the device
      profile_type:
        type: string
        description: The type of device profile, such as IoT or Non_IoT
      profile_vertical:
        type: string
        description: The industry vertical for the profile such as Medical, IT Devices, and Office
      ip_address:
        type: string
        description: The IP address of a device
      mac_address:
        type: string
        description: The MAC address of a device
      risk_score:
        type: integer
        description: The risk score of a device
      risk_level:
        type: string
        description: 'The risk level of a device. There are four: low, medium, high, and critical'
      last_activity:
        type: string
        format: date-time
        description: A UTC timestamp for the last detected device activity
      confidence_score:
        type: string
        description: The confidence score for device classification
      subnet:
        type: string
        description: The subnet to which the device is attached
      number_of_critical_alerts:
        type: integer
        description: The number of critical alerts for the device
      number_of_warning_alerts:
        type: integer
        description: The number of warning alerts for the device
      number_of_caution_alerts:
        type: integer
        description: The number of caution alerts for the device
      number_of_info_alerts:
        type: integer
        description: The number of info alerts for the device
      allTags:
        type: array
        description: 'An array of user-defined tags assigned to a device. Each item in the array consists of three attributes: tagType, tagValue, and tagId.'
        items:
          $ref: '#/schemas/TagDetails'
      customAttributes:
        type: array
        description: 'An array of custom attributes. Only returning custom attribute with non-default values.'

  DeviceDetailPerIPResponse:
    type: object
    properties:
      deviceid:
        type: string
        description: The device ID, which IoT Security uses to identify and track a device
      hostname:
        type: string
        description: The device hostname
      category:
        type: string
        description: The category to which the device belongs
      profile:
        type: string
        description: The device profile assigned to the device
      profile_type:
        type: string
        description: The type of device profile, such as IoT or Non_IoT
      profile_vertical:
        type: string
        description: The industry vertical for the profile such as Medical, IT Devices, and Office
      ip_address:
        type: string
        description: The IP address of a device
      mac_address:
        type: string
        description: The MAC address of a device
      risk_score:
        type: integer
        description: The risk score of a device
      risk_level:
        type: string
        description: 'The risk level of a device. There are four: low, medium, high, and critical'
      last_activity:
        type: string
        format: date-time
        description: A UTC timestamp for the last detected device activity
      confidence_score:
        type: string
        description: The confidence score for device classification
      subnet:
        type: string
        description: The subnet to which the device is attached
      number_of_critical_alerts:
        type: integer
        description: The number of critical alerts for the device
      number_of_warning_alerts:
        type: integer
        description: The number of warning alerts for the device
      number_of_caution_alerts:
        type: integer
        description: The number of caution alerts for the device
      number_of_info_alerts:
        type: integer
        description: The number of info alerts for the device
      tagIdList:
        type: array
        description: A list of IDs for user- and system-defined tags assigned to a device
      allTags:
        type: array
        description: "An array of user-defined tags assigned to a device. Each item in the array consists of three attributes: tagType, tagValue, and tagId."
        items:
          $ref: '#/schemas/TagDetails'

  IoTDeviceInventoryResponse:
    type: object
    properties:
      total:
        type: integer
        description: The number of devices matching the request
      devices:
        type: array
        description: An array containing device details
        items:
          $ref: '#/schemas/DeviceDetails'

  AddingTagResponse:
    type: object
    properties:
      api:
        type: string
        description: The current API URI
      updateSuccess:
        type: string
        description: To indicate whether the adding operation is success or not

  RemovingTagResponse:
    type: object
    properties:
      api:
        type: string
        description: The current API URI
      removeSuccess:
        type: string
        description: To indicate whether the removing operation is success or not

  IoTProfileMappingResponse:
    type: object
    required:
      - count
      - mapping
    properties:
      count:
        type: integer
        description: The total number of profile mappings
      mapping:
        type: array
        description: An array containing profile mappings
        items:
          type: object
          properties:
            profile:
              type: string
              description: The name of a device profile
            category:
              type: string
              description: The category to which the profile is mapped
            vertical:
              type: string
              description: The industry vertical to which the profile is mapped

  IoTTagListResponse:
    type: object
    properties:
      totalTags:
        type: integer
        description: The number of tags matching the request
      tags:
        type: array
        description: "An array of user-defined tags assigned to a device. Each item in the array consists of three attributes: tagType, tagValue, and tagId."
        items:
          $ref: '#/schemas/TagDetails'

  SavedFilterListResponse:
    type: object
    properties:
      filters:
        type: array
        description: "All the saved filters."
        items:
          $ref: '#/schemas/FilterDetails'

  FilterDetails:
    type: object
    properties:
      filterName:
        type: string
        description: "The name of the saved filter."
      filterId:
        type: string
        description: "The unique id of the filter."
      createdAt:
        type: string
        description: "The ISO timestamp of the filter created time."
      filter: 
        description: "The content of the saved filter." 

  CustomAttributesListResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the api
      fields:
        type: array
        description: An array containing details about the custom attributes
        items:
          $ref: '#/schemas/CustomAttributeDetails'

  CustomAttributeDetails:
    type: object
    properties:
      customAttributeName:
        type: string
        description: The name of the custom attribute
      customAttributeId:
        type: string
        description: The unique id of the custom attribute
      fieldName:
        type: string
        description: The name of the custom attribute that saved in the devices
      defaultValue:
        type: string
        description: The default value of the custom attribute
      docType:
        type: string
        descrition: The type of the custom attribute
      systemAttrValueOptions:
        type: array
        description: The options for the system attribute value
      ruleOrders:
        type: array
        description: The value and filter mapping for the custom attribute
        items:
          $ref: '#/schemas/RuleOrderDetail'
  
  RuleOrderDetail:
    type: object
    properties:
      customAttributeValue:
        type: string
        description: The value of the custom attribute
      filterId:
        type: string
        description: The filter Id
      filter:
        type: object
        description: The filter name will be contained in this response
      ruleId:
        type: string
        description: The unique identifier for the rule
      
  createCustomAttributeResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the api
      success:
        type: string
        description: A flag indicating whether the operation was successful or not

  IoTSecurityAlertResponse:
    type: object
    properties:
      total:
        type: integer
        description: The number of security alerts matching the request
      items:
        type: array
        description: An array containing security alerts
        items:
          $ref: '#/schemas/AlertDetails'
      deviceTags:
        type: object
        description: A list of device tags
        properties:
          id:
            type: object
            description: The ID numbers of user-defined tags
            properties:
              deviceid:
                type: string
                description: deviceid is the Key for the DeviceTagMapping
              tagIdList:
                type: array
                description: List of Tag IDs
              allTags:
                type: array
                description: List of Tagtype-TagValue pairs for the Device
                items:
                  $ref: '#/schemas/TagDetails'

  ResolveSecurityAlertResponse:
    type: object
    properties:
      api:
        type: string
        description: The API path
      ver:
        type: string
        description: API version

  VulnerabilyInstanceListSchema:
    type: object
    properties:
      total:
        type: integer
        description: The number of vulnerablity instances matching the request
      items:
        type: array
        description: An array containing vulnerablity instances
        items:
          $ref: '#/schemas/VulnerabilityInstance'

  VulnerabilyListSchema:
    type: object
    properties:
      total:
        type: integer
        description: The number of vulnerablities matching the request
      items:
        type: object
        properties:
          items:
            type: array
            description: An array containing vulnerablities
            items:
              $ref: '#/schemas/Vulnerability'


  ResolveVulnerabilityResponse:
    type: object
    properties:
      api:
        type: string
        description: The API path
      ver:
        type: string
        description: API version

  DeviceDetails:
    type: object
    properties:
      deviceid:
        type: string
        description: The device ID, which IoT Security uses to identify and track a device
      hostname:
        type: string
        description: The device hostname
      category:
        type: string
        description: The category to which the device belongs
      profile:
        type: string
        description: The device profile assigned to the device
      profile_type:
        type: string
        description: The type of device profile, such as IoT or Non_IoT
      profile_vertical:
        type: string
        description: The industry vertical for the profile such as Medical, IT Devices, and Office
      ip_address:
        type: string
        description: The IP address of a device
      mac_address:
        type: string
        description: The MAC address of a device
      risk_score:
        type: integer
        description: The risk score of a device
      risk_level:
        type: string
        description: 'The risk level of a device. There are four: low, medium, high, and critical'
      last_activity:
        type: string
        format: date-time
        description: A UTC timestamp for the last detected device activity
      confidence_score:
        type: string
        description: The confidence score for device classification
      tagIdList:
        type: array
        description: A list of IDs for user- and system-defined tags assigned to a device
      allTags:
        type: array
        description: 'An array of user-defined tags assigned to a device. Each item in the array consists of three attributes: tagType, tagValue, and tagId.'
        items:
          $ref: '#/schemas/TagDetails'
      trafficRestricted:
        type: boolean
        description: Whether traffic restriction is being applied to a device (yes) or not (no)


  DeviceTags:
    type: object
    properties:
      id:
        type: object
        description: id is the Key for the DeviceTags
        properties:
          deviceid:
            type: string
            description: deviceid is the Key for the DeviceTagMapping
          tagIdList:
            type: array
            description: deviceid is the Key for the DeviceTagMapping
          allTags:
            type: array
            description: List of Tagtype-TagValue pairs for the Device
            items:
              $ref: '#/schemas/TagDetails'

  TagDetails:
    type: object
    properties:
      tagType:
        type: string
        description: The key for a user-defined tag
      tagValue:
        type: string
        description: The value of the tag key for a user-defined tag
      tagId:
        type: string
        description: The ID of a user-defined tag

  AlertDetails:
    type: object
    properties:
      resolved:
        type: string
        description: Whether the alert has been resolved (yes) or not (no)
      siteid:
        type: string
        description: The ID number that IoT Security assigns to the site for internal use
      trafficDirection:
        type: string
        description: The direction of the traffic on the device that triggered the alert; “inbound” if the device is a server and “outbound” if it’s a client
      siteName:
        type: string
        description: The name of the site where the alert occurred
      date:
        type: string
        description: The alert detection date
      deviceid:
        type: string
        description: The MAC address or IP address of a device
      name:
        type: string
        description: The alert name
      severity:
        type: string
        description: 'The severity level of an alert: high, medium, low, info'
      severityNumber:
        type: integer
        description: 'The severity number matching the severity level: high = 4, medium = 3, low = 2, info = 1'
      type:
        type: string
        description: The type of alert
      description:
        type: string
        description: The alert description
      tenantid:
        type: string
        description: The internal customer ID
      zb_ticketid:
        type: string
        description: The unique ticket ID
      id:
        type: string
        description: The alert ID. This is the ID to use when resolving an alert through the API.
      profile:
        type: string
        description: The device profile to which the alert belongs
      profile_vertical:
        type: string
        description: The industry vertical for the profile such as Medical, IT Devices, and Office
      category:
        type: string
        description: The device category to which the alert belongs
      hostname:
        type: string
        description: The hostname of the device to which the alert belongs
      reason_history:
        type: string
        description: The history of actions taken to investigate and resolve the alert
      serviceLevel:
        type: string
        description:  '(For MSSP only) The level of service for an MSSP customer as defined by the MSSP owner; for example: Tier 1, Tier 2, Tier 3; or Platinum, Gold, Silver.'


  VulnerabilityInstance:
    type: object
    properties:
      name:
        type: string
        description: The hostname of the device associated with a vulnerability instance
      ip:
        type: string
        description: The IP address of a device associated with a vulnerability instance
      deviceid:
        type: string
        description: The MAC address or IP address of the device
      profile:
        type: string
        description: The profile to which the device belongs
      profile_vertical:
        type: string
        description: The vertical to which the device profile belongs
      display_profile_category:
        type: string
        description: The category to which the device profile belongs
      vendor:
        type: string
        description: The device vendor
      model:
        type: string
        description: The device model
      os:
        type: string
        description: The device OS
      osCombined:
        type: string
        description: The OS and OS version combined
      siteid:
        type: string
        description: The ID of the site where the device is deployed
      asset_tag:
        type: string
        description: The asset tag of the device; if none, then “null” is returned
      sn:
        type: string
        description: The device serial number
      date:
        type: string
        description: The date of the latest activity of the device
      risk_score:
        type: integer
        description: The risk score of the vulnerability instance
      risk_level:
        type: string
        description: 'The risk level of the vulnerability instance: Low, Medium, High, or Critical'
      ticketState:
        type: string
        description: The state of the zb_ticket for a vulnerability instance —investigation, remediation, resolved, or new if the vulnerability was detected but nobody has yet taken action to address it
      zb_ticketid:
        type: string
        description: The unique ticket ID for a vulnerability instance
      ticketAssignees:
        type: string
        description: The email address of one or more people assigned to remediate a vulnerability instance; if there aren’t any, null is returned
      reason_history:
        type: string
        description: An array that holds the history of all actions taken on a vulnerability instance, including status changes, user notes, if it was sent to asset management, and if it was resolved; if no actions were taken, null is returned
      remediate_workorder:
        type: string
        description: The work order number returned from an integrated third-party asset management system such as AIMS, Connectiv, Nuvolo, or ServiceNow to which a vulnerability instance was sent
      remediate_checkbox:
        type: string
        description: Index values indicating the type of information sent to asset management; 0 = vulnerability summary, 1 = vulnerability impact, 2 = device information
      remediate_instruction:
        type: string
        description: Additional instructions included with the work order
      detected_date:
        type: string
        description: The date when a vulnerability instance was originally detected
      vulnerability_name:
        type: string
        description: The name of the vulnerability
      allTags:
        type: array
        description: "An array of user-defined tags assigned to the device. Each item in the array consists of three attributes: tagType, tagValue, and tagId."
        items:
          $ref: '#/schemas/TagDetails'

  Vulnerability:
    type: object
    properties:
      data:
        type: object
        properties:
          Potential:
            type: Object
            properties:
              profile:
                type: array
                description: The device profiles that the vulnerability affects or potentially affects
              device:
                type: array
                description: List of device IDs of all IoT devices that are vulnerable or potentially vulnerable
          Confirmed:
            type: Object
            properties:
              profile:
                type: array
                description: The device profiles that the vulnerability affects or potentially affects
              device:
                type: array
                descripåtion: List of device IDs of all IoT devices that are vulnerable or potentially vulnerable
      name:
        type: string
        description: Name of the vulnerability
        example: CVE-2015-3959
      tenantid:
        type: string
      cvssVersion:
        type: string
        description: "v2 or v3  Score ranges are different for the two Common Vulnerability Scoring System versions. Version 2 has three score ranges: Low 0.0 - 3.9, Medium 4.0 - 6.9, High 7.0 - 10.0. Version 3 has five ranges: None - 0.0, Low 0.1 - 3.9, Medium 4.0 - 6.9, High, 7.0 - 8.9, Critical 9.0 - 10.0.)"
      serviceLevel:
        type: string
      severity:
        type: string
        description: Only vulnerabilities with a CVSSv3 rating can have a Critical severity level.
        enum: [Low, Medium, High, Critical]
      date:
        type: string
        description: The most recent date that an instance of this vulnerability was detected on an IoT device
      CVSS:
        type: string
        description: The CVSS score for the vulnerability.
        example: 10.0
      description:
        type: string
        description: A description of what the vulnerability is and how it can be exploited
      source:
        type: string
        description: "The source of the vulnerability detection: IoT Security when IoT Security learns it through its own detection and analysis; or, if learned through integration with a third-party vulnerability scanner, the name of the scanner–Qualys, Rapid7, Tenable"
      vulnerability_types:
        type: string
        description: The type of attack to which a vulnerability makes a device susceptible; for example, Code Execution, Overflow, Info Leak, Denial of Service

  CiscoWLCBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: Array of device attributes from integrated Cisco WLAN controllers
        items:
          type: object
          properties:
            macAddress:
              type: string
              description: The MAC address of a wireless client on the Cisco WLAN. IoT Security uses it to link device attributes from Cisco WLAN controllers to a device in its inventory.
            ipAddress:
              type: string
              description: The wireless client IP address
            radio:
              type: string
              description: The radio band that the wireless client is using (2.4 GHz or 5 GHz)
            connectionState:
              type: string
              description: Whether the wireless client is connected or not
            wlanId:
              type: string
              description: An attribute that a WLAN controller sends an AP indicating the SSID an authenticated wireless client should join
            SSID:
              type: string
              description: The service set identifier (SSID) on which the wireless client associates with the access point
            connectedDuration:
              type: string
              description: The duration of the wireless client’s current connection
            authentication:
              type: string
              description: Whether or not authentication is required to connect to the WLAN
            status:
              type: string
              description: Whether the wireless client is authenticated or not
            authMethod:
              type: string
              description: 'The method the wireless client uses to authenticate: WPA2 PSK, WPA 802.1X, WPA, WEP, open'
            encryptionCipher:
              type: string
              description: The type of cipher the wireless client uses to encrypt communications, such as CCMP-128 (AES) or TKIP
            rssi:
              type: string
              description: The received signal strength (RSSI) of the wireless client’s connection
            snr:
              type: string
              description: The signal-to-noise ratio (SNR) of the wireless client’s connection
            apName:
              type: string
              description: The name of the access point through which the device makes a wireless connection to the network
            apIPAddress:
              type: string
              description: The IP address of the access point through which the device makes a wireless connection to the network
            apMacAddress:
              type: string
              description: The MAC address of the access point through which the device makes a wireless connection to the network
            apRadioSlotId:
              type: string
              description: The radio slot ID on the access point
            apModel:
              type: string
              description: The access point model
            location:
              type: string
              description: The location of the device as learned from the location setting on the Cisco switch or access point to which the device connects
            country:
              type: string
              description: The country for which the device is configured to operate its radio. This affects available radio channels and power levels.
            BSSID:
              type: string
              description: The MAC address of the wireless interface on which the AP hosts the SSID
            apencryptionCipher:
              type: string
              description: The set of encryption ciphers for which the AP broadcasts support in its beacons
            bluetoothType:
              type: string
              description: (Bluetooth/BLE devices) Whether the wireless client uses Bluetooth or Bluetooth Low Energy (BLE)
            bluetoothDeviceType:
              type: string
              description: (Bluetooth/BLE devices) The type of function the device is performing; for example, BLE Beacon
            frequency:
              type: string
              description: '(Bluetooth/BLE devices) The radio frequency on which the Bluetooth or BLE client is communicating with the AP: 2.4 GHz'
            channel:
              type: string
              description: '(Bluetooth/BLE devices) The radio channel on which the Bluetooth or BLE client is communicating with the AP'
            isBluetooth:
              type: boolean
              description: Whether the wireless client uses Bluetooth/BLE or not

  ArubaWLCBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: Array of device attributes from integrated Aruba WLAN controllers
        items:
          type: object
          properties:
            macAddress:
              type: string
              description: The MAC address of a wireless client on the Aruba WLAN. IoT Security uses it to link device attributes from Aruba WLAN controllers to a device in its inventory.
            ipAddress:
              type: string
              description: The wireless client IP address
            radio:
              type: string
              description: The radio band that the wireless client is using (2.4 GHz or 5 GHz)
            connectionState:
              type: string
              description: Whether the wireless client is connected or not
            wlanId:
              type: string
              description: An attribute that a WLAN controller sends an AP indicating the SSID an authenticated wireless client should join
            SSID:
              type: string
              description: The service set identifier (SSID) on which the wireless client associates with the access point
            connectedDuration:
              type: string
              description: The duration of the wireless client’s current connection
            authentication:
              type: string
              description: Whether or not authentication is required to connect to the WLAN
            authMethod:
              type: string
              description: 'The method the wireless client uses to authenticate: WPA2 PSK, WPA 802.1X, WPA, WEP, open'
            encryptionCipher:
              type: string
              description: The type of cipher the wireless client uses to encrypt communications, such as CCMP-128 (AES) or TKIP
            rssi:
              type: string
              description: The received signal strength (RSSI) of the wireless client’s connection
            snr:
              type: string
              description: The signal-to-noise ratio (SNR) of the wireless client’s connection
            apName:
              type: string
              description: The name of the access point through which the device makes a wireless connection to the network
            apIPAddress:
              type: string
              description: The IP address of the access point through which the device makes a wireless connection to the network
            apMacAddress:
              type: string
              description: The MAC address of the access point through which the device makes a wireless connection to the network
            apRadioSlotId:
              type: string
              description: The radio slot ID on the access point
            apModel:
              type: string
              description: The access point model
            location:
              type: string
              description: The location of the device as learned from the location setting on the switch or access point to which the device connects
            country:
              type: string
              description: The country for which the device is configured to operate its radio. This affects available radio channels and power levels.
            authenticationStatus:
              type: string
              description: Whether the wireless client is authenticated or not
            totalClients:
              type: string
              description: The total number of wireless clients currently associated with the AP
            bluetoothType:
              type: string
              description: (Bluetooth/BLE devices) Whether the wireless client uses Bluetooth or Bluetooth Low Energy (BLE)
            bluetoothDeviceType:
              type: string
              description: (BLE devices) The type of function the device is performing; for example, BLE Beacon
            isBluetooth:
              type: boolean
              description: Whether the wireless client uses Bluetooth/BLE or not
            hwType:
              type: string
              description: (BLE devices) The hardware type of the device
            fwVersion:
              type: string
              description: (BLE devices) The firmware version running on the device

  SNMPBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: Array of device attributes from integrated switches using SNMP
        items:
          type: object
          properties:
            deviceid:
              type: string
              description: The MAC address of a device connected to a switch. IoT Security uses it to link device attributes from a switch to a device in its inventory.
            connect_evtContent.ip:
              type: string
              description: The IP address of the device connected to a switch
            display_switchName:
              type: string
              description: The name of the switch to which the device is connected
            display_phyPort:
              type: string
              description: The physical port on the switch to which the device is connected. Only Cisco Catalyst switches return this information.
            display_switchIP:
              type: string
              description: IP addresses of neighboring switches

  CustomAttributeBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: Array of device custom attributes from users to update custom attribute values
        items:
          type: object
          properties:
            deviceid:
              type: string
              description: The device ID, which IoT Security uses to identify and track a device.
            tagType:
              type: string
              description: The custom attribute name. The custom attribute should already exist in the IoT Security.
            tagValue:
              type: string
              description: The value of the custom attribute.

  CellularBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: devices
        items:
          type: object
          properties:
            ipAddress:
              type: string
            ipv6Address:
              type: string
            imei:
              type: string
            iccid:
              type: string
            imsi:
              type: string
            apn:
              type: string
            msisdn:
              type: string
            SessionEvtType:
              type: string

  SccmBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: devices
        items:
          type: object
          properties:
            deviceid:
              type: string
              description: Required field
            serialNumber:
              type: string
            vendor:
              type: string
            model:
              type: string
            diskEncryptionStatus:
              type: string
            windowsInstalledPatches:
              type: string
            windowsInstalledSoftware:
              type: string
            windowsGUID:
              type: string
            sccmSite:
              type: string
            sccmDomain:
              type: string

  CrowdstrikeBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: devices
        items:
          type: object
          properties:
            deviceid:
              type: string
              description: Required field
            is_isolated:
              type: string
            operational_status:
              type: string
            group_name:
              type: string
            os_type:
              type: string
            os_version:
              type: string
            os_build:
              type: string
            hostname:
              type: string
            serial_number:
              type: string
            vendor:
              type: string

  BulkUpdateDeviceResponseSchema:
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “device/bulkupdate”'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      code:
        type: string
        description: 'The code number indicating success: 1'
      message:
        type: string
        description: 'The message indicating success: “OK”'
      updatedDeviceNum:
        type: integer
        description: 'The number of devices that IoT Security successfully updated'

  CustomAttributeBulkUpdateDeviceResponseSchema:
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “device/bulkupdate”'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      code:
        type: string
        description: 'The code number indicating success: 1'
      message:
        type: string
        description: 'The message indicating success: “OK”'
      updatedAttributesNum:
        type: integer
        description: 'The number of attributes that IoT Security successfully updated'
      errorCases:
        type: Object
        description: 'The cases that are not valid to update custom attribute'


  BulkUpdateIPAMSubnetResponseSchema:
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “network/subnetBulkUpdate”'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      code:
        type: string
        description: 'The code number indicating success: 1'
      message:
        type: string
        description: 'The message indicating success: “OK”'
      numOfUpdatedSubnets:
        type: integer
        description: 'The number of successfully inserted/updated subnets'

  BulkUpdateIPAMSubnetPayloadSchema:
    type: object
    required:
      - dataOverwrite
      - siteOverwrite
      - subnetList
    properties:
      dataOverwrite:
        type: boolean
        description: A flag to control overwriting of subnet metadata like vlan, description etc
      siteOverwrite:
        type: boolean
        description: A flag to control overwriting of site
      subnetList:
        type: array
        description: Array of subnet attributes coming from IPAM
        items:
          type: object
          required:
            - prefix
          properties:
            prefix:
              type: string
              description: IPv4 prefix
            site:
              type: string
              description: A site name where prefix belongs to (customer defined)
            vlan:
              type: string
              description: A vlan value between 0-4094 or keep it empty if not available
            description:
              type: string
              description: Description of the prefix
            name:
              type: string
              description: Name of the prefix
            type:
              type: string
              description: Prefix type block or subnet
            gateway:
              type: string
              description: Gateway IP of the prefix
            integration_instance_name:
              type: string
              description: internally used by XSOAR server to track XSOAR agent name running on customer premises

  GeneralBulkUpdateDevicePayloadSchema:
    type: object
    required:
      - devicelist
    properties:
      devicelist:
        type: array
        description: Array of device attributes from the integrated DNA Center or Prime instance
        items:
          type: object
          properties:
            deviceid:
              type: string
              description: The MAC address of a device in the Cisco DNA Center or Prime inventory. IoT Security uses it to link attributes from a device in the other inventory to one in its own inventory.
            config_source:
              type: string
              enum: ['dnac', 'prime']
              description: 'The source of the device information: "dnac" or "prime"'
            ip:
              type: string
              description: The device IP address
            location:
              type: string
              description: The location of the device as learned from the location setting on the Cisco switch or access point to which the device connects
            ap_ip:
              type: string
              description: The IP address of the access point through which the device makes a wireless connection to the network
            ap_name:
              type: string
              description: The name of the access point through which the device makes a wireless connection to the network
            SSID:
              type: string
              description: The SSID on which the device associates with the access point
            switchIP:
              type: string
              description: The IP address of the switch to which the device makes a wired connection to the network
            switchName:
              type: string
              description: The hostname of the switch to which the device makes a wired connection to the network
            switchPort:
              type: string
            switch_if_name:
              type: string
              description: The Ethernet interface on the switch through which the device makes a wired connection to the network
            vlan:
              type: string
              description: The ID of the VLAN that the device is in
            vlan_name:
              type: string
              description: The name of the VLAN that the device is in
            WireWireless:
              type: string
              description: "The type of network connection for the device: wired or wireless"

  AlertVulnerabilityCapabilityResponse:
    type: object
    required:
      - ver
      - api
      - list
      - total
    properties:
      ver:
        type: string
        description: The API version
      api:
        type: string
        description: The API path
      total:
        type: integer
        description: The total number of capabilities
      list:
        type: array
        description: An array of alert capabilities
        items:
          type: object
          properties:
            name:
              type: string
              description: The name of the alert/vulnerability
            description:
              type: string
              description: The descriptoin of this alert/vulnerability
            source:
              type: string
              description: The source of this alert/vulnerability
            severity:
              type: string
              description: The severity of this alert/vulnerability
            type:
              type: string
              description: The type of the alert/vulnerability

  PolicyRecommendationResponse:
    type: object
    required:
      - ver
      - api
      - total
      - policies
    properties:
      ver:
        type: string
        description: The API version
      api:
        type: string
        description: The API path
      total:
        type: integer
        description: The total number of activated recommended policy rules for which information was returned
      policies:
        type: array
        description: An array of activated policy rule recommendations
        items:
          type: object
          properties:
            id:
              type: string
              description: Unique identifier composed of alphanumeric characters for the policy rule
            policySetName:
              type: string
              description: Name of the user-defined policy set to which the policy rule
            geo:
              type: string
              description: "Location of the destination in the policy rule: <b>intranet</b> (internal) or <b>internet</b> (external)"
              enum: [ intranet, internet ]
            action:
              type: string
              default: allow
              description: Action the firewall takes when applying the policy rule, which is always <b>allow</b>
            lastActivityTime:
              type: string
              description: UTC timestamp for the last detected network activity corresponding to the elements in this policy rule
            sourceProfiles:
              type: array
              default: []
              description: "Device profile assigned to devices initiating traffic to which the policy rule applies. Note: Although this is an array, there can only be a single source profile."
            sourceIpList:
              type: array
              default: []
              description: "List of source IP addresses to which the policy rule applies. Note: This is included in anticipation of future functionality and is currently always empty."
            sourceZones:
              type: array
              default: []
              description: List of source zones to which the policy rule applies
            apps:
              type: array
              default: []
              description: Applications to which the policy rule applies, such as <b>youtube-base</b>
            destinationZones:
              type: array
              default: []
              description: List of destination zones to which the policy rule applies
            destinationProfiles:
              type: array
              default: []
              description: "Device profile of the destination in the policy rule. A destination device profile is used when the source and destination are in the same intranet and IoT Security is monitoring them both and has assigned a profile to the destination."
            destinationFqdnList:
              type: array
              default: []
              description: "List of destination FQDNs to which the policy rule applies. Note: When a destination is external, IoT Security displays its IP address in <b>destinationFqdnList</b>. When it’s internal, IoT Security displays it in <b>destinationIpList</b>."
            destinationIpList:
              type: array
              default: []
              description: "List of destination IP addresses to which the policy rule applies. Note: When a destination is internal, IoT Security displays its IP address in <b>destinationIpList</b>. When it’s external, IoT Security displays it in <b>destinationFqdnList</b>."
            destinationUrlCategories:
              type: array
              default: []
              description: "List of categories to which the policy rule applies, Some examples: games, entertainment, and health-and medicine"
            services:
              type: array
              default: []
              description: "List of non-standard service port numbers for an application o the user-defined values <b>service-http</b> and <b>service-https</b>. Note: Whe IoT Security identifies an application that's using non-standard UDP or TCP port numbers, it displays the application name in \"apps\" and the non-standard port numbers in \"services\". When an application is using standard ports, IoT Security displays th application name and leaves \"services\" empty. If a user manuall applied one of the predefined services servicehttp or service https to an application, then the predefined service name appear in \"services\"."
            tags:
              type: array
              default: [ IoTSecurityRecommended ]
              description: "System-defined tag <b>IoTSecurityRecommended</b> and any user-defined tags applied to the policy rule"
            securityProfiles:
              type: array
              default: []
              description: "List of Security profiles for antivirus, vulnerability protection, anti-spyware, and so on in the policy rule"
            firewallList:
              type: array
              description: List of firewalls that enforce the policy rule
            deviceGroups:
              type: array
              description: (Panorama) List of device groups containing firewalls that enforce the policy rule

  NetworkDiscoveryGraphNodeBulkUpdatePayloadSchema:
    type: form-data
    required:
      - file
    properties:
      file:
        type: file
        description: node graph txt file

  NetworkDiscoveryGraphNodeBulkUpdateResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “/network/ndNodeGraphBulkUpdate”'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      message:
        type: string
        description: 'The message indicating success: “success”'
      updatedNodeGraphs:
        type: integer
        description: 'The number of successfully inserted/updated node graphs'

  NetworkDiscoveryL2L3BulkUpdatePayloadSchema:
    type: form-data
    required:
      - file
    properties:
      file:
        type: file
        description: network discovery l2l3 txt file

  NetworkDiscoveryL2L3BulkUpdateResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “/network/ndNodeL2L3BulkUpdate”'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      message:
        type: string
        description: 'The message indicating success: “success”'
      updatedInterface:
        type: integer
        description: 'The number of successfully inserted/updated interfaces'
      updatedSubnet:
        type: integer
        description: 'The number of successfully inserted/updated subnets'
      updatedDevice:
        type: integer
        description: 'The number of successfully inserted/updated devices'

  NetworkDiscoveryEndpointBulkUpdatePayloadSchema:
    type: form-data
    required:
      - file
    properties:
      file:
        type: file
        description: network discovery endpoint txt file

  NetworkDiscoveryEndpointBulkUpdateResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API: “/network/ndNodeEndpointBulkUpdate'
      ver:
        type: string
        description: 'The version of the IoT Security API: “v4.0”'
      message:
        type: string
        description: 'The message indicating success: “success”'
      updatedNodeEndpoints:
        type: integer
        description: 'The number of successfully inserted/updated endpoints'

  xsoarIntegrationResponse:
    type: object
    properties:
      active_integrations:
        type: array
        description: The active integration list
      max_integrations:
        type: integer
        description: The maximum allowed active integrations number based on the third-party license type

  xsoarReportUploadResponse:
    type: object
    properties:
      received:
        type: string
        description: To indicate whether the report is received from Xsoar server side or not
      upload:
        type: string
        description: To indicate whether the report is uploaded and parsed by IoT side or not

  xsoarProfileSyncResponse:
    type: object
    properties:
      successCase:
        type: string
        description: To indicate if this is a success case or not
      
  updateSecurityRulesResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API'
      ver:
        type: string
        description: 'The version of the IoT Security API'
      message:
        type: string
        description: 'The message indicating success'
      updatedSecurityRulesNum:
        type: integer
        description: 'The number of successfully updated rules'
      upsertedSecurityRulesNum:
        type: integer
        description: 'The number of successfully inserted rules'

  purgeRulesResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API'
      ver:
        type: string
        description: 'The version of the IoT Security API'
      message:
        type: string
        description: 'The message indicating success'
      removedRules:
        type: integer
        description: 'The number of rules successfully removed'

  thirdPartyScanResponse: 
    type: object
    properties:
      api:
        type: string
        description: 'The path used to call the IoT Security API'
      ver:
        type: string
        description: 'The version of the IoT Security API'
      message:
        type: string
        description: 'The message indicating success'
      removedRules:
        type: integer
        updatedDeviceNum: 'The number of CVE imported'

  xsoarStatusResponse: 
    type: object
    properties:
      received:
        type: string
        description: 'if IoT has received the integration information'

  scanDetailsResponse: 
    type: object
    properties:
      received:
        type: string
        description: 'if IoT has received the scanner list'

  heartbeatResponse: 
    type: object
    properties:
      success:
        type: boolean
        description: 'if IoT has received xsoar instance heartbeat'
  
  CreateSitePayloadSchema:
    type: array
    description: Array of site definitions to be created
    items:
      type: object
      required:
        - external_id
      properties:
        external_id:
          type: string
          description: Unique external identifier for the site
        location:
          type: string
          description: Physical location of the site
        subnetsList:
          type: array
          description: List of subnets associated with this site
          items:
            type: string
            description: Subnet in CIDR notation
        segmentList:
          type: array
          description: List of network segments within this site
          items:
            type: string
            description: Network segment identifier
        description:
          type: string
          description: Detailed description of the site
    
  CreateSiteResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
        example: 'v'
      api:
        type: string
        description: 'The API endpoint that was called'
        example: 'site'
      message:
        type: string
        description: 'Status message indicating the result of the operation'
        example: 'OK'
      added:
        type: integer
        description: 'The number of sites successfully inserted'
        example: 2
  
  GetSiteResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
        example: 'v4.0'
      api:
        type: string
        description: 'The API endpoint that was called'
        example: 'getSite'
      list:
        type: array
        description: 'List of site definitions retrieved from IoT Security'
        items:
          type: object
          properties:
            external_id:
              type: string
              description: 'Unique external identifier for the site'
              example: 'Example Site 1'
            siteid:
              type: string
              description: 'Internal system identifier for the site'
              example: '32'
            location:
              type: string
              description: 'Physical location of the site'
              example: 'Example Site Address'
            description:
              type: string
              description: 'Detailed description of the site'
              example: 'This is a test api body description'
            subnetsList:
              type: array
              description: 'List of subnets associated with this site in CIDR notation'
              example: ['0.0.0.0', '192.0.0.0']
              items:
                type: string
            segmentIdsList:
              type: array
              description: 'List of network segments within this site'
              items:
                type: string
  
  UpdateSitePayloadSchema:
    type: object
    required:
      - external_id
    properties:
      external_id:
        type: string
        description: External identifier for the site
      description:
        type: string
        description: Detailed description of the site
      location:
        type: string
        description: Physical location of the site
      subnetsList:
        type: array
        description: List of subnets associated with this site
        items:
          type: string
          description: Subnet in CIDR notation
      segmentList:
        type: array
        description: List of network segments within this site (optional - only provide if updating)
        items:
          type: string
          description: Network segment identifier
    
  UpdateSiteResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
      api:
        type: string
        description: 'The API endpoint that was called'
      message:
        type: string
        description: 'Status message indicating the result of the operation'
      updated:
        type: integer
        description: 'The number of sites successfully updated'
  
  DeleteSiteResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
      api:
        type: string
        description: 'The API endpoint that was called'
      code:
        type: integer
        description: 'Status code indicating success (1) or failure (0)'
      message:
        type: string
        description: 'Status message indicating the result of the operation'
  
  CreateNetworkSegmentPayloadSchema:
    type: array
    description: Array of network segment definitions to be created
    items:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: Name of the network segment
        description:
          type: string
          description: Detailed description of the network segment
        firewallsList:
          type: array
          description: List of firewall IDs associated with this network segment
          items:
            type: string
            description: Firewall identifier
        siteid:
          type: string
          description: ID of the site this network segment belongs to

  CreateNetworkSegmentResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      message:
        type: string
        description: Status message indicating the result of the operation

  GetNetworkSegmentResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
      api:
        type: string
        description: 'The API endpoint that was called'
      method:
        type: string
        description: 'The HTTP method used for the request'
      networkSegments:
        type: array
        description: 'List of network segment definitions retrieved from IoT Security'
        items:
          type: object
          properties:
            _id:
              type: string
              description: 'Internal identifier for the network segment'
            name:
              type: string
              description: 'Name of the network segment'
            description:
              type: string
              description: 'Detailed description of the network segment'
            firewallsList:
              type: array
              description: 'List of firewall IDs associated with this network segment'
              items:
                type: string
            tenantid:
              type: string
              description: 'ID of the tenant that owns this network segment'
            segmentId:
              type: string
              description: 'ID of the network segment'
            siteid:
              type: string
              description: 'ID of the site this network segment belongs to'
            siteCreation:
              type: boolean
              description: 'Whether the site was created along with the network segment'
            firewall:
              type: array
              description: 'Detailed information about associated firewalls'
              items:
                type: object
                properties:
                  date:
                    type: string
                    format: date-time
                    description: 'Date when the firewall was associated'
                  applianceid:
                    type: string
                    description: 'ID of the firewall appliance'
      total:
        type: integer
        description: 'Total number of network segments returned'

  UpdateNetworkSegmentPayloadSchema:
    type: array
    description: 'Array containing a single network segment definition to be updated'
    items:
      type: object
      required:
        - segmentId
      properties:
        segmentId:
          type: string
          description: 'ID of the network segment to be updated'
        name:
          type: string
          description: 'Name of the network segment'
        description:
          type: string
          description: 'Detailed description of the network segment'
        firewallsList:
          type: array
          description: 'List of firewall IDs associated with this network segment'
          items:
            type: string
        siteid:
          type: string
          description: 'ID of the site this network segment belongs to'
  
  UpdateNetworkSegmentResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
      api:
        type: string
        description: 'The API endpoint that was called'
      message:
        type: string
        description: 'Status message indicating the result of the operation'
  
  DeleteNetworkSegmentPayloadSchema:
    type: object
    required:
      - segmentIdsList
    properties:
      segmentIdsList:
        type: array
        description: 'List of network segment IDs to be deleted'
        items:
          type: string
  
  DeleteNetworkSegmentResponse:
    type: object
    properties:
      ver:
        type: string
        description: 'The version of the IoT Security API'
      method:
        type: string
        description: 'The HTTP method used for the request'
      api:
        type: string
        description: 'The API endpoint that was called'
      message:
        type: string
        description: 'Status message indicating the result of the operation'

  CreateSubnetPayloadSchema:
    type: array
    description: Array of subnet definitions to be created
    items:
      type: object
      required:
        - prefix
      properties:
        prefix:
          type: string
          description: IPv4 subnet prefix in CIDR notation
        vlan:
          type: string
          description: VLAN ID associated with this subnet
        description:
          type: string
          description: Detailed description of the subnet
        static:
          type: boolean
          description: Whether this is a static subnet
        monitored:
          type: boolean
          description: Whether this subnet is being monitored
        name:
          type: string
          description: Name of the subnet

  CreateSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      status:
        type: string
        description: Status message indicating the result of the operation
      added:
        type: integer
        description: The number of subnets successfully inserted

  GetSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      total:
        type: integer
        description: Total number of subnets matching the query
      subnets:
        type: array
        description: List of subnet definitions retrieved from IoT Security
        items:
          type: object
          properties:
            prefix:
              type: string
              description: IPv4 subnet prefix in CIDR notation
            monitored:
              type: boolean
              description: Whether this subnet is being monitored
            static:
              type: boolean
              description: Whether this is a static subnet
            source:
              type: string
              description: Source of the subnet definition
            integrationInstanceName:
              type: string
              description: Name of the integration instance that created this subnet
            description:
              type: string
              description: Detailed description of the subnet
            parent:
              type: string
              description: Parent network in CIDR notation
            name:
              type: string
              description: Name of the subnet
            type:
              type: string
              description: Type of network entity
            siteid:
              type: string
              description: ID of the site this subnet belongs to

  UpdateSubnetPayloadSchema:
    type: array
    description: Array of subnet definitions to be updated
    items:
      type: object
      required:
        - prefix
      properties:
        prefix:
          type: string
          description: IPv4 subnet prefix in CIDR notation
        vlan:
          type: string
          description: VLAN ID associated with this subnet
        description:
          type: string
          description: Detailed description of the subnet
        static:
          type: boolean
          description: Whether this is a static subnet
        monitored:
          type: boolean
          description: Whether this subnet is being monitored
        name:
          type: string
          description: Name of the subnet

  UpdateSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      status:
        type: string
        description: Status message indicating the result of the operation
      updated:
        type: integer
        description: The number of subnets successfully updated

  DeleteSubnetPayloadSchema:
    type: object
    required:
      - subnetPrefixList
    properties:
      subnetPrefixList:
        type: array
        description: List of subnet prefixes to be deleted (maximum 10)
        items:
          type: string
          description: IPv4 subnet prefix in CIDR notation

  DeleteSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      status:
        type: string
        description: Status message indicating the result of the operation
      deletedSubnets:
        type: array
        description: List of subnet prefixes that were successfully deleted
        items:
          type: string
          description: IPv4 subnet prefix in CIDR notation

  TransferSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      status:
        type: string
        description: Status message indicating the result of the operation

  RevertSubnetResponse:
    type: object
    properties:
      ver:
        type: string
        description: The version of the IoT Security API
      api:
        type: string
        description: The API endpoint that was called
      status:
        type: string
        description: Status message indicating the result of the operation