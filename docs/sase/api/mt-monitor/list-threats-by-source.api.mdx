---
id: list-threats-by-source
sidebar_label: List threats by source
hide_title: true
hide_table_of_contents: true
api: {"description":"Retrieve an aggregated count of critical threats by source across tenants, such as: remote networks, mobile users, or proxy nodes.                     \n","operationId":"post-mt-monitor-v1-agg-threats-source","parameters":[{"description":"Must be `tenant`. Using the query parameter returns all the aggregated responses for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned. \n","in":"query","name":"agg_by","schema":{"type":"string"}},{"description":"Must be `PA_ONLY`. Using the license query parameter returns all the aggregated license details for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned.                           \n","in":"query","name":"license_type","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"examples":{"Threat Count by Source":{"value":{"filter":{"operator":"AND","rules":[{"operator":"in","property":"severity","values":["Critical","High","Medium"]},{"operator":"last_n_days","property":"event_time","values":[7]}]},"properties":[{"property":"total_app_count"},{"property":"total_app_remote_network"},{"property":"total_app_mobile_users"},{"property":"total_app_proxy_nodes"}]}},"Threat Count by Source per Tenant":{"value":{"filter":{"operator":"AND","rules":[{"operator":"in","property":"severity","values":["Critical","High","Medium"]},{"operator":"last_n_days","property":"event_time","values":[7]}]},"properties":[{"property":"sub_tenant_id"},{"property":"total_app_count"},{"property":"total_app_remote_network"},{"property":"total_app_mobile_users"},{"property":"total_app_proxy_nodes"}]}}},"schema":{"properties":{"filter":{"allOf":[{"description":"Threats by source filter. Consists of a required operator and an array of rules objects. \n","properties":{"operator":{"description":"Must be `AND`. \n","type":"string"},"rules":{"anyOf":[{"properties":{"operator":{"description":"Filter operator that is one of the example values and is run on the property field","example":"in","type":"string"},"property":{"description":"Filter property field that is one of the example values","example":"threat_severity","type":"string"},"values":{"description":"Filter property values","example":"Critical, High, Medium (used with severity in)","items":{"type":"string"},"type":"array"}},"type":"object"},{"properties":{"operator":{"description":"Filter operator that is one of the example values and is run on the property field","example":"equals, in, gt, lt, last_n_minutes, last_n_hours, last_n_days","type":"string"},"property":{"description":"Filter property field that is one of the example values","example":"event_time","type":"string"},"values":{"description":"Filter property value","example":"minute, hour or day counts if property is event_time","items":{"type":"string"},"type":"array"}},"type":"object"}],"description":"See [Rule](/sase/docs/filters#rule) and [TimeFilter](/sase/docs/filters#timefilter).\n","items":{"type":"object"},"type":"array"}},"required":["operator"],"type":"object"},{"description":"filter json object"}]},"properties":{"description":"List of property json objects","items":{"description":"Test\n","properties":{"alias":{"type":"string"},"property":{"description":"Threats by source property. See [Property4](/sase/docs/filters#property4).  \n","example":"sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users, total_app_proxy_nodes","type":"string"}},"type":"object"},"type":"array"}},"required":["properties","filter"],"type":"object"}}}},"responses":{"200":{"content":{"application/json":{"examples":{"Threat Count by Source":{"value":[{"total_app_count":10,"total_app_mobile_users":10,"total_app_proxy_nodes":10,"total_app_remote_network":10}]},"Threat Count by Source per Tenant":{"value":[{"sub_tenant_id":"<sub_tenant_id>","total_app_count":10,"total_app_mobile_users":10,"total_app_proxy_nodes":10,"total_app_remote_network":10}]}}}},"description":"Success"},"400":{"description":"Bad Request"},"500":{"description":"Server Error"}},"security":[{"Bearer":[]}],"tags":["DataResources"],"method":"post","path":"/mt/monitor/v1/agg/threats/source","servers":[{"url":"/"}],"securitySchemes":{"Bearer":{"scheme":"bearer","type":"http"}},"jsonRequestBodyExample":{"filter":{"operator":"string","rules":[{}]},"properties":[{"alias":"string","property":"sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users, total_app_proxy_nodes"}]},"info":{"contact":{},"description":"Use the Data Resource API for retrieving aggregated summaries and counts across tenants for threats, alerts, risky applications, URLs, and upgrades.\n","title":"Data Resource API","version":"1.0"},"postman":{"name":"List threats by source","description":{"content":"Retrieve an aggregated count of critical threats by source across tenants, such as: remote networks, mobile users, or proxy nodes.                     \n","type":"text/plain"},"url":{"path":["mt","monitor","v1","agg","threats","source"],"host":["{{baseUrl}}"],"query":[{"disabled":false,"description":{"content":"Must be `tenant`. Using the query parameter returns all the aggregated responses for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned. \n","type":"text/plain"},"key":"agg_by","value":""},{"disabled":false,"description":{"content":"Must be `PA_ONLY`. Using the license query parameter returns all the aggregated license details for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned.                           \n","type":"text/plain"},"key":"license_type","value":""}],"variable":[]},"header":[{"key":"Content-Type","value":"application/json"},{"key":"Accept","value":"application/json"}],"method":"POST","body":{"mode":"raw","raw":"\"\"","options":{"raw":{"language":"json"}}},"auth":{"type":"bearer","bearer":[{"type":"any","value":"<Bearer Token>","key":"token"}]}}}
sidebar_class_name: "post api-method"
info_path: docs/sase/api/mt-monitor/data-resource-api
---

import ParamsItem from "@theme/ParamsItem";
import SchemaItem from "@theme/SchemaItem"
import ApiTabs from "@theme/ApiTabs";
import SchemaTabs from "@theme/SchemaTabs";
import TabItem from "@theme/TabItem";

## List threats by source



Retrieve an aggregated count of critical threats by source across tenants, such as: remote networks, mobile users, or proxy nodes.                     


<details style={{"marginBottom":"1rem"}} data-collapsed={false} open={true}><summary style={{}}><strong>Query Parameters</strong></summary><div><ul><ParamsItem className={"paramsItem"} param={{"description":"Must be `tenant`. Using the query parameter returns all the aggregated responses for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned. \n","in":"query","name":"agg_by","schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"description":"Must be `PA_ONLY`. Using the license query parameter returns all the aggregated license details for the current parent tenant and its child tenants. If not used, the results for just the current tenant are returned.                           \n","in":"query","name":"license_type","schema":{"type":"string"}}}></ParamsItem></ul></div></details><details style={{}} data-collapsed={false} open={true}><summary style={{"textAlign":"left"}}><strong>Request Body</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}}><summary style={{}}><strong>filter</strong><span style={{"opacity":"0.6"}}> object</span><strong style={{"fontSize":"var(--ifm-code-font-size)","color":"var(--openapi-required)"}}> required</strong></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Threats by source filter. Consists of a required operator and an array of rules objects. 


</div><SchemaItem collapsible={false} name={"operator"} required={true} schemaDescription={"Must be `AND`. \n"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}}><summary style={{}}><strong>rules</strong><span style={{"opacity":"0.6"}}> object[]</span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

See [Rule](/sase/docs/filters#rule) and [TimeFilter](/sase/docs/filters#timefilter).


</div><li><div><span className={"badge badge--info"}>anyOf</span><SchemaTabs><TabItem label={"MOD1"} value={"0-item-properties"}><SchemaItem collapsible={false} name={"operator"} required={false} schemaDescription={"Filter operator that is one of the example values and is run on the property field"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaDescription={"Filter property field that is one of the example values"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={false} name={"values"} required={false} schemaDescription={"Filter property values"} schemaName={"string[]"} qualifierMessage={undefined}></SchemaItem></TabItem><TabItem label={"MOD2"} value={"1-item-properties"}><SchemaItem collapsible={false} name={"operator"} required={false} schemaDescription={"Filter operator that is one of the example values and is run on the property field"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaDescription={"Filter property field that is one of the example values"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={false} name={"values"} required={false} schemaDescription={"Filter property value"} schemaName={"string[]"} qualifierMessage={undefined}></SchemaItem></TabItem></SchemaTabs></div></li></div></details></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}}><summary style={{}}><strong>properties</strong><span style={{"opacity":"0.6"}}> object[]</span><strong style={{"fontSize":"var(--ifm-code-font-size)","color":"var(--openapi-required)"}}> required</strong></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

List of property json objects

</div><SchemaItem collapsible={false} name={"alias"} required={false} schemaDescription={undefined} schemaName={"string"} qualifierMessage={undefined}></SchemaItem><SchemaItem collapsible={false} name={"property"} required={false} schemaDescription={"Threats by source property. See [Property4](/sase/docs/filters#property4).  \n"} schemaName={"string"} qualifierMessage={undefined}></SchemaItem></div></details></SchemaItem></ul></details><div><ApiTabs><TabItem label={"200"} value={"200"}><div>

Success

</div><div></div></TabItem><TabItem label={"400"} value={"400"}><div>

Bad Request

</div><div></div></TabItem><TabItem label={"500"} value={"500"}><div>

Server Error

</div><div></div></TabItem></ApiTabs></div>
      